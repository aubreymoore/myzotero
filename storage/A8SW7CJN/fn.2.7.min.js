/*jshint eqnull:true */
/*!
 * jQuery Cookie Plugin v1.1
 * https://github.com/carhartl/jquery-cookie
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */
(function(a,b){function d(a){return a}function f(a){return decodeURIComponent(a.replace(g," "))}var g=/\+/g;a.cookie=function(g,e,c){if(1<arguments.length&&(!/Object/.test(Object.prototype.toString.call(e))||null==e)){c=a.extend({},a.cookie.defaults,c);null==e&&(c.expires=-1);if("number"===typeof c.expires){var k=c.expires,h=c.expires=new Date;h.setDate(h.getDate()+k)}e=String(e);return b.cookie=[encodeURIComponent(g),"=",c.raw?e:encodeURIComponent(e),c.expires?"; expires="+c.expires.toUTCString():
"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=e||a.cookie.defaults||{};for(var k=c.raw?d:f,h=b.cookie.split("; "),l=0,m;m=h[l]&&h[l].split("=");l++)if(k(m.shift())===g)return k(m.join("="));return null};a.cookie.defaults={}})(jQuery,document);
(function(a){a.fn.clonePosition=function(b,d){d=a.extend({cloneWidth:!0,cloneHeight:!0,offsetLeft:0,offsetTop:0},d||{});var f=a(b).offset();a(this).css({position:"absolute",top:f.top+d.offsetTop+"px",left:f.left+d.offsetLeft+"px"});d.cloneWidth&&a(this).width(a(b).width());d.cloneHeight&&a(this).height(a(b).height());return this}})(jQuery);
(function(a){a.fn.lazyImg=function(b){return this.each(function(){var b=a(this),f=b.data("url"),g=b.data("spin"),n=a('<div class="loader">Loading...</div>');if(f){if(g){var e=a("<div/>").clonePosition(b).append(n);b.after(e)}g=new Image;a(g).load(function(){e&&e.remove();b.attr("src",this.src);b.removeAttr("data-url")});g.src=f}})}})(jQuery);$mobile={};
$.extend($mobile,{ini:function(){var a=this;$(document).ajaxError(function(a,d,f,g){alert("Url: "+f.url+"  error: "+g)});this.updateState();$(window).bind("popstate",function(b){(b=b.originalEvent.state)&&b.href&&a.loadPage(b.href,b.scroll);return!0});this.pagination();$(window).bind("hashchange",function(){var b=location.hash;0<$(b).length?a.show(b):a.close()});window.location.hash&&$(window).trigger("hashchange");$("body").delegate(".btn-close","click",function(){a.close();window.location.hash=
"";return!1});$(document).trigger("pageini")},pagination:function(){var a=this;$("body").delegate("[data-role=pagination] a","click",function(){var b=$(this).attr("href");a.updateState();a.pushState(b);a.loadPage(b);return!1})},loadPage:function(a,b){var d=this;d.loader(!0);$("div[data-role=page]").load(a+" div[data-role=page]",function(){d.loader(!1);b="undefined"===typeof b?1:parseInt(b);setTimeout(function(){$(window).scrollTop(b)},0);$(document).trigger("pageshow")})},onDialog:function(a,b){$(document).on("dialogshow",
function(d,f){f.hash==a&&b.apply(this,arguments)})},pushState:function(a){this.settings.pushStateEnabled&&window.history.pushState({href:a,scroll:$(window).scrollTop()},null,a)},updateState:function(){if(this.settings.pushStateEnabled){var a=$.extend({},history.state);"undefined"===typeof a.href&&(a.href=location.href);a.scroll=$(window).scrollTop();window.history.replaceState(a,null)}},loader:function(a){a?$("."+this.settings.contentCss).css("opacity",".5"):$("."+this.settings.contentCss).css("opacity",
"1")},show:function(a){this.close();this.showOverlay(!1);this.window=$(a);this.window.show();this.window.find("[data-role=header]").append(this.settings.closeButton);$(document).trigger("dialogshow",{hash:a})},close:function(){this.window&&(this.window.hide(),$(".btn-close").remove());this.showOverlay(!0)},showOverlay:function(a){a?($("div[data-role=page]").show(),$("body").removeClass(this.settings.overlayCss)):($("div[data-role=page]").hide(),$("body").addClass(this.settings.overlayCss))}});
(function(a){a.window="";a.settings=$.extend(a.settings,{contentCss:"ui-content",overlayCss:"ui-overlay-a",pushStateEnabled:"pushState"in history&&"replaceState"in history,closeButton:'<a class="ui-btn ui-icon-close ui-btn-left btn-close">Close</a>'});a.ini()})($mobile);var rooturl="/";$(document).bind("pageshow",function(a,b){$("img[data-url]").lazyImg()});
$(document).ready(function(){$("img[data-url]").lazyImg();$("a[rel=tag]").click(function(){var a=$(this).attr("href");$(this).attr("href",a.replace("//phys.org/","//m.phys.org/"))});$("body").on("change","input.filtr[type='radio']",function(a,d){$.cookie("filter",a.target.value,{path:"/"})});if("eucook"!=$.cookie("physHint")){var a=$('<div class="cookie_m">This website uses cookies to ensure you get the best experience on our website</div>').append($('<button type="button">Ok</button>').click(function(){$(".cookie_m").hide();
$.cookie("physHint","eucook",{path:"/",expires:360});return!1}));$("[data-role=page]").append(a)}});function switchToFull(){$.cookie("pdaPhysOrg","1",{path:"/",domain:".phys.org"});return!0}function closeTopicDialog(){var a=$("input.tp:checked").map(function(){return this.value}).get().join(),b=Math.random();$.cookie("topics",a,{path:"/"});$mobile.loadPage(rooturl+"?rid="+b)}function closeFilterDialog(){$mobile.loadPage(rooturl+"?rid="+Math.random())}
function auth(a){$(".error").html("");var b=!1;$(a).find(".ui-input-text").each(function(){""===$(this).val()&&($(this).css("background-color","#FFE49A"),b=!0)});if(b)return!1;$.ajax({type:"POST",url:"/ajax/add_comment/",data:$(a).serialize(),dataType:"json",success:function(a){null!=a.ERROR&&$(".error").html(a.ERROR);null!=a.COMMENT&&($("#comment").dialog("close"),setTimeout(function(){$.mobile.changePage("#add_comment")},20),$("#btn_comment").css("width","50%"),$("#btn_auth").css("width","50%"),
$("#btn_auth").show(),$("#new_comment").attr("href","#add_comment"));null!=a.AUTH&&location.reload();null!=a.MESSAGE&&location.reload()}})};