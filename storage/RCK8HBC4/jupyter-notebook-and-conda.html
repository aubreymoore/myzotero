<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">


<meta content="0.2" name="wpd_version">
<meta content="http://stuartmumford.uk/blog/jupyter-notebook-and-conda.html" name="wpd_baseurl">
<meta content="http://stuartmumford.uk/blog/jupyter-notebook-and-conda.html" name="wpd_url">
<meta content="2017-00-28T23:45Z" name="wpd_date">

<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Jupyter Notebook and Conda | Stuart Mumford</title>




<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://stuartmumford.uk/rss.xml">
<link rel="canonical" href="http://stuartmumford.uk/blog/jupyter-notebook-and-conda.html">
<script type="text/javascript" async="" defer="" src="piwik.js"></script><script type="text/x-mathjax-config;executed=true">

MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'left', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->



<meta name="author" content="Stuart Mumford">
<link rel="prev" href="http://stuartmumford.uk/blog/the-fibonacci-sequence.html" title="The Fibonacci Sequence" type="text/html">
<link rel="next" href="http://stuartmumford.uk/blog/verifying-pypi-and-conda-packages.html" title="Verifying PyPI and Conda Packages" type="text/html">
<meta property="og:site_name" content="Stuart Mumford">
<meta property="og:title" content="Jupyter Notebook and Conda">
<meta property="og:url" content="http://stuartmumford.uk/blog/jupyter-notebook-and-conda.html">
<meta property="og:description" content="This post is going to be the first in a series of posts about the Jupyter Notebook and the supercomputing facility 'iceberg' at Sheffield University.
This post is about a plugin for the Jupyter Notebo">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-11-19T11:20:12Z">

<link media="all" href="jupyter-notebook-and-conda.css" type="text/css" rel="stylesheet">
</head>
<body><div id="MathJax_Message" style="display: none;"></div>
<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://stuartmumford.uk/">Stuart Mumford</a>
    </div>
    <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Research <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="http://stuartmumford.uk/research.html">Research</a>
                    </li>
<li>
<a href="http://stuartmumford.uk/research.html#publications">Publications</a>
                    </li>
<li>
<a href="http://stuartmumford.uk/research.html#talks">Talks</a>
                    </li>
<li>
<a href="http://stuartmumford.uk/research.html#simulations">Simulations</a>
                    </li>
<li>
<a href="http://stuartmumford.uk/asteroseismology.html">Asteroseismology</a>
            </li>
</ul>
</li>
<li>
<a href="http://stuartmumford.uk/opensci.html">Open Science</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Blog <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="http://stuartmumford.uk/blog/">Blog</a>
                    </li>
<li>
<a href="http://stuartmumford.uk/archive.html">Archives</a>
                    </li>
<li>
<a href="http://stuartmumford.uk/categories/index.html">Tags</a>
            </li>
</ul>
</li>
</ul>
<ul class="nav navbar-nav navbar-right">
<!--Add Links to social media sites --><a href="https://github.com/Cadair" target="_top"><img src="github_logo.png" alt="GitHub" height="50px"></a>
<a href="https://plus.google.com/+StuartMumford/" target="_top"><img src="google-plus.png" alt="Google Plus" height="50px"></a>
<a href="https://twitter.com/stuartmumford" target="_top"><img src="Twitter_logo_white.png" alt="Twitter" height="50px"></a>
<a href="https://www.linkedin.com/in/stuartmumford" target="_top"><img src="linkedin_logo.png" alt="LinkedIn" height="50px"></a>


            
            
        </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
</nav><!-- End of Menubar --><div class="container">
  <!--Body content-->
  <div class="row">
      
      
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Jupyter Notebook and Conda</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">

                    Stuart Mumford
            </span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2015-11-19T11:20:12Z" itemprop="datePublished" title="2015-11-19 11:20">2015-11-19 11:20</time></a></p>
                <p class="commentline">
        


            

        </p>
</div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This post is going to be the first in a series of posts about the Jupyter Notebook and the supercomputing facility <a href="http://rcg.group.shef.ac.uk/iceberg/index.html">'iceberg'</a> at Sheffield University.</p>
<p>This post is about a plugin for the Jupyter Notebook I have written to make it easier to work with Jupyter and the <a href="http://conda.pydata.org/docs/">conda</a> python package manager. Specifically the fantastic <a href="http://conda.pydata.org/docs/using/envs.html">environments</a> feature, which allow you to have multiple different versions of Python and different stacks of packages installed alongside one another.</p>
<p>When working with conda and the Jupyter Notebook you can create a different envronment and install Jupyter into it and then use the notebook from within that environment. This might look something like this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>conda create -n numpy python=3 numpy jupyter
source activate numpy
jupyter notebook</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This approach works fine, but what happens if you want to switch to running your current notebook in the "numpy-1.9" envronment instead to test it with a previous version of NumPy? You would have to do this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Stop the notebook sever then:</p>

<pre><code>source deactivate
source activate numpy-1.9
jupyter notebook</code></pre>
<p>Then reload the notebook you had open before.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What my Notebook plugin does is enables you to switch environments from within a running notebook server, but using the "kernel" feature of the Notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="jupyterhub-kernels.png" alt="Jupyter Kernel Switching"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each entry in the kernel list above that starts with 'Environment' is a conda environment that has Jupyter installed within it, and you can start a notebook using any of those envronments.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The plugin that enables this is <a href="https://github.com/Cadair/jupyter_environment_kernels">jupyter_envrionment_kernels</a> (catchy name I know). It looks in the directories you specify for installed environments which have Jupyter installed (the <code>ipython</code> executable is in the <code>bin/</code> directory) and lists them as kernels for Jupyter to find. This makes it easy to run one notebook instance and access kernels with access to different versions of Python or different modules seamlessly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To solve our earlier problem of "live" switching the kernel we can use the Kernel &gt; Change Kernel menu:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="jupyterhub-running-kernel.png" alt="Jupyter Notebook Switch Running Kernel"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Installing-jupyter_environment_kernels">Installing jupyter_environment_kernels<a class="anchor-link" href="http://stuartmumford.uk/blog/jupyter-notebook-and-conda.html#Installing-jupyter_environment_kernels">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Installation of the package is easy just run</p>

<pre><code>pip install environment_kernels</code></pre>
<p>from within the environment in which you want to run the notebook server.</p>
<p>Then run:</p>

<pre><code>jupyter notebook --generate-config</code></pre>
<p>to generate a Jupyter notebook config file (if you already have one then skip this step), finally edit the config file it has generated (by default this is <code>~/.jupyter/jupyter_notebook_config.py</code>) and add the following two lines:</p>

<pre><code>c.NotebookApp.kernel_spec_manager_class = 'environment_kernels.EnvironmentKernelSpecManager'
c.EnvironmentKernelSpecManager.conda_env_dirs=['~/.conda/envs']</code></pre>
<p>The first line tells the notebook to use the environment_kernels module to manage the kernels, and the second line lists all the directories in which to look for environments with <code>ipython</code> executables. By default (i.e. if you don't provide the second line) it will look in <code>~/.conda/envs</code> and <code>~/.virtualenvs</code> where the top level directory is assumed to be the name of the environment and then it looks inside the <code>bin</code> directory for <code>ipython</code>.</p>
<p>It is also possible to configure the package to use the <code>conda</code> terminal command to find your environments. This will only work if <code>conda</code> is availble from where you ran the notebook command (i.e. you installed the notebook using conda). To use this you just need the:</p>

<pre><code>c.NotebookApp.kernel_spec_manager_class = 'environment_kernels.EnvironmentKernelSpecManager'</code></pre>
<p>configuration line.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This module is still very new so if you enounter any issues please raise issues on <a href="https://github.com/Cadair/jupyter_environment_kernels/issues">GitHub</a>.</p>

</div>
</div>
</div>
    </div>
  </div>

    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="http://stuartmumford.uk/blog/the-fibonacci-sequence.html" rel="prev" title="The Fibonacci Sequence">Previous post</a>
            </li>
            <li class="next">
                <a href="http://stuartmumford.uk/blog/verifying-pypi-and-conda-packages.html" rel="next" title="Verifying PyPI and Conda Packages">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        


        </section><script type="text/javascript" src="MathJax.js"> </script><script type="text/x-mathjax-config;executed=true">

            MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
            </script></article>
</div>

  <div class="footerbox">

    Contents © 2016  <a href="mailto:site@cadair.com">Stuart Mumford</a> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width: 0px;" src="80x15.png"></a> - Powered by         <a href="http://getnikola.com/" rel="nofollow">Nikola</a>
    
  </div>
<!--End of body content-->
</div>

            <script src="jquery.min.js"></script><script src="bootstrap.min.js"></script><script src="all.js"></script><!-- Add Jumbotron scroll js --><script type="text/javascript">//<![CDATA[
$(window).load(function(){
  $(window).scroll(function() {
    var scrolledY = $(window).scrollTop();
    $('.jumbotron').css('background-position', 'left ' + ((scrolledY)) + 'px');
  });
});//]]>
</script><script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>

moment.locale("en");
fancydates(0, "YYYY-MM-DD HH:mm");
</script><!-- end fancy dates --><!-- Abstract hide/show 
<script src"/assets/js/div_toggle.js"></script>
--><script type="text/javascript">

function toggle(showHideDiv, switchTextDiv) {
    var ele = document.getElementById(showHideDiv);
    var text = document.getElementById(switchTextDiv);
    if(ele.style.display == "none") {
        ele.style.display = "block";
        text.innerHTML = "[hide abstract]";
    }
    else {
            ele.style.display = "none";
            text.innerHTML = "[show abstract]";
    }
}
</script><!-- MathJax --><script type="text/javascript" src="MathJax.js">
</script><!-- Piwik --><script type="text/javascript">

  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
  var u="https://mail.cadair.com/analytics/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script><noscript><p><img src="https://mail.cadair.com/analytics/piwik.php?idsite=1" style="border:0;" alt=""></p></noscript>
<!-- End Piwik Code -->




<div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div></body>
</html>
