<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#" class="js csstransforms3d csstransitions wf-opensans3a3002c4002c6002c8007cbreeserif-n4-inactive wf-inactive">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="wpd_version" content="0.2">
<meta name="wpd_baseurl" content="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/">
<meta name="wpd_url" content="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/">
<meta name="wpd_date" content="2016-08-10T06:01Z">


<meta charset="UTF-8">


<link rel="pingback" href="http://www.pyimagesearch.com/xmlrpc.php">
<link rel="shortcut icon" href="favicon.ico">

<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast WordPress SEO plugin v2.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Non-Maximum Suppression for Object Detection in Python - PyImageSearch</title>
<meta name="description" content="Object detection with HOG results in many bounding boxes. You’ll need non-maximum suppression to collapse these boxes. In this post, I’ll show you how.">
<link rel="canonical" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Non-Maximum Suppression for Object Detection in Python - PyImageSearch">
<meta property="og:description" content="Object detection with HOG results in many bounding boxes. You’ll need non-maximum suppression to collapse these boxes. In this post, I’ll show you how.">
<meta property="og:url" content="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/">
<meta property="og:site_name" content="PyImageSearch">
<meta property="article:tag" content="histogram of oriented gradients">
<meta property="article:tag" content="hog">
<meta property="article:tag" content="linear svm">
<meta property="article:tag" content="nms">
<meta property="article:tag" content="non maxima suppression">
<meta property="article:tag" content="non maximum suppression">
<meta property="article:tag" content="svm">
<meta property="article:section" content="Machine Learning">
<meta property="article:published_time" content="2014-11-17T10:00:34+00:00">
<meta property="article:modified_time" content="2015-07-11T08:15:31+00:00">
<meta property="og:updated_time" content="2015-07-11T08:15:31+00:00">
<meta property="og:image" content="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_01.jpg">
<meta property="og:image" content="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_john_coltrane.jpg">
<meta property="og:image" content="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_02.jpg">
<meta property="og:image" content="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_03.jpg">
<meta property="og:image" content="http://www.pyimagesearch.com/wp-content/uploads/2014/02/download-code-icon.png">
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="PyImageSearch » Feed" href="http://feeds.feedburner.com/Pyimagesearch">
<link rel="alternate" type="application/rss+xml" title="PyImageSearch » Comments Feed" href="http://www.pyimagesearch.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="PyImageSearch » Non-Maximum Suppression for Object Detection in Python Comments Feed" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/feed/">
		<div class="fit-vids-style">­</div><script src="54220efd7ab7f03f7e000043.js" async="" type="text/javascript"></script><script src="mlt.js" type="text/javascript" async=""></script><script src="4768429.js" async="" type="text/javascript"></script><script src="analytics.js" async=""></script><script src="mixpanel-2-latest.min.js" async="" type="text/javascript"></script><script type="text/javascript">

			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.pyimagesearch.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.2"}};
			!function(a,b,c){function d(a){var c,d=b.createElement("canvas"),e=d.getContext&&d.getContext("2d"),f=String.fromCharCode;return e&&e.fillText?(e.textBaseline="top",e.font="600 32px Arial","flag"===a?(e.fillText(f(55356,56806,55356,56826),0,0),d.toDataURL().length>3e3):"diversity"===a?(e.fillText(f(55356,57221),0,0),c=e.getImageData(16,16,1,1).data.toString(),e.fillText(f(55356,57221,55356,57343),0,0),c!==e.getImageData(16,16,1,1).data.toString()):("simple"===a?e.fillText(f(55357,56835),0,0):e.fillText(f(55356,57135),0,0),0!==e.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script type="text/javascript" src="wp-emoji-release.min.js"></script>
		







<!--[if lt IE 9]>
<link href="http://www.pyimagesearch.com/wp-content/themes/canvas/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="M9bPKixNLarUMYYydHMz04sSS1L1cjPzAA.js"></script>
<script type="text/javascript">

/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.pyimagesearch.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="M9RPLkqszM_TLa7MK0ms0M3ITM_IAeKS1CL9rGL93Mw8qAI9IBMA.js"></script>
<script type="text/javascript" data-cfasync="false" id="omapi-script" src="api.min.js"></script>
<script type="text/javascript" src="M9BPTswrSyzWz8xLzilNSS3WzyrWL8nILErRLUgsKqnUMcCmIDc_JbUoL7OqCLt0empealFiDgA.js"></script>
<link rel="https://api.w.org/" href="http://www.pyimagesearch.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.pyimagesearch.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.pyimagesearch.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 4.4.2">
<link rel="shortlink" href="http://www.pyimagesearch.com/?p=1371">
<link rel="alternate" type="application/json+oembed" href="http://www.pyimagesearch.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.pyimagesearch.com%2F2014%2F11%2F17%2Fnon-maximum-suppression-object-detection-python%2F">
<link rel="alternate" type="text/xml+oembed" href="http://www.pyimagesearch.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.pyimagesearch.com%2F2014%2F11%2F17%2Fnon-maximum-suppression-object-detection-python%2F&amp;format=xml">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.5.7">
<meta name="generator" content="WooFramework 5.5.5">

<!-- Custom CSS Styling -->

<!-- Options Panel Custom CSS -->



<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->



<!-- start Mixpanel -->
<script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
mixpanel.init("2486e0f021e92605d44d32fce5f1d826");
</script>
<!-- end Mixpanel -->

<script src="jquery.min.js"></script><script src="tagjs" async="" type="text/javascript"></script><img src="untitled" height="1" width="1" border="0"><img src="seg" height="1" width="1" border="0"><img src="seg_001.dat" height="1" width="1" border="0"><img src="seg_002.dat" height="1" width="1" border="0"><script src="webfont.js"></script>
<link rel="stylesheet" type="text/css" href="non-maximum-suppression-object-detection-python.css" media="all">
</head>
<body class="single single-post postid-1371 single-format-standard unknown alt-style-default two-col-left width-960 two-col-left-960 full-width full-header full-footer">
<div id="wrapper">

	<div id="inner-wrapper">

	    <!--#header-container-->
    <div id="header-container">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="http://www.pyimagesearch.com/" title="Be awesome at learning OpenCV, Python, and computer vision"><img src="logo.png" alt="PyImageSearch"></a>
<span class="site-title"><a href="http://www.pyimagesearch.com/">PyImageSearch</a></span>
<span class="site-description">Be awesome at learning OpenCV, Python, and computer vision</span>
</div>

	</header>

	    </div><!--/#header-container-->
    <!--#nav-container-->
    <div id="nav-container">
<nav id="navigation" class="col-full" role="navigation">

	<section class="menus">

		<a href="http://www.pyimagesearch.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-4519" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4519"><a href="http://www.pyimagesearch.com/start-here-learn-computer-vision-opencv/">Start Here</a></li>
<li id="menu-item-2616" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2616"><a href="https://www.pyimagesearch.com/practical-python-opencv/">Practical Python and OpenCV</a></li>
<li id="menu-item-2617" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2617"><a href="https://www.pyimagesearch.com/pyimagesearch-gurus/">PyImageSearch Gurus</a></li>
<li id="menu-item-2615" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2615"><a href="http://www.pyimagesearch.com/opencv-tutorials-resources-guides/">OpenCV 3 Tutorials</a></li>
<li id="menu-item-2618" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2618"><a href="http://www.pyimagesearch.com/free-opencv-crash-course/">FREE OpenCV Crash Course</a></li>
<li id="menu-item-2619" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2619"><a href="http://www.pyimagesearch.com/about/">About</a></li>
<li id="menu-item-2620" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2620"><a href="http://www.pyimagesearch.com/contact/">Contact</a></li>
</ul>	<ul class="rss fr">
						<li class="sub-rss"><a href="http://feeds.feedburner.com/Pyimagesearch"></a></li>
			</ul>
	
	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
    </div><!--/#nav-container-->
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-1371 post type-post status-publish format-standard hentry category-machine-learning-2 category-tutorials tag-histogram-of-oriented-gradients tag-hog tag-linear-svm tag-nms tag-non-maxima-suppression tag-non-maximum-suppression tag-svm">
	<header>
	<h1 class="title">Non-Maximum Suppression for Object Detection in Python</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="http://www.pyimagesearch.com/author/adrian/" title="Posts by Adrian Rosebrock" rel="author">Adrian Rosebrock</a></span></span> <span class="small">on</span> <abbr class="date time published" title="2014-11-17T10:00:34-0400">November 17, 2014</abbr>  <span class="small">in</span> <span class="categories"><a href="http://www.pyimagesearch.com/category/machine-learning-2/" title="View all items in Machine Learning">Machine Learning</a>, <a href="http://www.pyimagesearch.com/category/tutorials/" title="View all items in Tutorials">Tutorials</a></span>  </div>
	<section class="entry">
<div style="width: 623px;" id="fsb-social-bar" class="fsb-social-bar" data-post-id="1371" data-socialite="true"><div class="fsb-share-twitter fsb-hide-count"><a href="https://twitter.com/share?original_referer=http%3A%2F%2Fwww.pyimagesearch.com%2F&amp;source=tweetbutton&amp;text=Non-Maximum+Suppression+for+Object+Detection+in+Python&amp;url=http%3A%2F%2Fwww.pyimagesearch.com%2F2014%2F11%2F17%2Fnon-maximum-suppression-object-detection-python%2F&amp;via=pyimagesearch" class="socialite twitter fsb-twitter" data-fsb-service="twitter" rel="nofollow" target="_top" title="Be the first one to tweet this article!"><span class="fsb-service-title">Twitter</span><span class="fsb-count">0</span></a></div><div class="fsb-share-facebook"><a href="http://www.facebook.com/sharer.php?u=http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" class="socialite facebook fsb-facebook" data-fsb-service="facebook" data-href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" data-send="false" data-layout="button_count" data-width="60" data-show-faces="false" rel="nofollow" target="_top"><span class="fsb-service-title">Facebook</span><span class="fsb-count">8</span></a></div><div class="fsb-share-google"><a href="https://plus.google.com/share?url=http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" class="socialite googleplus fsb-google" data-fsb-service="google" data-size="medium" data-href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" rel="nofollow" target="_top"><span class="fsb-service-title">Google+</span><span class="fsb-count">2</span></a></div><div class="fsb-share-linkedin"><a href="https://www.linkedin.com/cws/share?url=http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" class="socialite linkedin fsb-linkedin" data-fsb-service="linkedin" data-size="medium" data-href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" rel="nofollow" target="_top"><span class="fsb-service-title">LinkedIn</span><span class="fsb-count">3</span></a></div></div><div class="fsb-clear"></div><p><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_01.jpg"><img class="aligncenter wp-image-1436" src="nms_slow_01.jpg" alt="Applying non-maximum suppression to an image" srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_01-300x193.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_01.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px" height="386" width="600"></a></p>
<p>Connecticut is cold. Very cold. Sometimes it’s hard to even get out of bed in the morning. And honestly, without the aide of copious amounts of pumpkin spice lattes and the beautiful sunrise over the crisp autumn leaves, I don’t think I would leave my cozy bed.</p>
<p>But I have work to do. And today that work includes writing a blog post about&nbsp;Felzenszwalb et al. method for non-maximum suppression.</p>
<p>If you remember, last week we discussed <a href="http://www.pyimagesearch.com/2014/11/10/histogram-oriented-gradients-object-detection/" target="_top">Histogram of Oriented Gradients for Objection Detection</a>.</p>
<p>This method can be broken into a <strong>6-step process</strong>, including:</p>
<ol>
<li>Sampling positive images</li>
<li>Sampling negative images</li>
<li>Training a Linear SVM</li>
<li>Performing hard-negative mining</li>
<li>Re-training your Linear SVM using the hard-negative samples</li>
<li>Evaluating your classifier on your test dataset, utilizing non-maximum suppression to ignore redundant, overlapping bounding boxes</li>
</ol>
<p>After applying these steps you’ll have an object detector that is as smooth as, well, John Coltrane:</p>
<div id="attachment_1441" style="width: 328px;" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_john_coltrane.jpg"><img class="wp-image-1441" src="nms_john_coltrane.jpg" alt="Figure 1: My Python object detection framework applied to face detection. Even in low contrast images, faces can be easily detected." height="350" width="318"></a><p class="wp-caption-text"><strong>Figure 1:</strong> My Python object detection framework applied to face detection. Even in low contrast images, faces can be easily detected.</p></div>
<p><em>(Note: Images utilized in this post were taken from the <a href="http://vasc.ri.cmu.edu/idb/html/face/frontal_images/" target="_top">MIT + CMU Frontal Face Images dataset</a>)</em></p>
<p>These are the bare minimum steps required to build an object classifier using Histogram of Oriented Gradients. Extensions to this method exist including&nbsp;Felzenszwalb et al.’s <a href="http://cs.brown.edu/~pff/papers/lsvm-pami.pdf" target="_top">deformable parts model</a> and&nbsp;Malisiewicz et al.’s <a href="http://www.cs.cmu.edu/~efros/exemplarsvm-iccv11.pdf" target="_top">Exemplar SVM</a>.</p>
<p>However, no matter which HOG + Linear SVM&nbsp;method you choose, you will (with almost 100% certainty) detect multiple bounding boxes surrounding the object in the image.</p>
<p>For example, take a look at the image of Audrey Hepburn at the top of this post. I forked&nbsp;my Python framework for object detection using HOG and a Linear SVM and trained it to detect faces. Clearly, it has found Ms. Hepburns face in the image — but the detection fired a total of&nbsp;<strong>six</strong> times!</p>
<p>While each detection may in fact be valid, I certainty don’t want my classifier to report to back to me saying that it found&nbsp;<strong>six faces</strong> when there is clearly only&nbsp;<strong>one face</strong>. Like I said, this is common “problem” when utilizing object detection methods.</p>
<p>In fact, I don’t even want to call it a “problem” at all! It’s a good problem to have. It indicates that your detector is working as expected. It would be far worse if your detector either (1) reported a false positive (i.e. detected a face where one wasn’t) or (2) failed to detect a face.</p>
<p>To fix this situation&nbsp;we’ll need to apply Non-Maximum Suppression (NMS), also called Non-Maxima Suppression.</p>
<p>When I first implemented my Python object detection framework I was unaware of a good Python implementation for Non-Maximum Suppression, so I reached out to my friend <a href="http://people.csail.mit.edu/tomasz/" target="_top">Dr. Tomasz&nbsp;Malisiewicz</a>, whom I consider to be the “go to” person on the topic of object detection and HOG.</p>
<p>Tomasz, being the all-knowing authority on the topic referred me to two implementations in MATLAB which I have since implemented in Python. We’re going to review the <a href="https://github.com/rbgirshick/voc-dpm/blob/master/test/nms.m" target="_top">first method by&nbsp;Felzenszwalb etl al.</a> Then, next week, we’ll review the (faster) non-maximum suppression method implemented by Tomasz himself.</p>
<p>So without very delay, let’s get our hands dirty.</p>
<div style="padding-top: 10px; padding-bottom: 15px; padding-right: 10px; height: 70px; background: transparent url('download-code-icon.png') no-repeat ; 0% / 70px 70px;">
<p style="margin-top: 1px; margin-left: 80px; font-weight: bold;">Looking for the source code to this post?<br>
<a id="scroll_to_code" href="#">Jump right to the downloads section.</a></p>
<p style="margin-top: 1px; margin-left: 80px; font-weight: bold;">
</p></div>
<p><strong>OpenCV and Python versions:</strong><br>
This example will run on<strong>&nbsp;Python 2.7/Python 3.4+</strong> and <strong>OpenCV 2.4.X/OpenCV 3.0+</strong>.</p>
<h1>Non-Maximum Suppression for Object Detection in Python</h1>
<p>Open up a file, name it 
			<span id="crayon-57d3965fbc2db346184244" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">nms</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>&nbsp;, and let’s get started implementing the Felzenszwalb et al. method for non-maximum suppression in Python:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d3965fbc2ee717888806" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><span class="crayon-title">Non-Maximum Suppression for Object Detection in Python</span>
			<div class="crayon-tools" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div style="display: none;" class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px ! important; line-height: 16.8px ! important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="" readonly="" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># import the necessary packages
import numpy as np

#  Felzenszwalb et al.
def non_max_suppression_slow(boxes, overlapThresh):
	# if there are no boxes, return an empty list
	if len(boxes) == 0:
		return []

	# initialize the list of picked indexes
	pick = []

	# grab the coordinates of the bounding boxes
	x1 = boxes[:,0]
	y1 = boxes[:,1]
	x2 = boxes[:,2]
	y2 = boxes[:,3]

	# compute the area of the bounding boxes and sort the bounding
	# boxes by the bottom-right y-coordinate of the bounding box
	area = (x2 - x1 + 1) * (y2 - y1 + 1)
	idxs = np.argsort(y2)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px ! important; line-height: 15px ! important;"><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-2">2</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-4">4</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-6">6</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-8">8</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-10">10</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-12">12</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-14">14</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-16">16</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-18">18</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-20">20</div><div class="crayon-num" data-line="crayon-57d3965fbc2ee717888806-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc2ee717888806-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px ! important; line-height: 15px ! important; -moz-tab-size: 4;"><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">np</span></div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-4"><span class="crayon-c">#&nbsp;&nbsp;Felzenszwalb et al.</span></div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-5"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">non_max_suppression_slow</span><span class="crayon-sy">(</span><span class="crayon-v">boxes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">overlapThresh</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-6"><span class="crayon-h">	</span><span class="crayon-c"># if there are no boxes, return an empty list</span></div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-7"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">boxes</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-8"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-10"><span class="crayon-h">	</span><span class="crayon-c"># initialize the list of picked indexes</span></div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-11"><span class="crayon-h">	</span><span class="crayon-v">pick</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-12">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-13"><span class="crayon-h">	</span><span class="crayon-c"># grab the coordinates of the bounding boxes</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-14"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-15"><span class="crayon-h">	</span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-16"><span class="crayon-h">	</span><span class="crayon-v">x2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-17"><span class="crayon-h">	</span><span class="crayon-v">y2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-18">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-19"><span class="crayon-h">	</span><span class="crayon-c"># compute the area of the bounding boxes and sort the bounding</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-20"><span class="crayon-h">	</span><span class="crayon-c"># boxes by the bottom-right y-coordinate of the bounding box</span></div><div class="crayon-line" id="crayon-57d3965fbc2ee717888806-21"><span class="crayon-h">	</span><span class="crayon-v">area</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc2ee717888806-22"><span class="crayon-h">	</span><span class="crayon-v">idxs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argsort</span><span class="crayon-sy">(</span><span class="crayon-v">y2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0044 seconds] -->
<p>We’ll start on <strong>Line 2</strong> by importing a single package, NumPy, which we’ll utilize for numerical processing.</p>
<p>From there we define our 
			<span id="crayon-57d3965fbc2fb656174137" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">non_max_suppression_slow</span></span></span>&nbsp;&nbsp;function on <strong>Line 5</strong>. this function accepts to arguments, the first being our set of bounding boxes in the form of <em>(startX, startY, endX, endY)</em>&nbsp;and the second being our overlap threshold. I’ll discuss the overlap threshold a little later on in this post.</p>
<p><strong>Lines 7 and 8</strong> make a quick check on the bounding boxes. If there are no bounding boxes in the list, simply return an empty list back to the caller.</p>
<p>From there, we initialize our list of picked bounding boxes (i.e. the bounding boxes that we would like to keep, discarding the rest) on&nbsp;<strong>Line 11</strong>.</p>
<p>Let’s go ahead and unpack the&nbsp;<em>(x, y)</em> coordinates for each corner of the bounding box on&nbsp;<strong>Lines 14-17 </strong>— this is done using simple NumPy array slicing.</p>
<p>Then we compute the area of each of the bounding boxes on&nbsp;<strong>Line 21</strong> using our sliced&nbsp;<em>(x, y)</em> coordinates.</p>
<p>Be sure to pay close attention to&nbsp;<strong>Line 22</strong>. We apply 
			<span id="crayon-57d3965fbc306337540786" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">argsort</span></span></span>&nbsp;&nbsp;to grab the indexes of the&nbsp;<em><strong>sorted</strong></em> coordinates of the <b><i>bottom-right</i>&nbsp;<em>y-coordinate</em></b>&nbsp;of the bounding boxes. It is <em>absolutely critical</em> that we sort according to the bottom-right corner as we’ll need to compute the overlap ratio of other bounding boxes later in this function.</p>
<p>Now, let’s get into the meat of the non-maxima suppression function:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d3965fbc310616461622" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><span class="crayon-title">Non-Maximum Suppression for Object Detection in Python</span>
			<div class="crayon-tools" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div style="display: none;" class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px ! important; line-height: 16.8px ! important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="" readonly="" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># import the necessary packages
import numpy as np

#  Felzenszwalb et al.
def non_max_suppression_slow(boxes, overlapThresh):
	# if there are no boxes, return an empty list
	if len(boxes) == 0:
		return []

	# initialize the list of picked indexes
	pick = []

	# grab the coordinates of the bounding boxes
	x1 = boxes[:,0]
	y1 = boxes[:,1]
	x2 = boxes[:,2]
	y2 = boxes[:,3]

	# compute the area of the bounding boxes and sort the bounding
	# boxes by the bottom-right y-coordinate of the bounding box
	area = (x2 - x1 + 1) * (y2 - y1 + 1)
	idxs = np.argsort(y2)

	# keep looping while some indexes still remain in the indexes
	# list
	while len(idxs) &gt; 0:
		# grab the last index in the indexes list, add the index
		# value to the list of picked indexes, then initialize
		# the suppression list (i.e. indexes that will be deleted)
		# using the last index
		last = len(idxs) - 1
		i = idxs[last]
		pick.append(i)
		suppress = [last]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px ! important; line-height: 15px ! important;"><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc310616461622-24">24</div><div class="crayon-num" data-line="crayon-57d3965fbc310616461622-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc310616461622-26">26</div><div class="crayon-num" data-line="crayon-57d3965fbc310616461622-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc310616461622-28">28</div><div class="crayon-num" data-line="crayon-57d3965fbc310616461622-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc310616461622-30">30</div><div class="crayon-num" data-line="crayon-57d3965fbc310616461622-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc310616461622-32">32</div><div class="crayon-num" data-line="crayon-57d3965fbc310616461622-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc310616461622-34">34</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px ! important; line-height: 15px ! important; -moz-tab-size: 4;"><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc310616461622-24"><span class="crayon-h">	</span><span class="crayon-c"># keep looping while some indexes still remain in the indexes</span></div><div class="crayon-line" id="crayon-57d3965fbc310616461622-25"><span class="crayon-h">	</span><span class="crayon-c"># list</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc310616461622-26"><span class="crayon-h">	</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">idxs</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57d3965fbc310616461622-27"><span class="crayon-h">		</span><span class="crayon-c"># grab the last index in the indexes list, add the index</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc310616461622-28"><span class="crayon-h">		</span><span class="crayon-c"># value to the list of picked indexes, then initialize</span></div><div class="crayon-line" id="crayon-57d3965fbc310616461622-29"><span class="crayon-h">		</span><span class="crayon-c"># the suppression list (i.e. indexes that will be deleted)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc310616461622-30"><span class="crayon-h">		</span><span class="crayon-c"># using the last index</span></div><div class="crayon-line" id="crayon-57d3965fbc310616461622-31"><span class="crayon-h">		</span><span class="crayon-v">last</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">idxs</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc310616461622-32"><span class="crayon-h">		</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">idxs</span><span class="crayon-sy">[</span><span class="crayon-v">last</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-57d3965fbc310616461622-33"><span class="crayon-h">		</span><span class="crayon-v">pick</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc310616461622-34"><span class="crayon-h">		</span><span class="crayon-v">suppress</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">last</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0048 seconds] -->
<p>We start looping over our indexes on <strong>Line 26</strong>, where we will keep looping until we run out of indexes to examine.</p>
<p>From there we’ll grab the length of the 
			<span id="crayon-57d3965fbc31c843643921" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">idx</span></span></span>&nbsp;&nbsp;list o <strong>Line 31</strong>, grab the value of the last entry in the 
			<span id="crayon-57d3965fbc326500933782" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">idx</span></span></span>&nbsp;&nbsp;list on&nbsp;<strong>Line 32</strong>, append the index 
			<span id="crayon-57d3965fbc32f572072736" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">i</span></span></span>&nbsp;&nbsp;to our list of bounding boxes to keep on <b>Line 33</b>, and finally initialize our 
			<span id="crayon-57d3965fbc338550815182" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">suppress</span></span></span>&nbsp;&nbsp;list (the list of boxes we want to ignore) with index of the last entry of the index list on&nbsp;<strong>Line 34</strong>.</p>
<p>That was a mouthful. And since we’re dealing with indexes into a index list it’s not exactly an easy thing to explain. But definitely pause here and examine these code as it’s important to understand.</p>
<p>Time to compute the&nbsp;overlap ratios and determine which bounding boxes we can ignore:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d3965fbc340364920409" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><span class="crayon-title">Non-Maximum Suppression for Object Detection in Python</span>
			<div class="crayon-tools" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div style="display: none;" class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px ! important; line-height: 16.8px ! important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="" readonly="" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># import the necessary packages
import numpy as np

#  Felzenszwalb et al.
def non_max_suppression_slow(boxes, overlapThresh):
	# if there are no boxes, return an empty list
	if len(boxes) == 0:
		return []

	# initialize the list of picked indexes
	pick = []

	# grab the coordinates of the bounding boxes
	x1 = boxes[:,0]
	y1 = boxes[:,1]
	x2 = boxes[:,2]
	y2 = boxes[:,3]

	# compute the area of the bounding boxes and sort the bounding
	# boxes by the bottom-right y-coordinate of the bounding box
	area = (x2 - x1 + 1) * (y2 - y1 + 1)
	idxs = np.argsort(y2)

	# keep looping while some indexes still remain in the indexes
	# list
	while len(idxs) &gt; 0:
		# grab the last index in the indexes list, add the index
		# value to the list of picked indexes, then initialize
		# the suppression list (i.e. indexes that will be deleted)
		# using the last index
		last = len(idxs) - 1
		i = idxs[last]
		pick.append(i)
		suppress = [last]

		# loop over all indexes in the indexes list
		for pos in xrange(0, last):
			# grab the current index
			j = idxs[pos]

			# find the largest (x, y) coordinates for the start of
			# the bounding box and the smallest (x, y) coordinates
			# for the end of the bounding box
			xx1 = max(x1[i], x1[j])
			yy1 = max(y1[i], y1[j])
			xx2 = min(x2[i], x2[j])
			yy2 = min(y2[i], y2[j])

			# compute the width and height of the bounding box
			w = max(0, xx2 - xx1 + 1)
			h = max(0, yy2 - yy1 + 1)

			# compute the ratio of overlap between the computed
			# bounding box and the bounding box in the area list
			overlap = float(w * h) / area[j]

			# if there is sufficient overlap, suppress the
			# current bounding box
			if overlap &gt; overlapThresh:
				suppress.append(pos)

		# delete all indexes from the index list that are in the
		# suppression list
		idxs = np.delete(idxs, suppress)

	# return only the bounding boxes that were picked
	return boxes[pick]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px ! important; line-height: 15px ! important;"><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-36">36</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-38">38</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-40">40</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-42">42</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-44">44</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-46">46</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-48">48</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-50">50</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-52">52</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-54">54</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-56">56</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-58">58</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-60">60</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-62">62</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-64">64</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc340364920409-66">66</div><div class="crayon-num" data-line="crayon-57d3965fbc340364920409-67">67</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px ! important; line-height: 15px ! important; -moz-tab-size: 4;"><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-36"><span class="crayon-h">		</span><span class="crayon-c"># loop over all indexes in the indexes list</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-37"><span class="crayon-h">		</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">pos </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">xrange</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">last</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-38"><span class="crayon-h">			</span><span class="crayon-c"># grab the current index</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-39"><span class="crayon-h">			</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">idxs</span><span class="crayon-sy">[</span><span class="crayon-v">pos</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-40">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc340364920409-41"><span class="crayon-h">			</span><span class="crayon-c"># find the largest (x, y) coordinates for the start of</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-42"><span class="crayon-h">			</span><span class="crayon-c"># the bounding box and the smallest (x, y) coordinates</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-43"><span class="crayon-h">			</span><span class="crayon-c"># for the end of the bounding box</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-44"><span class="crayon-h">			</span><span class="crayon-v">xx1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-45"><span class="crayon-h">			</span><span class="crayon-v">yy1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">y1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-46"><span class="crayon-h">			</span><span class="crayon-v">xx2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">min</span><span class="crayon-sy">(</span><span class="crayon-v">x2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x2</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-47"><span class="crayon-h">			</span><span class="crayon-v">yy2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">min</span><span class="crayon-sy">(</span><span class="crayon-v">y2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-48">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc340364920409-49"><span class="crayon-h">			</span><span class="crayon-c"># compute the width and height of the bounding box</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-50"><span class="crayon-h">			</span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xx2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">xx1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-51"><span class="crayon-h">			</span><span class="crayon-v">h</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yy2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">yy1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-52">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc340364920409-53"><span class="crayon-h">			</span><span class="crayon-c"># compute the ratio of overlap between the computed</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-54"><span class="crayon-h">			</span><span class="crayon-c"># bounding box and the bounding box in the area list</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-55"><span class="crayon-h">			</span><span class="crayon-v">overlap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">area</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-56">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc340364920409-57"><span class="crayon-h">			</span><span class="crayon-c"># if there is sufficient overlap, suppress the</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-58"><span class="crayon-h">			</span><span class="crayon-c"># current bounding box</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-59"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">overlap</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">overlapThresh</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-60"><span class="crayon-h">				</span><span class="crayon-v">suppress</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">pos</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-61">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-62"><span class="crayon-h">		</span><span class="crayon-c"># delete all indexes from the index list that are in the</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-63"><span class="crayon-h">		</span><span class="crayon-c"># suppression list</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-64"><span class="crayon-h">		</span><span class="crayon-v">idxs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">delete</span><span class="crayon-sy">(</span><span class="crayon-v">idxs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suppress</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-65">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc340364920409-66"><span class="crayon-h">	</span><span class="crayon-c"># return only the bounding boxes that were picked</span></div><div class="crayon-line" id="crayon-57d3965fbc340364920409-67"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-v">pick</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0110 seconds] -->
<p>Here we start looping over the (remaining) indexes in the 
			<span id="crayon-57d3965fbc34a884098976" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">idx</span></span></span>&nbsp;&nbsp;list on&nbsp;<strong>Line 37</strong>, grabbing the value of the current index on&nbsp;<strong>Line 39</strong>.</p>
<p>Using <strong><em>last</em></strong> entry in the 
			<span id="crayon-57d3965fbc34f184383772" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">idx</span></span></span>&nbsp;&nbsp;list from&nbsp;<strong>Line 32</strong> and the&nbsp;<em><strong>current</strong></em> entry in the 
			<span id="crayon-57d3965fbc354674873472" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">idx</span></span></span>&nbsp;&nbsp;list from <strong>Line 39</strong>, we find the <strong><em>largest</em></strong>&nbsp;<em>(x, y)</em> coordinates for the start bounding box and the&nbsp;<em><strong>smallest</strong></em>&nbsp;<em>(x, y)</em> coordinates for the end of the bounding box on&nbsp;<strong>Lines 44-47</strong>.</p>
<p>Doing this allows us to find the current smallest region inside the larger bounding boxes (and hence why it’s so important that we initially sort our 
			<span id="crayon-57d3965fbc359019179650" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">idx</span></span></span>&nbsp;&nbsp;list according to the bottom-right y-coordinate). From there, we compute the width and height of the region on&nbsp;<strong>Lines 50 and 51</strong>.</p>
<p>So now we are at the point where the overlap threshold comes into play. On&nbsp;<strong>Line 55</strong>&nbsp;we compute the 
			<span id="crayon-57d3965fbc361573371576" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">overlap</span></span></span>&nbsp;, which is a ratio defined by the area of the current smallest region divided by the area of current bounding box, where “current” is defined by the index 
			<span id="crayon-57d3965fbc369400597358" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">j</span></span></span>&nbsp;&nbsp;on&nbsp;<strong>Line 39</strong>.</p>
<p>If the 
			<span id="crayon-57d3965fbc372774968326" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">overlap</span></span></span>&nbsp;&nbsp;ratio is greater than the threshold on&nbsp;<strong>Line 59</strong>, then we know that the two bounding boxes sufficiently overlap and we can thus suppress the current bounding box. Common values for 
			<span id="crayon-57d3965fbc37a669268787" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">overlapThresh</span></span></span>&nbsp;&nbsp;are normally between 0.3 and 0.5.</p>
<p><strong>Line 64</strong> then deletes the suppressed bounding boxes from the 
			<span id="crayon-57d3965fbc383216692472" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">idx</span></span></span>&nbsp;&nbsp;list and we continue looping until the 
			<span id="crayon-57d3965fbc38d206962986" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">idx</span></span></span>&nbsp;&nbsp;list is empty.</p>
<p>Finally, we return the set of picked bounding boxes (the ones that were not suppressed) on&nbsp;<strong>Line 67</strong>.</p>
<p>Let’s go ahead and create a driver so we can execute this code and see it in action. Open up a new file, name it 
			<span id="crayon-57d3965fbc396829833881" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">nms_slow</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></span></span>&nbsp;, and add the following code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d3965fbc3a0537392142" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><span class="crayon-title">Non-Maximum Suppression for Object Detection in Python</span>
			<div class="crayon-tools" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div style="display: none;" class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px ! important; line-height: 16.8px ! important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="" readonly="" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># import the necessary packages
from pyimagesearch.nms import non_max_suppression_slow
import numpy as np
import cv2

# construct a list containing the images that will be examined
# along with their respective bounding boxes
images = [
	("images/audrey.jpg", np.array([
	(12, 84, 140, 212),
	(24, 84, 152, 212),
	(36, 84, 164, 212),
	(12, 96, 140, 224),
	(24, 96, 152, 224),
	(24, 108, 152, 236)])),
	("images/bksomels.jpg", np.array([
	(114, 60, 178, 124),
	(120, 60, 184, 124),
	(114, 66, 178, 130)])),
	("images/gpripe.jpg", np.array([
	(12, 30, 76, 94),
	(12, 36, 76, 100),
	(72, 36, 200, 164),
	(84, 48, 212, 176)]))]

# loop over the images
for (imagePath, boundingBoxes) in images:
	# load the image and clone it
	print "[x] %d initial bounding boxes" % (len(boundingBoxes))
	image = cv2.imread(imagePath)
	orig = image.copy()

	# loop over the bounding boxes for each image and draw them
	for (startX, startY, endX, endY) in boundingBoxes:
		cv2.rectangle(orig, (startX, startY), (endX, endY), (0, 0, 255), 2)

	# perform non-maximum suppression on the bounding boxes
	pick = non_max_suppression_slow(boundingBoxes, 0.3)
	print "[x] after applying non-maximum, %d bounding boxes" % (len(pick))

	# loop over the picked bounding boxes and draw them
	for (startX, startY, endX, endY) in pick:
		cv2.rectangle(image, (startX, startY), (endX, endY), (0, 255, 0), 2)

	# display the images
	cv2.imshow("Original", orig)
	cv2.imshow("After NMS", image)
	cv2.waitKey(0)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px ! important; line-height: 15px ! important;"><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-2">2</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-4">4</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-6">6</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-8">8</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-10">10</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-12">12</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-14">14</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-16">16</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-18">18</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-20">20</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-22">22</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-24">24</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-26">26</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-28">28</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-30">30</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-32">32</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-34">34</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-36">36</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-38">38</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-40">40</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-42">42</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-44">44</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-46">46</div><div class="crayon-num" data-line="crayon-57d3965fbc3a0537392142-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-57d3965fbc3a0537392142-48">48</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px ! important; line-height: 15px ! important; -moz-tab-size: 4;"><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">pyimagesearch</span><span class="crayon-sy">.</span><span class="crayon-e">nms </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">non_max_suppression_slow</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-6"><span class="crayon-c"># construct a list containing the images that will be examined</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-7"><span class="crayon-c"># along with their respective bounding boxes</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-8"><span class="crayon-v">images</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-9"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-s">"images/audrey.jpg"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-10"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">84</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">140</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">212</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-11"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">24</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">84</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">152</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">212</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-12"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">36</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">84</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">164</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">212</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-13"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">96</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">140</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">224</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-14"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">24</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">96</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">152</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">224</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-15"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">24</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">108</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">152</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">236</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-16"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-s">"images/bksomels.jpg"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-17"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">114</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">178</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">124</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-18"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">120</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">184</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">124</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-19"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">114</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">66</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">178</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">130</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-20"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-s">"images/gpripe.jpg"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-21"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">76</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">94</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-22"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">76</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-23"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">72</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">164</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-24"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">84</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">212</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">176</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-26"><span class="crayon-c"># loop over the images</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-27"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">imagePath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boundingBoxes</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">images</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-28"><span class="crayon-h">	</span><span class="crayon-c"># load the image and clone it</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-29"><span class="crayon-h">	</span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"[x] %d initial bounding boxes"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">boundingBoxes</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-30"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">imagePath</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-31"><span class="crayon-h">	</span><span class="crayon-v">orig</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-32">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-33"><span class="crayon-h">	</span><span class="crayon-c"># loop over the bounding boxes for each image and draw them</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-34"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">boundingBoxes</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-35"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">rectangle</span><span class="crayon-sy">(</span><span class="crayon-v">orig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-36">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-37"><span class="crayon-h">	</span><span class="crayon-c"># perform non-maximum suppression on the bounding boxes</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-38"><span class="crayon-h">	</span><span class="crayon-v">pick</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">non_max_suppression_slow</span><span class="crayon-sy">(</span><span class="crayon-v">boundingBoxes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-39"><span class="crayon-h">	</span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-s">"[x] after applying non-maximum, %d bounding boxes"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">pick</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-40">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-41"><span class="crayon-h">	</span><span class="crayon-c"># loop over the picked bounding boxes and draw them</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-42"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">pick</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-43"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">rectangle</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-44">&nbsp;</div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-45"><span class="crayon-h">	</span><span class="crayon-c"># display the images</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-46"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Original"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">orig</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57d3965fbc3a0537392142-47"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"After NMS"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57d3965fbc3a0537392142-48"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0113 seconds] -->
<p>We start by importing our 
			<span id="crayon-57d3965fbc3ac716484233" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">non_max_suppression_slow</span></span></span>&nbsp;&nbsp;function on <strong>Line 2</strong>. I put this function in the 
			<span id="crayon-57d3965fbc3b6782381040" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">pyimagesearch</span></span></span>&nbsp;&nbsp;package for organizational purposes, but you can put the function wherever you see fit. From there, we import NumPy for numerical processing and 
			<span id="crayon-57d3965fbc3c0953123782" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">cv2</span></span></span>&nbsp;&nbsp;for our OpenCV bindings on&nbsp;<strong>Lines 3-4</strong>.</p>
<p>Then, we define a list of 
			<span id="crayon-57d3965fbc3c9416302318" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="line-height: 15px ! important; font-size: 12px ! important;"><span class="crayon-pre crayon-code" style="line-height: 15px ! important; font-size: 12px ! important; -moz-tab-size: 4;"><span class="crayon-v">images</span></span></span>&nbsp;&nbsp;on <strong>Line 8</strong>. This list consists of 2-tuples, where the first entry in the tuple is a path to an image and the second entry is the list of bounding boxes. These bounding boxes were obtained from my HOG + Linear SVM classifier detecting potential “faces” at varying locations and scales. Our goal is to take the set of bounding boxes for each image and apply non-maximum suppression.</p>
<p>We start by looping over the image path and bounding boxes on&nbsp;<strong>Line 27&nbsp;</strong>and load the image on&nbsp;<strong>Line 30</strong>.</p>
<p>To visualize the results of&nbsp;non-maximum suppression&nbsp;in action, we first draw the original (non-suppressed) bounding boxes on&nbsp;<strong>Lines 34 and 35</strong>.</p>
<p>We then apply non-maximum suppression on&nbsp;<strong>Line 38</strong> and draw the picked bounding boxes on&nbsp;<strong>Lines 42-43</strong>.</p>
<p>The resulting images are finally displayed on&nbsp;<strong>Lines 46-48</strong>.</p>
<h1>Non-Maximum Suppression in Action</h1>
<p>To see the Felzenszwalb et al. non-maximum suppression method in action, download the source code and accompanying images for this post from the bottom of this page, navigate to the source code directory, and issue the following command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57d3965fbc3d3184527451" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px ! important; line-height: 15px ! important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><span class="crayon-title">Non-Maximum Suppression for Object Detection in Python</span>
			<div class="crayon-tools" style="font-size: 12px ! important; height: 18px ! important; line-height: 18px ! important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div style="display: none;" class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px ! important; line-height: 16.8px ! important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="" readonly="" style="-moz-tab-size: 4; font-size: 12px ! important; line-height: 15px ! important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">$ python nms_slow.py</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table style="" class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px ! important; line-height: 15px ! important;"><div class="crayon-num" data-line="crayon-57d3965fbc3d3184527451-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px ! important; line-height: 15px ! important; -moz-tab-size: 4;"><div class="crayon-line" id="crayon-57d3965fbc3d3184527451-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">nms_slow</span><span class="crayon-e">.py</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>First, you’ll see the Audrey Hepburn image:</p>
<div id="attachment_1436" style="width: 610px;" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_01.jpg"><img class="wp-image-1436" src="nms_slow_01.jpg" alt="Figure 1: Our classifier initially detected six bounding boxes, but by applying non-maximum suppression, we are left with only one (the correct) bounding box." srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_01-300x193.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_01.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px" height="386" width="600"></a><p class="wp-caption-text"><strong>Figure 2:</strong> Our classifier initially detected <strong>six</strong> bounding boxes, but by applying non-maximum suppression, we are left with only <strong>one</strong> (the correct) bounding box.</p></div>
<p>Notice how <strong>six</strong>&nbsp;bounding boxes were detected, but by applying non-maximum suppression, we are able to prune this number down to <strong>one</strong>.</p>
<p>The same is true for the second image:</p>
<div id="attachment_1437" style="width: 610px;" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_02.jpg"><img class="wp-image-1437" src="nms_slow_02.jpg" alt="Figure 2: Initially detecting three bounding boxes, but by applying non-maximum suppression we can prune the number of overlapping bounding boxes down to one." srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_02-300x190.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_02.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px" height="381" width="600"></a><p class="wp-caption-text"><strong>Figure 3:</strong> Initially detecting <strong>three</strong> bounding boxes, but by applying non-maximum suppression we can prune the number of overlapping bounding boxes down to <strong>one</strong>.</p></div>
<p>Here we have found <strong>three</strong> bounding boxes corresponding to the same face, but non-maximum suppression is about to reduce this number to&nbsp;<strong>one</strong> bounding box.</p>
<p>So far we have only examined images that contain one face. But what about images that contain multiple faces? Let’s take a look:</p>
<div id="attachment_1438" style="width: 610px;" class="wp-caption aligncenter"><a href="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_03.jpg"><img class="wp-image-1438" src="nms_slow_03.jpg" alt="Figure 3: Non-maximum suppression correctly handles when there are multiple faces, suppressing the smaller overlapping bounding boxes, but retaining the boxes that do not overlap." srcset="http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_03-300x192.jpg 300w, http://www.pyimagesearch.com/wp-content/uploads/2014/10/nms_slow_03.jpg 1000w" sizes="(max-width: 600px) 100vw, 600px" height="385" width="600"></a><p class="wp-caption-text"><strong>Figure 4:</strong> Non-maximum suppression correctly handles when there are multiple faces, suppressing the smaller overlapping bounding boxes, but retaining the boxes that do not overlap.</p></div>
<p>Even for images that contain multiple objects, non-maximum suppression is able to ignore the smaller overlapping bounding boxes and return only the larger ones. Non-maximum suppression returns&nbsp;<strong>two</strong> bounding boxes here because the bounding boxes for each face at all. And even if they <em>did</em> overlap,&nbsp;do the overlap ratio does not exceed the supplied threshold of 0.3.</p>
<h1>Summary</h1>
<p>In this blog post I showed you how to apply the&nbsp;Felzenszwalb et al. method for non-maximum suppression.</p>
<p>When using the Histogram of Oriented Gradients descriptor and a Linear Support Vector Machine for object classification you almost&nbsp;<em>always</em> detect multiple bounding boxes surrounding the object you want to detect.</p>
<p>Instead of returning&nbsp;<em>all</em> of the found bounding boxes you should first apply non-maximum suppression to ignore bounding boxes that significantly overlap each other.</p>
<p>However, there are improvements to be made to the&nbsp;Felzenszwalb et al. method for non-maximum suppression.</p>
<p>In my next post I’ll implement the method suggested by my friend Dr. Tomasz&nbsp;Malisiewicz which is reported to be over <i>100x</i> faster!</p>
<p>Be sure to download the code to this post using the form below! You’ll definitely want to have it handy when we examine Tomasz’s non-maximum suppression algorithm next week!</p>
<h1 id="post_downloads">Downloads:</h1>
<div id="mc4wp-form-1" class="form mc4wp-form mc4wp-form-761">
<form data-drip-id="2697" action="https://www.getdrip.com/forms/1856491/submissions" method="post" target="_blank" data-drip-embedded-form="2697"><img style="padding-right: 10px; width: 115px; border: medium none; float: left;" src="download-code-icon.png" alt="">If you would like to download the code and images used in this post, please enter your email address in the form below. Not only will you get a .zip of the code, I’ll also send you a <strong>FREE 11-page Resource Guide</strong> on Computer Vision and Image Search Engines, including <strong>exclusive techniques</strong> that I don’t post on this blog! Sound good? If so, enter your email address and I’ll send you the code immediately!<p></p>
<p style="margin-left: 130px;"><label for="fields[email]">Email address:</label><input name="fields[email]" value="" placeholder="Your email address" type="email"></p>
<p style="margin-left: 130px;"><input value="Download the code!" type="submit"></p>
<input value="Australia/Brisbane" name="time_zone" type="hidden"><input value="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" name="url" type="hidden"><input value="Non-Maximum Suppression for Object Detection in Python - PyImageSearch" name="page_title" type="hidden"></form>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
		<aside id="connect">
		<h3>Resource Guide (it’s totally free).</h3>

		<div>
			<p><img title="Get your FREE 11-page Image Search Engine Resource Guide PDF" src="imagesearchengine-resourceguide-cover.png" style="padding-right: 10px; float: left;">
</p><div style="padding-top: 35px;">

Enter your email address below to get my <strong>free 11-page Image Search Engine Resource Guide PDF</strong>. Uncover <strong>exclusive techniques</strong> that I don't publish on this blog and start building image search engines of your own!</div><p></p>

			
						<form data-drip-id="1295" action="https://www.getdrip.com/forms/1113813/submissions" method="post" target="_blank" data-drip-embedded-form="1295">
				<div>
					<input name="fields[email]" class="required email" value="" placeholder="Your email address" style="width: 50%;" type="email">
				</div>
				<div>
					<input id="mc-embedded-subscribe" name="submit" class="btn submit button" value="Download the Guide!" data-drip-attribute="sign-up-button" type="submit">
				</div>
			<input value="Australia/Brisbane" name="time_zone" type="hidden"><input value="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" name="url" type="hidden"><input value="Non-Maximum Suppression for Object Detection in Python - PyImageSearch" name="page_title" type="hidden"></form>
			
						<div class="social">
		   					</div>
			
		</div><!-- col-left -->

		
        <div class="fix"></div>
	</aside>
	<div class="post-utility"><p class="tags"><i class="icon-tag"></i> <a href="http://www.pyimagesearch.com/tag/histogram-of-oriented-gradients/" rel="tag">histogram of oriented gradients</a>, <a href="http://www.pyimagesearch.com/tag/hog/" rel="tag">hog</a>, <a href="http://www.pyimagesearch.com/tag/linear-svm/" rel="tag">linear svm</a>, <a href="http://www.pyimagesearch.com/tag/nms/" rel="tag">nms</a>, <a href="http://www.pyimagesearch.com/tag/non-maxima-suppression/" rel="tag">non maxima suppression</a>, <a href="http://www.pyimagesearch.com/tag/non-maximum-suppression/" rel="tag">non maximum suppression</a>, <a href="http://www.pyimagesearch.com/tag/svm/" rel="tag">svm</a></p> </div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="http://www.pyimagesearch.com/2014/11/10/histogram-oriented-gradients-object-detection/" rel="prev"><i class="icon-angle-left"></i> Histogram of Oriented Gradients and Object Detection</a></div>
	            <div class="nav-next fr"><a href="http://www.pyimagesearch.com/2014/11/24/detecting-barcodes-images-python-opencv/" rel="next">Detecting Barcodes in Images with Python and OpenCV <i class="icon-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">18 Responses to <em>Non-Maximum Suppression for Object Detection in Python</em></h3>
		 	<ol class="commentlist">
					                 
		<li class="comment even thread-even depth-1 parent">
	    
	    	<a name="comment-182299"></a>
	      	
	      	<div id="li-comment-182299" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="96c2bca4b647b6302a56480259088c8f" srcset="http://0.gravatar.com/avatar/96c2bca4b647b6302a56480259088c8f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">rajacheers</span>           
	                <span class="date">November 18, 2014 at 11:19 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-182299" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-182299">
				
				<p>Hi</p>
<p>Thanks for the great post.</p>
<p>I noticed if the first coordinate in bigger, it cant suppress them</p>
<p>Examples boxes like<br>
[[348  98 234 234]<br>
[345 102 233 233]<br>
[338 100 238 238]],</p>
<p>[[175  80  32  32]<br>
 [276  93  30  30]<br>
 [176  81  30  30]<br>
 [276  93  30  30]<br>
 [177  81  29  29]<br>
 [277  93  29  29]].</p>
<p>What can be improved to make this work?</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=182299#respond" onclick="return addComment.moveForm( &quot;comment-182299&quot;, &quot;182299&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to rajacheers">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2 parent">
	    
	    	<a name="comment-182356"></a>
	      	
	      	<div id="li-comment-182356" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="02743529311d3b8babbaf6935670ec9c" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 18, 2014 at 12:01 pm</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-182356" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-182356">
				
				<p>Please note my comment in the post:</p>
<blockquote><p>It is absolutely critical that we sort according to the bottom-right corner as we’ll need to compute the overlap ratio of other bounding boxes later in this function.</p></blockquote>
<p>The algorithm assumes that the coordinates are in the following order: (x-coordinate of the top-left, y-coordinate of the top-left, x-coordinate of the bottom-right, and y-coordinate of the bottom right). If for some reason you are worried about the order of the coordinates, simply perform a check and re-order as necessary. I wouldn’t call this an “improvement”, just an assumption of the non-maximum suppression algorithm that can be easily guaranteed by checking the points beforehand.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=182356#respond" onclick="return addComment.moveForm( &quot;comment-182356&quot;, &quot;182356&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Adrian Rosebrock">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-3 parent">
	    
	    	<a name="comment-272634"></a>
	      	
	      	<div id="li-comment-272634" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="928ffe5637151e2964f1495f025b9523" srcset="http://0.gravatar.com/avatar/928ffe5637151e2964f1495f025b9523?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Morné</span>           
	                <span class="date">January 26, 2015 at 12:37 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-272634" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-272634">
				
				<p>I’m also suspicious about the rationale for “picking” the bottom box (irrespective of horizontal position), and not the biggest box. Would you mind clarifying?</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=272634#respond" onclick="return addComment.moveForm( &quot;comment-272634&quot;, &quot;272634&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Morné">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-4 parent">
	    
	    	<a name="comment-272747"></a>
	      	
	      	<div id="li-comment-272747" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="02743529311d3b8babbaf6935670ec9c" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">January 26, 2015 at 6:44 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-272747" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-272747">
				
				<p>You are picking the largest bounding box since they are sorted by area prior to the actual suppression algorithm being run.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=272747#respond" onclick="return addComment.moveForm( &quot;comment-272747&quot;, &quot;272747&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Adrian Rosebrock">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-5">
	    
	    	<a name="comment-342432"></a>
	      	
	      	<div id="li-comment-342432" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="618b4a84cd93ac25f00de0616d16da5d" srcset="http://0.gravatar.com/avatar/618b4a84cd93ac25f00de0616d16da5d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Artem</span>           
	                <span class="date">August 4, 2015 at 8:20 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-342432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-342432">
				
				<p>But you are using variable ‘area’ inly in the line 55, no sorting by the area are performed. Clarify please.</p>
		            
										
	                <div class="reply">
	                    	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-5">
	    
	    	<a name="comment-342494"></a>
	      	
	      	<div id="li-comment-342494" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="02743529311d3b8babbaf6935670ec9c" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">August 4, 2015 at 1:16 pm</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-342494" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-342494">
				
				<p>Sorting is actually performed on <strong>Line 22</strong>. The area is used to determine the overlap, and if the overlap exceeds the threshold, then the indexes can be removed. <strong>Line 22</strong> can also be replaced to sort via some other value, such as the score or probability of the detection returned by the SVM.</p>
		            
										
	                <div class="reply">
	                    	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1 parent">
	    
	    	<a name="comment-268016"></a>
	      	
	      	<div id="li-comment-268016" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="f3b789aec541303a989944a2e7d9b182" srcset="http://0.gravatar.com/avatar/f3b789aec541303a989944a2e7d9b182?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Juan</span>           
	                <span class="date">January 16, 2015 at 5:42 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-268016" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-268016">
				
				<p>Hi Adrian, </p>
<p>Are you going to publish a tutorial on Malisiewicz et al.’s Exemplar SVM? In the HoG tutorial you commented that you had already implemented their algorithm in python.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=268016#respond" onclick="return addComment.moveForm( &quot;comment-268016&quot;, &quot;268016&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Juan">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-268036"></a>
	      	
	      	<div id="li-comment-268036" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="02743529311d3b8babbaf6935670ec9c" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">January 16, 2015 at 7:31 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-268036" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-268036">
				
				<p>Hi Juan, you are correct. I am publishing a tutorial on the Malisiewicz et al. method for non-maximum suppression (not the entire Exemplar SVM framework). However, due to poor blog post planning on my part, I had to push the post back to accommodate a few other posts that needed to get ASAP. However, I will definitely get the faster version of non-maximum suppression posted later in January or early February.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=268036#respond" onclick="return addComment.moveForm( &quot;comment-268036&quot;, &quot;268036&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Adrian Rosebrock">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1 parent">
	    
	    	<a name="comment-290079"></a>
	      	
	      	<div id="li-comment-290079" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="4a27b9674a548a94f7459cbd69cf407a" srcset="http://1.gravatar.com/avatar/4a27b9674a548a94f7459cbd69cf407a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Mikael</span>           
	                <span class="date">March 17, 2015 at 9:33 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-290079" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-290079">
				
				<p>Hi Adrian,</p>
<p>Thanks for this post. There may be a difference between your implementation and the original one.<br>
In the matlab code, it looks like the initial sort is done on detection scores, not the y coordinate: <a href="https://github.com/rbgirshick/voc-dpm/blob/master/test/nms.m#L40-L43" rel="nofollow">https://github.com/rbgirshick/voc-dpm/blob/master/test/nms.m#L40-L43</a><br>
The documentation is not very clear about what “boxes” is (“Detection bounding boxes (see pascal_test.m)”) but the method is meant to select “high-scoring detections” <a href="https://github.com/rbgirshick/voc-dpm/blob/master/test/nms.m#L5-L6" rel="nofollow">https://github.com/rbgirshick/voc-dpm/blob/master/test/nms.m#L5-L6</a>.<br>
I guess your version end-up selecting the detection with highest “y”.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=290079#respond" onclick="return addComment.moveForm( &quot;comment-290079&quot;, &quot;290079&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Mikael">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-290147"></a>
	      	
	      	<div id="li-comment-290147" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="02743529311d3b8babbaf6935670ec9c" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">March 17, 2015 at 11:29 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-290147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-290147">
				
				<p>Hi Mikael, thanks for pointing this out to me! In the future I’ll issue an update to this post that includes the scoring of each bounding box.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=290147#respond" onclick="return addComment.moveForm( &quot;comment-290147&quot;, &quot;290147&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Adrian Rosebrock">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1 parent">
	    
	    	<a name="comment-345077"></a>
	      	
	      	<div id="li-comment-345077" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="dc1f14b624c027069c8b5c4d82935768" srcset="http://1.gravatar.com/avatar/dc1f14b624c027069c8b5c4d82935768?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Alex</span>           
	                <span class="date">August 12, 2015 at 11:05 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-345077" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-345077">
				
				<p>Thanks for an awesome post as always!</p>
<p>You mention in one of your comments above:<br>
“Line 22 can also be replaced to sort via some other value, such as the score or probability of the detection returned by the SVM.”</p>
<p>That’s exactly what I’m looking for. I want to be able to keep the highest scoring boxes returned by my neural network (those with the higher prob of being in the positive class), and smartly merge all nearby bounding boxes with that highest scoring box. Should changing line 22 to sort by my neural network score do this? I tried that, and it’s not working for me. I’m wondering if you have suggestions of other things that might need changing.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=345077#respond" onclick="return addComment.moveForm( &quot;comment-345077&quot;, &quot;345077&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-345440"></a>
	      	
	      	<div id="li-comment-345440" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="02743529311d3b8babbaf6935670ec9c" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">August 13, 2015 at 7:10 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-345440" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-345440">
				
				<p>Hey Alex — yes, you are correct. Change Line 22 to sort by the score of the bounding box returned by your neural network instead of the y-coordinate. Make sure that your bounding box scores corresponding to the <em>(x, y)</em>-coordinates of your bounding boxes that you pass into the function. I would also suggest creating a separate <code>scores</code> parameter to the function.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=345440#respond" onclick="return addComment.moveForm( &quot;comment-345440&quot;, &quot;345440&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Adrian Rosebrock">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1 parent">
	    
	    	<a name="comment-367649"></a>
	      	
	      	<div id="li-comment-367649" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="0c7f7d533399f139237fa583d28c5099" srcset="http://0.gravatar.com/avatar/0c7f7d533399f139237fa583d28c5099?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Nico</span>           
	                <span class="date">October 7, 2015 at 1:13 pm</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-367649" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-367649">
				
				<p>Is there a specific reason to bias the area by +1 in each dimension on line 21?</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=367649#respond" onclick="return addComment.moveForm( &quot;comment-367649&quot;, &quot;367649&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Nico">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2 parent">
	    
	    	<a name="comment-367721"></a>
	      	
	      	<div id="li-comment-367721" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="02743529311d3b8babbaf6935670ec9c" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">October 7, 2015 at 3:57 pm</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-367721" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-367721">
				
				<p>It simply avoids any type of “divide by zero” errors.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=367721#respond" onclick="return addComment.moveForm( &quot;comment-367721&quot;, &quot;367721&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Adrian Rosebrock">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-3">
	    
	    	<a name="comment-368092"></a>
	      	
	      	<div id="li-comment-368092" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="0c7f7d533399f139237fa583d28c5099" srcset="http://0.gravatar.com/avatar/0c7f7d533399f139237fa583d28c5099?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Nico</span>           
	                <span class="date">October 8, 2015 at 11:35 am</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-368092" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-368092">
				
				<p>Thanks, makes sense!</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=368092#respond" onclick="return addComment.moveForm( &quot;comment-368092&quot;, &quot;368092&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Nico">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1 parent">
	    
	    	<a name="comment-398183"></a>
	      	
	      	<div id="li-comment-398183" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="dce5a113416c97280ce6c41f3b34d34a" srcset="http://1.gravatar.com/avatar/dce5a113416c97280ce6c41f3b34d34a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Mayank</span>           
	                <span class="date">May 19, 2016 at 1:34 pm</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-398183" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-398183">
				
				<p>Hi adrian,<br>
How do I add features while doing hard negative mining. I have extracted HOG features for both positive and negative class and have trained my model. Now if i do sliding window on training set of negative class i will get features of a window. Now the problem is feature matrix of complete image is larger than that of a small window so how would i add these new features to my existing features list. Also since the images are same there will be redundant features too, so how to avoid redundant data here??</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=398183#respond" onclick="return addComment.moveForm( &quot;comment-398183&quot;, &quot;398183&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Mayank">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-398190"></a>
	      	
	      	<div id="li-comment-398190" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="02743529311d3b8babbaf6935670ec9c" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">May 19, 2016 at 5:55 pm</span>
	                <span class="perma"><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#comment-398190" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-398190">
				
				<p>I would save your hard-negative feature vectors to a separate file (such as CSV, HDF5, whatever file format you are using to store your current feature vectors from the original training data). Once you have your hard-negatives saved to disk, load both the hard-negatives and original data and stack them together. For this, I like using the <code>np.hstack</code> function. I cover this in more detail inside <a target="blank" href="https://www.pyimagesearch.com/pyimagesearch-gurus/" rel="nofollow">PyImageSearch Gurus</a>.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/?replytocom=398190#respond" onclick="return addComment.moveForm( &quot;comment-398190&quot;, &quot;398190&quot;, &quot;respond&quot;, &quot;1371&quot; )" aria-label="Reply to Adrian Rosebrock">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 				 	<h3 id="comments-title">Trackbacks/Pingbacks</h3>
			 	<ol class="commentlist">
						
		<li id="comment-279872">
			<span class="author"><a href="https://www.pyimagesearch.com/2015/02/16/faster-non-maximum-suppression-python/" rel="external nofollow" class="url">(Faster) Non-Maximum Suppression in Python - PyImageSearch</a></span> - 
			<span class="date">February 16, 2015</span>
			<span class="pingcontent"><p>[…] Last week I showed you how to implement the&nbsp;Felzenszwalb et al. method. And this week I am going to show you the Malisiewicz et al. method which is over 100x faster. […]</p>
</span>
</li><!-- #comment-## -->
				</ol>
			</div>				<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/#respond" style="display: none;">Click here to cancel reply.</a></small></h3>				<form action="http://www.pyimagesearch.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" class="txt" tabindex="1" value="" size="30" aria-required="true" type="text"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" class="txt" tabindex="2" value="" size="30" aria-required="true" type="text"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" class="txt" tabindex="3" value="" size="30" type="text"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Submit Comment" type="submit"> <input name="comment_post_ID" value="1371" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="489a17e504" type="hidden"></p><p style="display: none;"></p>				<input id="ak_js" name="ak_js" value="1473487210682" type="hidden"></form>
					</div><!-- #respond -->
		     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="text-7" class="widget widget_text"><h3>Resource Guide (it’s totally free).</h3>			<div class="textwidget"><img title="Get your FREE 11-page Image Search Engine Resource Guide PDF" src="imagesearchengine-resourceguide-cover.png" style="padding-right: 10px; width: 100px; float: left;">
<p>

Click the button below to get my <strong>free 11-page Image Search Engine Resource Guide PDF</strong>. Uncover <strong>exclusive techniques</strong> that I don't publish on this blog and start building image search engines of your own.
</p>
<div style="clear: left;"></div>

<center><a href="#" class="manual-optin-trigger" data-optin-slug="rxgemdcavzehuzpr" style="color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #DF4B4B;">Download for Free!</a></center></div>
		</div><div id="text-5" class="widget widget_text"><h3>You can detect faces in images &amp; video.</h3>			<div class="textwidget"><a href="http://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection" title="Practical Python and OpenCV"><img title="Learn how to detect faces in images and video" src="adrian_face_detection_sidebar.png" style="padding-bottom: 5px; width: 300px;" onclick="document.location='http://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection'; return false;"></a>
<p>

Are you interested in <strong>detecting faces in images &amp; video?</strong> But <strong>tired of Googling for tutorials</strong> that <em>never work?</em> Then let me help! I guarantee that my new book will turn you into a <strong>face detection ninja</strong> by the end of this weekend.
<a href="http://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection" title="Practical Python and OpenCV" onclick="document.location='http://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection'; return false;">Click here to give it a shot yourself.</a>
</p>
<p><input value="Click here to master face detection" style="background-color: rgb(223, 75, 75);" onclick="document.location='http://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection'; return false;" type="submit"></p></div>
		</div><div id="text-8" class="widget widget_text"><h3>PyImageSearch Gurus: NOW ENROLLING!</h3>			<div class="textwidget"><div id="pyimg_gurus_carousel_container" style="width: 300px; height: 310px; cursor: pointer;" onclick="document.location='http://www.pyimagesearch.com/pyimagesearch-gurus/?src=sidebar'; return false;">
	<div id="pyimg_gurus_carousel" style="width: 300px; height: 300px; background: transparent url('gurus_carousel.jpg') no-repeat ; -600px; display: block;"></div>
</div>
<p style="margin-bottom: 8px;"><strong>The PyImageSearch Gurus course is <em>now enrolling!</em></strong> Inside the course you'll learn how to perform:</p>
<ul style="margin-bottom: 8px;">
	<li>Automatic License Plate Recognition (ANPR)</li>
	<li>Deep Learning</li>
	<li>Face Recognition</li>
	<li><em>and much more!</em></li>
</ul>
<p><strong>Click the button below to learn more about the course, take a tour, and get 10 (FREE) sample lessons</strong>.</p>
<p><input value="Take a tour &amp; get 10 (free) lessons" style="background-color: rgb(223, 75, 75);" onclick="document.location='http://www.pyimagesearch.com/pyimagesearch-gurus/?src=sidebar'; return false;" type="submit"></p></div>
		</div><div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Hello! I’m Adrian Rosebrock.</h3><span class="left"><img alt="" src="02743529311d3b8babbaf6935670ec9c_001.dat" srcset="http://0.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=180&amp;d=mm&amp;r=g 2x" class="avatar avatar-90 photo" height="90" width="90"></span>
<p>I'm an entrepreneur and Ph.D who has launched two successful image search engines, <a target="blank" href="http://www.idmypill.com/">ID My Pill</a> and <a target="blank" href="http://www.chicengine.com/">Chic Engine</a>. I'm here to share my tips, tricks, and hacks I've learned along the way.</p>
<div class="fix"></div>
</div><div id="text-4" class="widget widget_text"><h3>Learn computer vision in a single weekend.</h3>			<div class="textwidget"><a href="http://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend" title="Practical Python and OpenCV"><img title="Become an OpenCV guru" src="practical_python_and_opencv_2nd_cover.png" style="margin-left: 35px; padding-bottom: 15px; width: 215px;"></a>
<p>Want to learn computer vision &amp; OpenCV? I can teach you in a <strong>single weekend</strong>. I know. It sounds crazy, but it’s no joke. My new book is your <strong>guaranteed, quick-start guide</strong> to becoming an OpenCV Ninja. So why not give it a try? <a href="http://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend" title="Practical Python and OpenCV">Click here to become a computer vision ninja.</a></p>
<p><input value="Click here to become an OpenCV ninja" style="background-color: rgb(223, 75, 75);" onclick="document.location='http://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend'; return false;" type="submit"></p></div>
		</div><div id="text-3" class="widget widget_text"><h3>Subscribe via RSS</h3>			<div class="textwidget"><a target="blank" href="http://feeds.feedburner.com/Pyimagesearch"><img title="PyImageSearch RSS Feed" src="rss-icon.png" style="padding-right: 10px; float: left;"></a>
<p><strong>Never miss a post!</strong> Subscribe to the PyImageSearch RSS Feed and keep up to date with my image search engine tutorials, tips, and tricks</p></div>
		</div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a class="selected" href="#tab-pop">Popular</a></li>                                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul style="display: block;" id="tab-pop" class="list">
                    	<li>
				<a title="Install OpenCV and Python on your Raspberry Pi 2 and B+" href="http://www.pyimagesearch.com/2015/02/23/install-opencv-and-python-on-your-raspberry-pi-2-and-b/">Install OpenCV and Python on your Raspberry Pi 2 and B+</a>
		<span class="meta">February 23, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Home surveillance and motion detection with the Raspberry Pi, Python, OpenCV, and Dropbox" href="http://www.pyimagesearch.com/2015/06/01/home-surveillance-and-motion-detection-with-the-raspberry-pi-python-and-opencv/">Home surveillance and motion detection with the Raspberry Pi, Python, OpenCV, and Dropbox</a>
		<span class="meta">June 1, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="How to install OpenCV 3 on Raspbian Jessie" href="http://www.pyimagesearch.com/2015/10/26/how-to-install-opencv-3-on-raspbian-jessie/">How to install OpenCV 3 on Raspbian Jessie</a>
		<span class="meta">October 26, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Install OpenCV 3.0 and Python 2.7+ on Ubuntu" href="http://www.pyimagesearch.com/2015/06/22/install-opencv-3-0-and-python-2-7-on-ubuntu/">Install OpenCV 3.0 and Python 2.7+ on Ubuntu</a>
		<span class="meta">June 22, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Accessing the Raspberry Pi Camera with OpenCV and Python" href="http://www.pyimagesearch.com/2015/03/30/accessing-the-raspberry-pi-camera-with-opencv-and-python/">Accessing the Raspberry Pi Camera with OpenCV and Python</a>
		<span class="meta">March 30, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Install OpenCV 3.0 and Python 2.7+ on OSX" href="http://www.pyimagesearch.com/2015/06/15/install-opencv-3-0-and-python-2-7-on-osx/">Install OpenCV 3.0 and Python 2.7+ on OSX</a>
		<span class="meta">June 15, 2015</span>
		<div class="fix"></div>
	</li>
		<li style="border-bottom: 0px none;">
				<a title="Basic motion detection and tracking with Python and OpenCV" href="http://www.pyimagesearch.com/2015/05/25/basic-motion-detection-and-tracking-with-python-and-opencv/">Basic motion detection and tracking with Python and OpenCV</a>
		<span class="meta">May 25, 2015</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         <div id="woo_search-2" class="widget widget_woo_search"><h3>Search</h3><div class="search_main">
    <form method="get" class="searchform" action="http://www.pyimagesearch.com/">
        <input class="field s" name="s" value="Search..." onfocus="if (this.value == 'Search...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search...';}" type="text">
                <button type="submit" class="icon-search submit" name="submit" value="Search"></button>
    </form>    
    <div class="fix"></div>
</div>
</div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
    <!--#footer-widgets-container-->
    <div id="footer-widgets-container">
	</div><!--/#footer_widgets_container_end-->
    <!--#footer_container_start-->
    <div id="footer-container">
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">

			Find me on <a target="blank" href="https://twitter.com/pyimagesearch" style="font-weight: bold; color: rgb(255, 255, 255);">Twitter</a>, <a target="blank" href="https://www.facebook.com/pyimagesearch" style="font-weight: bold; color: rgb(255, 255, 255);">Facebook</a>, <a target="blank" href="https://plus.google.com/115909176846554117735/?rel=author" style="font-weight: bold; color: rgb(255, 255, 255);">Google+</a>, and <a target="blank" href="http://www.linkedin.com/pub/adrian-rosebrock/2a/873/59b" style="font-weight: bold; color: rgb(255, 255, 255);">LinkedIn</a>.<br>
			<p>© 2016 PyImageSearch. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
		</div>

	</footer>

	    </div><!--/#footer_container_end-->

	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<script>

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46641058-1', 'pyimagesearch.com');
  ga('send', 'pageview');

</script>

<!-- Drip -->
<script type="text/javascript">

  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '4768429';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/4768429.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>

<!-- HitTail Code -->
<script type="text/javascript">

	(function(){ var ht = document.createElement('script');ht.async = true;
	  ht.type='text/javascript';ht.src = '//115962.hittail.com/mlt.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ht, s);})();
</script>

<script type="text/javascript">

  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.perfectaudience.com/serve/54220efd7ab7f03f7e000043.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);

// visited blog tracking
window._pq = window._pq || [];
_pq.push(['track', 'visited blog']);
  })();
</script>

<!-- -- scroll to code ---->
<script type="text/javascript">

jQuery(document).ready(function(){
	jQuery("#scroll_to_code").click(function(event){
		event.preventDefault();
		jQuery('html, body').animate({scrollTop: jQuery('#post_downloads').offset().top}, 1000);
	});
});
</script>

<!-- gurus sidebar carousel -->
<script type="text/javascript">

	jQuery(document).ready(function(){
		GURUS_CAROUSEL_IDX = 1;

		window.setInterval(function(){
			jQuery("#pyimg_gurus_carousel").fadeOut(function(){
				GURUS_CAROUSEL_TOP = GURUS_CAROUSEL_IDX * -300;
				jQuery("#pyimg_gurus_carousel").css("background-position", "0px " + GURUS_CAROUSEL_TOP + "px");
				GURUS_CAROUSEL_IDX += 1;

				if (GURUS_CAROUSEL_IDX == 4){
					GURUS_CAROUSEL_IDX = 0;
				}
			}).delay(250).fadeIn();
		}, 5000);
	});
</script>
<!-- Woo Tabs Widget -->
<script type="text/javascript">

jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com --><div id="om-rxgemdcavzehuzpr-holder"><script type="text/javascript">if(!(window.ga&&ga.create)){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','__omGaTracker');}</script></div><script>var rxgemdcavzehuzpr,rxgemdcavzehuzpr_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){rxgemdcavzehuzpr_poll(function(){if(window['om_loaded']){if(!rxgemdcavzehuzpr){rxgemdcavzehuzpr=new OptinMonsterApp();return rxgemdcavzehuzpr.init({u:"18464.329426",staging:0,dev:0,beta:0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;rxgemdcavzehuzpr=new OptinMonsterApp();rxgemdcavzehuzpr.init({u:"18464.329426",staging:0,dev:0,beta:0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script><!-- / OptinMonster --><script type="text/javascript" src="M9RPzM4szk0t0Y_PzEvWT8svytUx0U_Oz81NzSvRLUotyKnUy83MA4qVF-im5ialpoC4AA.js"></script>
<script type="text/javascript">

/* <![CDATA[ */
var fsb = {"ajax":"http:\/\/www.pyimagesearch.com\/wp-admin\/admin-ajax.php","nonce":"8e3e80e61f"};
/* ]]> */
</script>
<script type="text/javascript" src="M9RPy8lPLMnMS9ctzk_OTMzRTUos0s8q1k8rTgIA.js"></script>
<script type="text/javascript">var omapi_localized = { ajax: 'http://www.pyimagesearch.com/wp-admin/admin-ajax.php?optin-monster-ajax-route=1', nonce: '2d97c25867' };</script>
	    


<div class="drip-tab-container">
  <div id="drip-1305" class="drip-tab bottom right no-image">
    <div id="drip-header-1305" class="drip-header">
      <a href="#" id="drip-toggle-1305" class="drip-toggle">
        <h2 id="drip-teaser-1305">Free 21-day crash course on computer vision &amp; image search engines</h2>
        <span id="drip-tab-up-1305" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-1305" class="drip-arrow down" style="display: none;"></span>
      </a>
    </div>

    <div style="height: auto; bottom: -436px;" id="drip-content-1305" class="drip-content drip-clearfix">
      <div style="display: block;" id="drip-form-panel-1305" class="drip-panel">
        <a id="drip-close-1305" class="drip-close">×</a>
        <h3 id="drip-content-header-1305">Free 21-day crash course on computer vision &amp; image search engines</h3>
        <div id="drip-scroll-1305" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description">Interested in computer vision and image search engines, but don't know where to start? Let me help. I've created a free, 21-day crash course that is hand-tailored to give you the best possible introduction to computer vision. Sound good? Enter your email below to start your journey to becoming a computer vision master.</div>
          </div>
          <form action="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" id="drip-form-1305">
            <div style="display: none;">
              <input name="form_id" value="1305" type="hidden">
            </div>
            <dl class="no-labels">
              
                <dt>Email Address</dt>
                <dd class="drip-clearfix">
                  
                    <input name="fields[email]" value="" placeholder="Email Address" class="drip-text-field" type="email">
                    <div id="drip-errors-for-email-1305" class="drip-errors"></div>
                  
                </dd>
              
            </dl>
            <div class="form-controls">
              <input name="submit" value="Let's do it!" id="drip-submit-1305" class="drip-submit-button" type="submit">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-1305" class="drip-success drip-panel drip-clearfix" style="display: none;">
        <a id="drip-hide-1305" class="drip-close">×</a>
        <h3>Almost There...</h3>
        <p class="drip-description">To start your free 21-day crash course, confirm your email address by clicking the link in the email I just sent you.</p>
      </div>

      
    </div>
  </div>
</div><div id="om-rxgemdcavzehuzpr" class="atlanta-background atlanta-rxgemdcavzehuzpr atlanta-optin-visible atlanta-has-image atlanta-lightbox atlanta-bullseye" style="display: none; position: fixed; z-index: 7371832; top: 0px; left: 0px; width: 100%; height: 100%; margin: 0px; padding: 0px;"><div id="atlanta-optin" class="atlanta-clearfix atlanta-outer-wrap" style=""><div id="atlanta-body" class="atlanta-element-row atlanta-element-row-global atlanta-body" data-selectable="true" data-target="#builder-setting-bg_border" style="border-color: rgb(26, 159, 230);"><a class="atlanta-element-close atlanta-close" title="Close" style=""></a><div id="atlanta-content" class="atlanta-clearfix atlanta-content"><div id="atlanta-element-image" class="atlanta-element-image atlanta-element" data-element="image"><div id="atlanta-image" class="atlanta-image" data-image-id="main" data-context="lightbox" data-theme="bullseye"><img class="atlanta-element-image-output" src="7960fd4dacde1462303655-optin.png" alt="7960fd4dacde1462303655-optin.png" data-image-id="main" data-context="lightbox" data-theme="bullseye"></div></div></div><div id="atlanta-footer" class="atlanta-clearfix atlanta-footer" data-selectable="true" data-target="#builder-setting-footer_bg" style="background-color: rgb(233, 233, 233); border-top-color: rgb(187, 187, 187);"><div id="atlanta-element-form" class="atlanta-element-form atlanta-element" data-element="form"><div id="atlanta-form" class="atlanta-form atlanta-has-email atlanta-form-horizontal atlanta-has-buttons"><div class="atlanta-form-wrap"><input id="atlanta-field-email" name="atlanta-email" data-selectable="true" data-target="#builder-setting-email_value" class="atlanta-field-email" placeholder="Enter your email address here..." value="" style="color: rgb(72, 72, 72); font-family: Open Sans;" type="email"><input id="atlanta-field-submit" name="atlanta-submit" data-selectable="true" data-target="#builder-setting-submit_value" class="atlanta-field-submit" value="DOWNLOAD MY PDF" style="color: rgb(255, 255, 255); background: rgb(26, 159, 230) none repeat ; 0%; border-color: rgb(23, 143, 214); font-family: Bree Serif;" type="submit"><div id="atlanta-element-privacy" class="atlanta-element-privacy atlanta-element" data-element="privacy"><div class="atlanta-element-privacy-wrap"><div id="atlanta-element-privacy-content" class="atlanta-element-privacy-content" data-editable="true">I hate SPAM and promise to keep your email address safe.</div></div></div></div><div class="atlanta-yesno-wrap" style="display: none;"><button id="atlanta-button-yes" type="button" name="atlanta-yes" data-selectable="true" data-target="#builder-setting-yes_value" data-action="form" data-type="yes" class="atlanta-button-yes atlanta-button-yesno" title="Yes, I Want Access!" style="color: rgb(255, 255, 255); background: rgb(131, 193, 31) none repeat ; 0%; border-color: rgb(131, 193, 31); font-family: Bree Serif;">Yes, I Want Access!</button><button id="atlanta-button-no" type="button" name="atlanta-no" data-selectable="true" data-target="#builder-setting-no_value" data-action="close" data-type="no" class="atlanta-button-no atlanta-button-yesno" title="No Thanks" style="color: rgb(255, 255, 255); background: rgb(102, 102, 102) none repeat ; 0%; border-color: rgb(102, 102, 102); font-family: Bree Serif;">No Thanks</button></div></div></div></div></div><div id="atlanta-success-container" class="atlanta-success-container atlanta-transition-hidden atlanta-success-theme-default"><a class="atlanta-success-element-close atlanta-success-close" title="Close" style="">×</a><div id="atlanta-success-content" class="atlanta-success-clearfix atlanta-success-content" data-selectable="true" data-target="#builder-setting-success_content_bg" style="background-color: rgb(255, 255, 255);"><div id="atlanta-success-element-title" class="atlanta-success-element-title atlanta-success-element optin-monster-saas-success-message" data-element="title"><div class="atlanta-success-element-title-wrap"><div id="atlanta-success-element-title-content" class="atlanta-success-element-title-content" data-editable="true">Thanks for subscribing! Please check your email for further instructions.</div></div></div></div></div></div><!--[if lte IE 9]><script type="text/javascript">var om_ie_browser = true;</script><![endif]--></div></body>
</html>
