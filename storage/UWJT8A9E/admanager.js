"number"!==typeof TNCMS_DotConnect_Tile&&(TNCMS_DotConnect_Tile=1);"undefined"==typeof TNCMS_Used_Ad&&(TNCMS_Used_Ad={});Object.create||(Object.create=function(I){var c=function(){};c.prototype=I;return new c});
if("boolean"!==typeof TNCMS_PAGE_LOADED){TNCMS_PAGE_LOADED=!1;var pageLoaded=function(){TNCMS_PAGE_LOADED=!0};window.addEventListener?window.addEventListener("load",pageLoaded,!1):window.attachEvent?window.attachEvent("onload",pageLoaded):(priorOnLoad=window.onload,window.onload="function"!=typeof window.onload?pageLoaded:function(){priorOnLoad&&priorOnLoad();pageLoaded()})}window.TNCMS||(window.TNCMS={});
window.TNCMS.AdManager||(window.TNCMS.AdManager=function(){function I(a){a=a||{};a.debug&&(r=a.debug,0<r&&("undefined"==typeof console?alert("Please turn on the debugging console!"):(c("Debug level set to: "+r),A=!0)));U(a)&&(a.slot||(z?s("Changing the default domain from "+z+" to "+a.domain+"."):c("Setting the default domain to "+a.domain+"."),z=a.domain,Q=a.secureDomain),window.TNCMS.Tracking||n?window.TNCMS.Tracking&&!n&&(n=!0):(c("Start loading tracking script"),n="loading",E(a,"/shared-content/art/tncms/tracking.js",
function(){n=!0;c("Finished loading tracker script");if(!0!==n)c("Rendering deferred: Tracker script has not been loaded");else{for(sDomain in t)J(sDomain);for(;oAd=R.shift();)F(oAd)}})));if(a.virtualregion)for(regionType in B)a.virtualregion&&a.virtualregion[regionType]&&(B[adType]=a.virtualregion[regionType]);if(a.callback)for(adType in G)"dotconnect"!=adType&&"html"!=adType&&a.callback&&a.callback[adType]&&(G[adType]=a.callback[adType])}function c(a){r&1&&A&&console.info(a)}function s(a){r&2&&
A&&console.warn(a)}function S(a){r&4&&A&&console.error(a)}function E(a,b,c){a=a||{};if(!a.domain||!a.secureDomain)throw Error("Failed to load script ("+b+"): valid domain data not detected");domain="https:"==location.protocol?a.secureDomain:a.domain;var d=document.createElement("script");d.src=location.protocol+"//"+domain+b;d.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(d);"function"==typeof c&&("undefined"!=typeof d.addEventListener?d.addEventListener("load",c,!1):
d.attachEvent("onreadystatechange",function(){"loaded"==d.readyState&&c()}));return d}function U(a){if(!a.domain||!a.secureDomain)return!1;if(u[a.domain])return!0;if(m[a.domain]&&v[a.domain]&&f[a.domain])return c("Using existing configs for "+a.domain),t[a.domain]=t[a.domain]||[],u[a.domain]=!0;m[a.domain]?c("Using existing impression data for "+a.domain):(c("Start loading impression data for "+a.domain),E(a,"/content/tncms/ads/impressions.js",function(){c("Finished loading impression data for "+
a.domain);v[a.domain]&&f[a.domain]&&(u[a.domain]=!0,J(a.domain))}));v[a.domain]?c("Using existing traffic data for "+a.domain):(c("Start loading traffic data for "+a.domain),E(a,"/content/tncms/ads/traffic.js",function(){c("Finished loading traffic data for "+a.domain);m[a.domain]&&f[a.domain]&&(u[a.domain]=!0,J(a.domain))}));f[a.domain]?c("Using existing settings for "+a.domain):(c("Start loading settings for "+a.domain),E(a,"/content/tncms/ads/settings.js",function(){c("Finished loading settings for "+
a.domain);m[a.domain]&&v[a.domain]&&(u[a.domain]=!0,J(a.domain))}));t[a.domain]=[];u[a.domain]="loading";return!0}function J(a){if(!0!==n)return c("Rendering deferred for "+a+": Tracker script has not been loaded"),!1;if(!0!==u[a])return c("Rendering deferred for "+a+": Config scripts have not been loaded"),!1;if(0==t[a].length)return c("No positions for "+a+" currently need rendering"),!1;for(;oConfig=t[a].shift();)K(oConfig)}function L(a){a=a||{};if(a.all){for(sDomain in e)L({domain:sDomain});return!0}if(a.region&&
a.slot){sDomain=a.domain||z;if(e[sDomain]&&e[sDomain][a.region]&&e[sDomain][a.region][a.slot]){if(!f[a.domain][a.region]||!f[a.domain][a.region].refreshable)return c("Ads for "+sDomain+" in "+a.region+" are not refreshable."),!1;c("Refreshing ads for "+sDomain+" in "+a.region+a.slot);K(e[sDomain][a.region][a.slot])}return!0}if(a.region){sDomain=a.domain||z;if(!f[sDomain][a.region]||!f[sDomain][a.region].refreshable)return c("Ads for "+sDomain+" in "+a.region+" are not refreshable."),!1;for(sSlot in e[sDomain][a.region])a.slot=
sSlot,L({domain:sDomain,region:a.region,slot:sSlot});return!0}sDomain=a.domain||z;if(!e[sDomain])return c("No ads to refresh for "+sDomain),!1;for(sRegion in e[sDomain])L({domain:sDomain,region:sRegion});return!0}function K(a){a=a||{};if(!0!==u[a.domain]||!0!==n)return t[a.domain]=t[a.domain]||[],t[a.domain].push(a),!0;if(sPositionCookie=M("tncms_position_"+a.region+"_"+a.slot))if(aData=sPositionCookie.split("&"),iFrequency=parseInt(aData[0],10),nMinutes=(new Date(unescape(aData[1]))-new Date)/6E4,
0<nMinutes){iMinutes=parseInt(nMinutes,10);sMessage="The position "+a.region+a.slot+" has met its frequency cap, which is set to "+iFrequency+" minutes. This position will be available again in ";sMessage=0==iMinutes?sMessage+"under a minute.":1==iMinutes?sMessage+"around a minute.":sMessage+("around "+iMinutes+" minutes.");s(sMessage);try{document.getElementById("blox-ad-position-"+a.region+a.slot).innerHTML=sMessage}catch(b){}return!1}a.position=a.region+a.slot;a.cdn=f[a.domain].cdn||null;a.section=
a.section?a.section:V;k[a.domain]=k[a.domain]||{};k[a.domain][a.region]=k[a.domain][a.region]||{};k[a.domain][a.region][a.slot]=k[a.domain][a.region][a.slot]||!1;if(!a.adList&&!k[a.domain][a.region][a.slot]&&!a.finalRender)return c("Attempting to load ads for "+a.domain+" in "+a.region+a.slot),E(a,"/content/tncms/ads/"+escape(a.region)+"/"+a.slot+".js",function(){c("Finished loading ads for "+a.domain+" in "+a.region+a.slot);a.finalRender=!0;return K(a)}),!1;e[a.domain]&&e[a.domain][a.region]&&e[a.domain][a.region][a.slot]||
(e[a.domain]=e[a.domain]||{},e[a.domain][a.region]=e[a.domain][a.region]||{},e[a.domain][a.region][a.slot]=a);for(iAd in TNCMS_Used_Ad)if(TNCMS_Used_Ad[iAd]==a.position){c("Removing ad #"+iAd+" from used ad list.");delete TNCMS_Used_Ad[iAd];break}try{return c("Generating ad for "+a.domain+" in "+a.position),oAd=W(a),B[oAd.regionType]?B[oAd.regionType](oAd):F(oAd)}catch(g){if("Warning"==g.name?s(g.message):S(g.message),oPositionDiv=document.getElementById("blox-ad-position-"+a.position))oPositionDiv.innerHTML=
"\x3c!-- "+g.message+" --\x3e"}return!1}function F(a){if(!a.type)throw Error("No ad type was found.");if(!G[a.type])throw Error('No callback for type "'+a.type+" was found.");if(!0!==u[a.domain]||!0!==n)return R.push(a),!0;if(r&1&&A){var b={};for(x in a)b[x]=a[x];c(b)}G[a.type](a);TNCMS.Tracking.addEvent({domain:TNCMS.AdManager.isSecure?a.secureDomain:a.domain,app:"bannerad",metric:"impressions",id:a.section+"/"+a.position+"/"+a.uuid});"dotconnect"!=a.type&&(TNCMS_Used_Ad[a.adid]=a.position);f[a.domain][a.region][a.slot]&&
f[a.domain][a.region][a.slot][a.section]&&f[a.domain][a.region][a.slot][a.section].frequency&&(iFrequency=parseInt(f[a.domain][a.region][a.slot][a.section].frequency,10),0<iFrequency&&!M("tncms_position_"+a.region+"_"+a.slot)&&(b=new Date,b.setTime(b.getTime()+6E4*iFrequency),c("Creating frequency cookie for "+a.region+a.slot+". It will expire in "+iFrequency+" minutes."),document.cookie="tncms_position_"+a.region+"_"+a.slot+"="+iFrequency+"&"+escape(b.toUTCString())+"; expires="+b.toUTCString()+
"; path=/"));if(a.frequency_limit)if(sCookieName="tncms_ad_"+a.adid,sCookieValue=M(sCookieName))aData=sCookieValue.split("&"),nAdCount=parseInt(aData[0],10)+1,c("Incrementing frequency limit cookie for "+a.adid),document.cookie=sCookieName+"="+nAdCount+"&"+aData[1]+"; expires="+unescape(aData[1])+"; path=/";else if(a.frequency_number&&a.frequency_type){b=new Date;switch(a.frequency_type){case "minutes":b.setTime(b.getTime()+6E4*a.frequency_number);break;case "hours":b.setTime(b.getTime()+36E5*a.frequency_number);
break;case "days":b.setTime(b.getTime()+864E5*a.frequency_number)}var g="; expires="+b.toUTCString();c("Creating frequency limit cookie for "+a.adid);document.cookie=sCookieName+"=1&"+escape(b.toUTCString())+g+"; path=/"}return!0}function T(a,b,c,d){k[a]=k[a]||{};k[a][b]=k[a][b]||{};k[a][b][c]=d}function W(a){if(a.adList)c("Caching passed ads for "+a.domain+" in "+a.region+a.slot),T(a.domain,a.region,a.slot,a.adList),oAdList=a.adList;else if(k[a.domain][a.region][a.slot])c("Using cached ads for "+
a.domain+" in "+a.region+a.slot),oAdList=k[a.domain][a.region][a.slot];else throw{name:"Warning",message:"No ads found in cache for "+a.domain+" in "+a.region+a.slot};for(iAd in oAdList)if("_popunder"!=a.region||"expandable"!=oAdList[iAd].type&&"flashexpandable"!=oAdList[iAd].type&&"pagecurl"!=oAdList[iAd].type&&"flashpagecurl"!=oAdList[iAd].type)if(TNCMS_Used_Ad[iAd])c("Removing ad #"+oAdList[iAd].adid+" because it is already being displayed."),delete oAdList[iAd];else{if("flash"==oAdList[iAd].type&&
(oAdList[iAd].flashVersion||(oAdList[iAd].flashVersion=11>oAdList[iAd].version?oAdList[iAd].version:13>oAdList[iAd].version?10+(parseInt(oAdList[iAd].version)-9)/10:24>oAdList[iAd].version?11+(parseInt(oAdList[iAd].version)-13)/10:13+(parseInt(oAdList[iAd].version)-24)/10,oAdList[iAd].flashVersion.toString().match(/\./i)||(oAdList[iAd].flashVersion+=".0")),!w.willPlay(oAdList[iAd].flashVersion))){var b=w.major?"Flash is not installed":"the installed Flash version is only "+w.major+"."+w.minor;if(oAdList[iAd].imageurl)c("Falling back to image from "+
oAdList[iAd].type+" for ad #"+oAdList[iAd].adid+" because Flash version "+oAdList[iAd].flashVersion+" is required but "+b+"."),oAdList[iAd].type="image",oAdList[iAd].file=oAdList[iAd].image,oAdList[iAd].file_modified=oAdList[iAd].image_modified,oAdList[iAd].uri=oAdList[iAd].imageuri,oAdList[iAd].asseturl=oAdList[iAd].imageurl,oAdList[iAd].height=oAdList[iAd].imageheight,oAdList[iAd].width=oAdList[iAd].imagewidth,b=oAdList[iAd].clickuri.split(","),oAdList[iAd].clickuri="",b[0]&&(oAdList[iAd].clickuri=
b[0]);else{c("Removing "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid+" because Flash version "+oAdList[iAd].flashVersion+" is required but "+b+".");delete oAdList[iAd];continue}}if(oAdList[iAd].uri||"image"!=oAdList[iAd].type&&"flash"!=oAdList[iAd].type&&"video"!=oAdList[iAd].type)if("flashexpandable"!=oAdList[iAd].type&&"flashpagecurl"!=oAdList[iAd].type||w.willPlay(7)){if("video"==oAdList[iAd].type){var g=!1;(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))g=!0})(navigator.userAgent||navigator.vendor||window.opera);switch(g){case !0:c("Mobile browser detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);switch(oAdList[iAd].asseturl.split(".").pop()){case "mp4":c("Mp4 file detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);break;case "flv":switch(w.willPlay(7)){case !0:c("Flash detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);break;case !1:c("Flash not found "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid),delete oAdList[iAd]}}break;
case !1:switch(c("Non-Mobile browser detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid),oAdList[iAd].asseturl.split(".").pop()){case "mp4":c("Mp4 file detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);break;case "flv":switch(w.willPlay(7)){case !0:c("Flash detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);break;case !1:c("Flash not found "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid),delete oAdList[iAd]}}}}if("html"!=oAdList[iAd].type||"https:"!=location.protocol||oAdList[iAd].secure)if(G[oAdList[iAd].type])if("dotconnect"==
oAdList[iAd].type&&16<TNCMS_DotConnect_Tile)c("Removing ad #"+oAdList[iAd].adid+" because it is a DotConnect ad and there are already 16 DoctConnect ads on this page."),delete oAdList[iAd];else{if(oAdList[iAd].keywords&&0<oAdList[iAd].keywords.length){for(b=bKeep=0;b<oAdList[iAd].keywords.length;b++){var d=RegExp(" "+oAdList[iAd].keywords[b].toLowerCase()+" ","");if(X.match(d)){bKeep=1;break}}if(!bKeep){c("Removing ad #"+oAdList[iAd].adid+" because it does not match any keywords on this page.");delete oAdList[iAd];
continue}}var b=new Date,d=new Date,y=new Date,p=oAdList[iAd].startdate.split("-");d.setFullYear(p[0],p[1]-1,p[2]);p=oAdList[iAd].enddate.split("-");y.setFullYear(p[0],p[1]-1,p[2]);if(d>b)c("Removing ad #"+oAdList[iAd].adid+" because it has not yet started."),delete oAdList[iAd];else if(y<b)c("Removing ad #"+oAdList[iAd].adid+" because it has already ended."),delete oAdList[iAd];else if(a.width&&oAdList[iAd].width&&oAdList[iAd].width>a.width)c("Removing ad #"+oAdList[iAd].adid+" because it is too wide for this region."),
delete oAdList[iAd];else if(m[a.domain].daily[iAd]&&oAdList[iAd].dailyLimit&&oAdList[iAd].dailyLimit<=m[a.domain].daily[iAd])c("Removing ad #"+oAdList[iAd].adid+" because it has already met its daily impression limit."),delete oAdList[iAd];else if(m[a.domain].total[iAd]&&oAdList[iAd].totalLimit&&oAdList[iAd].totalLimit<=m[a.domain].total[iAd])c("Removing ad #"+oAdList[iAd].adid+" because it has already met its total impression limit."),delete oAdList[iAd];else{if(oAdList[iAd].daypart_enabled&&""!=
oAdList[iAd].daypart_enabled){if(!oAdList[iAd].daypart_schedule){c("Removing ad #"+oAdList[iAd].adid+" because day parting is enabled but there is not schedule.");delete oAdList[iAd];continue}b=eval("("+oAdList[iAd].daypart_schedule+")");if(!b[D.day]){c("Removing ad #"+oAdList[iAd].adid+" because day parting is enabled and this day is not in the schedule.");delete oAdList[iAd];continue}if(!(b[D.day].allday||b[D.day][D.startBound]&&b[D.day][D.endBound])){c("Removing ad #"+oAdList[iAd].adid+" because day parting is enabled and it is not in the the start or end bound.");
delete oAdList[iAd];continue}}if(oAdList[iAd].frequency_limit&&(sValue=M("tncms_ad_"+iAd))&&(aData=sValue.split("&"),nAdCount=parseInt(aData[0],10),nAdCount>=oAdList[iAd].frequency_limit)){c("Removing ad #"+oAdList[iAd].adid+" because it has met its frequency limit.");delete oAdList[iAd];continue}oAdList[iAd].lat&&oAdList[iAd]["long"]&&oAdList[iAd].proximity&&H&&(b=Math.sin((H.lat*Math.PI/180-oAdList[iAd].lat)/2),d=Math.sin((H["long"]*Math.PI/180-oAdList[iAd]["long"])/2),b=Math.pow(b,2)+Math.pow(d,
2)*Math.cos(oAdList[iAd].lat)*Math.cos(H.lat*Math.PI/180),7974*Math.atan2(Math.sqrt(b),Math.sqrt(1-b))>oAdList[iAd].proximity&&(c("Removing ad #"+oAdList[iAd].adid+" because the reader was not detected within the configured porximity."),delete oAdList[iAd]))}}else c("Removing ad #"+oAdList[iAd].adid+" because it is of type ("+oAdList[iAd].type+") and there is no callback registerd for that."),delete oAdList[iAd];else c("Removing ad #"+oAdList[iAd].adid+" because is not a secure HTML ad."),delete oAdList[iAd]}else c("Removing "+
oAdList[iAd].type+" ad #"+oAdList[iAd].adid+" because there is no flash player to play it."),delete oAdList[iAd];else c("Removing "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid+" because it is missing the mandatory asset uri."),delete oAdList[iAd]}else c("Removing ad #"+oAdList[iAd].adid+" because "+oAdList[iAd].type+" ads are not allowed in a popunder."),delete oAdList[iAd];if(0==oAdList.length)throw{name:"Warning",message:"All ads have been eliminated from the ad list for this position ("+a.region+
a.slot+")."};oSectionAds=O(a.section,oAdList);sCurrentSection=oSectionAds.section;aAd=oSectionAds.ads;if("ros"==sCurrentSection&&f[a.domain].sectionExclusions)for(b=0;b<f[a.domain].sectionExclusions.length;b++)if(f[a.domain].sectionExclusions[b]==a.section||-1<window.location.href.indexOf("/"+f[a.domain].sectionExclusions[b]+"/"))throw{name:"Warning",message:"ROS ads are excluded from this section ("+a.section+") so no ads will be displayed for this position ("+a.region+a.slot+")."};if(!aAd||0==aAd.length)throw{name:"Warning",
message:"There are no ads available in this section ("+a.section+") for this position ("+a.region+a.slot+")."};for(var h=p=y=d=0,e=0,s=0,b=0;b<aAd.length;b++)aAd[b].weight=Y(aAd[b],sCurrentSection,a.domain),1==aAd[b].weight.locked?(y+=parseFloat(aAd[b].weight.percent),aAd[b].minRange=d,aAd[b].maxRange=d+1E4*parseFloat(aAd[b].weight.percent),c("Weight range for ad #"+aAd[b].adid+": "+aAd[b].minRange+" to "+aAd[b].maxRange),d=aAd[b].maxRange):2==aAd[b].weight.locked?p+=parseFloat(aAd[b].weight.percent):
(h+=parseFloat(aAd[b].weight.percent),e++);if(p+h>100-y)for(nMultiplier=(100-y)/100,b=0;b<aAd.length;b++)1!=aAd[b].weight.locked&&(aAd[b].minRange=d,aAd[b].maxRange=d+1E4*parseFloat(aAd[b].weight.percent)*nMultiplier,c("Weight range for ad #"+aAd[b].adid+": "+aAd[b].minRange+" to "+aAd[b].maxRange),d=aAd[b].maxRange);else if(p+h<=100-y)if(0==h)for(s=100-y-p,b=0;b<aAd.length;b++)1!=aAd[b].weight.locked&&(aAd[b].minRange=d,aAd[b].maxRange=d+1E4*parseFloat(aAd[b].weight.percent),c("Weight range for ad #"+
aAd[b].adid+": "+aAd[b].minRange+" to "+aAd[b].maxRange),d=aAd[b].maxRange);else for(nNewPercent=(100-y-p)/e,b=0;b<aAd.length;b++)1!=aAd[b].weight.locked&&(nPercent=1>aAd[b].weight.locked?nNewPercent:aAd[b].weight.percent,aAd[b].minRange=d,aAd[b].maxRange=d+1E4*parseFloat(nPercent),c("Weight range for ad #"+aAd[b].adid+": "+aAd[b].minRange+" to "+aAd[b].maxRange),d=aAd[b].maxRange);d+=s;d=Math.floor(Math.random()*d);for(b=0;b<aAd.length;b++)if(aAd[b].minRange<=d&&aAd[b].maxRange>d){c("Ad #"+aAd[b].adid+
"(type: "+aAd[b].type+") chosen from "+a.domain+" to display in "+a.region+a.slot);oAd=Object.create(aAd[b]);for(sFieldName in a)"finalRender"==sFieldName||oAd[sFieldName]||(oAd[sFieldName]=a[sFieldName]);oAd.originalSection=a.section;oAd.section=sCurrentSection;oAd.position=a.region+a.slot;oAd.cdn&&(oAd.asseturl=location.protocol+"//"+oAd.cdn+oAd.uri);"https:"==location.protocol&&(oAd.smallImage&&(oAd.smallImage=oAd.smallImage.replace(/^http:/i,"https:")),oAd.largeImage&&(oAd.largeImage=oAd.largeImage.replace(/^http:/i,
"https:")),oAd.smallFlash&&(oAd.smallFlash=oAd.smallFlash.replace(/^http:/i,"https:")),oAd.largeFlash&&(oAd.largeFlash=oAd.largeFlash.replace(/^http:/i,"https:")));oAd.window=window;r&1?((debugHeaderDiv=document.getElementById("blox-ad-position-debug-header-"+oAd.position))?oAd.positionDiv=document.getElementById("blox-ad-position-"+oAd.position):(debugDiv=document.getElementById("blox-ad-position-"+oAd.position),debugDiv.setAttribute("id","blox-ad-position-debug-"+oAd.position),debugHeaderDiv=document.createElement("div"),
debugHeaderDiv.style.border="1px solid black",debugHeaderDiv.style.width="100%",debugHeaderDiv.setAttribute("id","blox-ad-position-debug-header-"+oAd.position),debugDiv.appendChild(debugHeaderDiv),oAd.positionDiv=document.createElement("div"),oAd.positionDiv.setAttribute("id","blox-ad-position-"+oAd.position),debugDiv.appendChild(oAd.positionDiv)),debugHeaderDiv.innerHTML=" Ad Position: "+oAd.section+" : "+oAd.region+" : "+oAd.slot+" Ad ID: "+oAd.adid+" ("+oAd.type+":API 2)"):oAd.positionDiv=document.getElementById("blox-ad-position-"+
oAd.position);if(oAd.clickuri)if("flash"==oAd.type){b=oAd.clickuri.split(",");for(a=0;a<b.length;a++)b[a]=b[a].replace(/^\s*/,"").replace(/\s*$/,""),b[a]=b[a].match(/^https?:\/\//i)?b[a]:"http://"+b[a],b[a]=TNCMS.Tracking.getRedirectURL({domain:TNCMS.AdManager.isSecure?oAd.secureDomain:oAd.domain,app:"bannerad",metric:"clicks",id:oAd.section+"/"+oAd.position+"/"+oAd.uuid,url:unescape(b[a])});oAd.clickuri=b}else clickuri=oAd.clickuri.match(/^https?:\/\//i)?oAd.clickuri:"http://"+oAd.clickuri,oAd.clickuri=
TNCMS.Tracking.getRedirectURL({domain:TNCMS.AdManager.isSecure?oAd.secureDomain:oAd.domain,app:"bannerad",metric:"clicks",id:oAd.section+"/"+oAd.position+"/"+oAd.uuid,url:clickuri});else"html"==oAd.type&&oAd.html&&(trackerURL=location.protocol+TNCMS.Tracking.getRedirectURL({domain:TNCMS.AdManager.isSecure?oAd.secureDomain:oAd.domain,app:"bannerad",metric:"clicks",id:oAd.section+"/"+oAd.position+"/"+oAd.uuid,url:"TNCMS_AD_TRACKER"}),trackerURL=trackerURL.replace(/TNCMS_AD_TRACKER/,""),html=eval(oAd.html),
oAd.html=html.replace(/__TRACKER_URL__/g,trackerURL));"video"==oAd.type&&(oAd.rolltype="pre",oAd.autoplay=0,oAd.embed=0,oAd.volume=50,f[oAd.domain][oAd.region][oAd.slot]&&f[oAd.domain][oAd.region][oAd.slot][oAd.section]&&(a=f[oAd.domain][oAd.region][oAd.slot][oAd.section],oAd.rolltype=a.video_rolltype||oAd.rolltype,oAd.autoplay=a.video_autoplay?parseInt(a.video_autoplay,10):oAd.autoplay,oAd.embed=a.video_embed?parseInt(a.video_embed,10):oAd.embed,oAd.volume=a.video_volume?parseInt(a.video_volume,
10):oAd.volume));return oAd}throw{name:"Warning",message:"No ad was selected from the list"};}function Y(a,b,g){for(adSection in a.weights)if(adSection==b){if(!f[g].trafficSmoothing)return c("On "+g+" using default weights for ad#"+a.adid),a.weights[adSection];if(!v[g].estimate||!v[g].ratio)return s("No traffic data found for "+g+": using default weights for ad#"+a.adid),a.weights[adSection];iHour=(new Date).getHours();nTrafficEstimate=v[g].estimate[iHour]||0;nTrafficRatio=v[g].ratio[iHour]||0;if(a.dailyLimit&&
m[g].daily[a.adid]&&nTrafficRatio&&nTrafficEstimate){nWantedImpressions=(a.dailyLimit-m[g].daily[a.adid])*nTrafficRatio;if(nWantedImpressions>=nTrafficEstimate)return c("Wanted impressions for "+a.adid+" is greater than the current traffic estimate: using default weights for ad#"+a.adid),a.weights[adSection];nWeight=nWantedImpressions/nTrafficEstimate;c("Overriding default weight: using traffic curve for ad#"+a.adid);return{section:b,percent:100*nWeight,locked:2}}c("Using default weight in favor of traffic curve for ad#"+
a.adid);return a.weights[adSection]}s("No weight data found for ad#"+a.adid+" found: using 0");return 0}function O(a,b){oValidAds=[];for(nAdId in b)for(var g=b[nAdId].sections,d=0;d<g.length;d++)g[d]==a&&oValidAds.push(b[nAdId]);return 0<oValidAds.length||"ros"==a?(c("Returning ads for section: "+a),{section:a,ads:oValidAds}):(sMatch=a.match(/(\/[\w\-]+)$/g))?O(a.replace(sMatch,""),b):O("ros",b)}function M(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=
d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null}function q(a){var b=a.style?' style="'+a.style+'"':"";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){b='<embed type="application/x-shockwave-flash" src="'+a.src+'" width="'+a.width+'" height="'+a.height+'"'+b+' id="'+a.id+'" name="'+a.id+'" ';for(key in a.flashParams)b+=key+'="'+a.flashParams[key]+'" ';0<a.flashVars.length&&(b+='flashvars="'+a.flashVars.join("&")+'"');return b+"/>"}b=
'<object id="'+a.id+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+a.width+'" height="'+a.height+'" '+b+'><param name="movie" value="'+a.src+'" />';for(key in a.flashParams)b+='<param name="'+key+'" value="'+a.flashParams[key]+'" />';0<a.flashVars.length&&(b+='<param name="flashvars" value="'+a.flashVars.join("&")+'" />');return b+"</object>"}var u={},t={},e={},z=null,Q=null,Z="https:"==location.protocol?!0:!1,k={},R=[],r=location.search.match(/(\?|\&)adman_debug_mode=(\d+)/)?RegExp.$2:
0,A=!1,H=!1,n=!1,m={},v={},f={},w=function(){var a=[],b=!1;if(navigator.plugins&&navigator.mimeTypes.length)(b=navigator.plugins["Shockwave Flash"])&&b.description&&(a=b.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."));else{try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(c){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{b.AllowScriptAccess="always"}catch(d){a=[6,0,21],b=!1}}catch(f){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(p){}}b&&
(a=b.GetVariable("$version").split(" ")[1].split(","))}var h=a[0]?parseInt(a[0]):0,e=a[1]?parseInt(a[1]):0,k=a[2]?parseInt(a[2]):0;delete a;return{major:h,minor:e,rev:k,willPlay:function(a){if(0==h&&0==e&&0==k)return!1;aFlashFileVersion=a.toString().split(".");a=aFlashFileVersion[0]?parseInt(aFlashFileVersion[0]):0;var b=aFlashFileVersion[1]?parseInt(aFlashFileVersion[1]):0,c=aFlashFileVersion[2]?parseInt(aFlashFileVersion[2]):0;return h<a?!1:h>a?!0:e<b?!1:e>b?!0:k<c?!1:!0}}}(),G={dotconnect:function(a){if(1>
a.dc_sitename.length||""==a.dc_sitename){var b=window.location.hostname;-1<b.indexOf("www.")&&(b=b.replace("www.",""));var c=window.location.pathname.split("/"),d="frontpage";1<c.length&&-1==c[1].indexOf(".")&&(d=c[1]);var f="",f=a.dotconnect_sitename.length?a.dotconnect_sitename:b,e="";a.fold&&("above"==a.fold?e="atf":"below"==a.fold?e="btf":"span"==a.fold&&(e="stf"));window.googletag||(window.googletag={},null===document.getElementById("dotconnect-gpt-load")&&(b=document.createElement("script"),
b.id="dotconnect-gpt-load",b.async=!0,b.type="text/javascript",b.src=("https:"==document.location.protocol?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js",c=document.getElementsByTagName("head")[0],c.appendChild(b,c)));var h=window.googletag||{};h.cmd=h.cmd||[];h.cmd.push(function(){h.defineSlot("/132916964/"+f,[parseInt(a.width),parseInt(a.height)],a.positionDiv.id).addService(h.pubads()).setTargeting("pos",e);h.pubads().setTargeting("sec",d);h.enableServices();h.display(a.positionDiv.id)});
TNCMS_DotConnect_Tile++}else b=location.protocol+"//ad.doubleclick.net/N6443/adi/"+a.dc_sitename+"/;",b+=1==TNCMS_DotConnect_Tile?"dcopt=ist;":"",a.fold&&("above"==a.fold?b+="pos=atf;":"below"==a.fold?b+="pos=btf;":"span"==a.fold&&(b+="pos=stf;")),b+=a.dc_campaign_id?"c="+a.dc_campaign_id+";":"",b+=a.dc_campaign_id&&"1"!=a.dc_allow_rem?"":"r=1;",b+="tile="+TNCMS_DotConnect_Tile++ +";sz="+a.dc_size+";ord="+Math.floor(1E13*Math.random())+";?",a.positionDiv.innerHTML='<iframe src="'+b+'" width="'+a.width+
'" height="'+a.height+'" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="no"></iframe>'},expandable:function(a){var b='<img src="'+a.smallImage+'" alt="'+(a.title?a.title:"*")+'" border="0" id="expandable_'+a.adid+'" onmouseover="document.getElementById(\'expandable_'+a.adid+"').src = '"+a.largeImage+"'\" onmouseout=\"document.getElementById('expandable_"+a.adid+"').src = '"+a.smallImage+"'\"/>";a.clickuri&&(b='<a rel="nofollow" href="http:'+a.clickuri+'" target="'+
(a.target?a.target:"_blank")+'">'+b+"</a>");a.positionDiv.innerHTML=b},flash:function(a){oFlashConfig={id:"blox-flash-ad-"+a.adid,src:a.asseturl,width:a.width,height:a.height,flashParams:{bgcolor:"#000",quality:"high",wmode:a.transparent?"transparent":"opaque"},flashVars:[]};if(0<a.clickuri.length)for(var b=0;b<a.clickuri.length;b++)sCount=0==b?"":b+1,oFlashConfig.flashVars.push("clickTAG"+sCount+"=http:"+escape(a.clickuri[b]));a.positionDiv.innerHTML=q(oFlashConfig)},flashexpandable:function(a){window.TNCMS_FlashExpandable||
(window.TNCMS_FlashExpandable={autohidetimer:10,timerrunning:!1,timerlen:5,slideAniLen:400});window.slidedown||(window.slidedown=function(a){TNCMS_FlashExpandable.moving||"none"!=document.getElementById("expanded1container").style.display||(TNCMS_FlashExpandable.moving=!0,TNCMS_FlashExpandable.dir="down",startslide(a))});window.slideup||(window.slideup=function(a){TNCMS_FlashExpandable.moving||"none"==document.getElementById("expanded1container").style.display||(TNCMS_FlashExpandable.moving=!0,TNCMS_FlashExpandable.dir=
"up",startslide(a))});window.startslide||(window.startslide=function(a){TNCMS_FlashExpandable.obj=document.getElementById("expanded1container");TNCMS_FlashExpandable.endHeight=parseInt(TNCMS_FlashExpandable.obj.style.height);TNCMS_FlashExpandable.startTime=(new Date).getTime();"down"==TNCMS_FlashExpandable.dir&&(TNCMS_FlashExpandable.obj.style.height="1px");TNCMS_FlashExpandable.obj.style.display="block";TNCMS_FlashExpandable.timerID=setInterval("slidetick('"+a+"');",TNCMS_FlashExpandable.timerlen)});
window.slidetick||(window.slidetick=function(a){var c=(new Date).getTime()-TNCMS_FlashExpandable.startTime;c>TNCMS_FlashExpandable.slideAniLen?endSlide(a):(a=Math.round(c/TNCMS_FlashExpandable.slideAniLen*TNCMS_FlashExpandable.endHeight),"up"==TNCMS_FlashExpandable.dir&&(a=TNCMS_FlashExpandable.endHeight-a),TNCMS_FlashExpandable.obj.style.height=a+"px")});window.endSlide||(window.endSlide=function(a){clearInterval(TNCMS_FlashExpandable.timerID);"up"==TNCMS_FlashExpandable.dir&&(TNCMS_FlashExpandable.obj.style.display=
"none");TNCMS_FlashExpandable.obj.style.height=TNCMS_FlashExpandable.endHeight+"px";delete TNCMS_FlashExpandable.moving;delete TNCMS_FlashExpandable.timerID;delete TNCMS_FlashExpandable.startTime;delete TNCMS_FlashExpandable.endHeight;delete TNCMS_FlashExpandable.obj;delete TNCMS_FlashExpandable.dir});window.expand||(window.expand=function(a){"none"==document.getElementById("expanded1container").style.display&&(slidedown(a),collapsedstoptimer(a))});window.collapse||(window.collapse=function(a){"block"==
document.getElementById("expanded1container").style.display&&(slideup(a),collapsedstoptimer(a))});window.toggleSlide||(window.toggleSlide=function(a){"none"==document.getElementById("expanded1container").style.display?slidedown(a):(slideup(a),collapsedstoptimer(a))});window.collapsedstoptimer||(window.collapsedstoptimer=function(a){TNCMS_FlashExpandable.timerrunning&&clearTimeout(TNCMS_FlashExpandable.timer)});window.collapsedinit||(window.collapsedinit=function(a){toggleSlide(a);0<TNCMS_FlashExpandable.autohidetimer&&
(TNCMS_FlashExpandable.timer=setTimeout("toggleSlide('"+a+"')",1E3*TNCMS_FlashExpandable.autohidetimer));TNCMS_FlashExpandable.timerrunning=!0});sHTML='<div id="adholder" style="position:relative;z-index:1;">';sHTML+='  <div id="collapsed1container" style="position:relative;width:'+a.width+"px;height:"+a.height+'px;z-index:1;">';sHTML+=q({id:"collapsed1SmallObject",src:a.smallFlash,width:a.width,height:a.height,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high",swliveconnect:"true"},
flashVars:["small=&ad_url=http:"+escape(a.clickuri)]});sHTML+="  </div>";sHTML+='  <div id="expanded1container" style="position:relative;display:none;width:'+a.largewidth+"px;height:"+a.largeheight+'px;overflow:hidden;z-index:1;">';sHTML+=q({id:"expanded1SmallObject",src:a.largeFlash,width:a.largewidth,height:a.largeheight,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high",swliveconnect:"true"},flashVars:["big=&ad_url=http:"+escape(a.clickuri)]});sHTML+="  </div>";sHTML+="</div>";
sHTML+='<script type="text/javascript">collapsedinit('+a.adid+");\x3c/script>";a.positionDiv.innerHTML=sHTML},flashpagecurl:function(a){window.sizeup987||(window.sizeup987=function(){document.getElementById("bigCorner").style.top="0px";document.getElementById("smallCorner").style.top="-1000px"});window.sizedown987||(window.sizedown987=function(){document.getElementById("smallCorner").style.top="0px";document.getElementById("bigCorner").style.top="-1000px"});sSmallSize=100>=a.width?100:250;sLargeSize=
650>=a.largewidth?650:800;domain="";document.domain!=a.domain&&document.domain!=a.secureDomain&&(domain=location.protocol+"//"+("https:"==location.protocol?a.secureDomain:a.domain));sHTML='<div id="smallCorner" style="position:absolute; width:'+sSmallSize+"px; height:"+sSmallSize+'px; z-index:999999; right:0px; top:0px;">';sHTML+=q({id:"smallCornerObject",src:domain+"/shared-content/tncms-ad-manager/pagecurl_small.swf?ico="+escape(a.smallFlash),width:sSmallSize,height:sSmallSize,flashParams:{allowScriptAccess:"always",
wmode:"transparent",quality:"high"},flashVars:["ico="+escape(a.smallFlash)]});sHTML+="</div>";sHTML+='<div id="bigCorner" style="position:absolute; width:'+sLargeSize+"px; height:"+sLargeSize+'px; z-index:9999; right:0px; top:0px;">';sHTML+=q({id:"bigCornerObject",src:domain+"/shared-content/tncms-ad-manager/pagecurl_large.swf?big="+escape(a.largeFlash)+"&ad_url=http:"+escape(a.clickuri),width:sLargeSize,height:sLargeSize,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high"},
flashVars:["big="+escape(a.largeFlash)+"&ad_url=http:"+escape(a.clickuri)]});sHTML+="</div>";setTimeout('document.getElementById("bigCorner").style.top = "-1000px";',1E3);a.positionDiv.innerHTML=sHTML},html:function(a){if(null!=a.height&&""!=a.height){document.getElementById("blox-ad-frame-"+a.adid+"-"+a.position)&&(c("Ad #"+a.adid+": already exists at slot "+a.position+" : Removing ad for refresh opportunity."),a.positionDiv.removeChild(document.getElementById("blox-ad-frame-"+a.adid+"-"+a.position)));
var b=document.createElement("iframe");b.setAttribute("id","blox-ad-frame-"+a.adid+"-"+a.position);b.setAttribute("width",a.width);b.setAttribute("height",a.height);b.setAttribute("marginwidth",0);b.setAttribute("marginheight",0);b.setAttribute("hspace",0);b.setAttribute("vspace",0);b.setAttribute("frameborder",0);b.setAttribute("scrolling","no");var g="<script type='text/javascript'>var inDapIF = true;\x3c/script>"+a.html,g=g.replace(/'/g,"\\'");b.src="javascript:'"+g+"'";a.positionDiv.appendChild(b)}else for(a.positionDiv.innerHTML=
a.html,aChildNode=a.positionDiv.childNodes,b=0;aChildNode[b];b++)if(aChildNode[b].nodeName&&"script"===aChildNode[b].nodeName.toLowerCase()&&(!aChildNode[b].type||"text/javascript"===aChildNode[b].type.toLowerCase())){oNode=aChildNode[b].parentNode?aChildNode[b].parentNode.removeChild(aChildNode[b]):aChildNode[b];if(oNode.src)c("Ad #"+a.adid+": Loading script: "+oNode.src+" on "+a.position),$.loadScript(oNode.src,"blox-ad-position-"+a.position);else{c("Ad #"+a.adid+": Running inline script: on "+
a.position);sData=oNode.text||oNode.textContent||oNode.innerHTML||"";var g=document.getElementsByTagName("head")[0]||document.documentElement,d=document.createElement("script");d.type="text/javascript";d.appendChild(document.createTextNode(sData));oldDocumentWrite=document.write;document.write=function(b){a.positionDiv.innerHTML+=b};g.insertBefore(d,g.firstChild);g.removeChild(d);document.write=oldDocumentWrite}oNode.parentNode&&oNode.parentNode.removeChild(oNode)}},image:function(a){alt=a.title?
a.title:"*";sHeight=a.height?' height="'+a.height+'"':"";sWidth=a.width?' width="'+a.width+'"':"";sOnClick="";a.clickuri&&(sTarget=a.target?a.target:"_blank",sOnClick=" onclick=\"window.open('http:"+a.clickuri+"','"+sTarget+'\');" style="cursor: pointer;"');a.positionDiv.innerHTML='<img src="'+a.asseturl+'" alt="'+alt+'" border="0"'+sHeight+sWidth+sOnClick+"/>"},pagecurl:function(a){window.sizeup987||(window.sizeup987=function(){document.getElementById("bigCorner").style.top="0px";document.getElementById("smallCorner").style.top=
"-1000px"});window.sizedown987||(window.sizedown987=function(){document.getElementById("smallCorner").style.top="0px";document.getElementById("bigCorner").style.top="-1000px"});document.domain==a.domain||document.domain==a.secureDomain?path="/shared-content/tncms-ad-manager/":(domain="https:"==location.protocol?a.secureDomain:a.domain,path=location.protocol+"//"+domain+"/shared-content/tncms-ad-manager/");sSmallSize="100";sBigSize="650";sHTML='<div id="smallCorner" style="position:absolute; width:'+
sSmallSize+"px; height:"+sSmallSize+'px; z-index:9999; right:0px; top:0px;">';sHTML+=q({id:"smallCornerObject",src:path+"pagecurl_small.swf?ico="+escape(a.smallImage),width:sSmallSize,height:sSmallSize,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high",swliveconnect:"true"},flashVars:["ico="+escape(a.smallImage)]});sHTML+="</div>";sHTML+='<div id="bigCorner" style="position:absolute; width:'+sBigSize+"px; height:"+sBigSize+'px; z-index:9999; right:0px; top:0px;">';sHTML+=q({id:"bigCornerObject",
src:path+"pagecurl_large.swf?big="+escape(a.largeImage)+"&ad_url=http:"+escape(a.clickuri),width:sBigSize,height:sBigSize,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high",swliveconnect:"true"},flashVars:["big="+escape(a.largeImage)+"&ad_url=http:"+escape(a.clickuri)]});sHTML+="</div>";setTimeout("document.getElementById('bigCorner').style.top = '-1000px';",1E3);a.positionDiv.innerHTML=sHTML},text:function(a){sTarget=a.target?a.target:"_blank";a.positionDiv.innerHTML='<a rel="nofollow" href="http:'+
a.clickuri+'" target="'+sTarget+'">'+a.title+"</a><br />"+a.text},video:function(a){oFlashConfig={id:"blox-flash-ad-"+a.adid,src:"/shared-content/art/tncms-ad-manager/flowplayer/FlowPlayer.swf",width:a.width,height:a.height,flashParams:{wmode:"transparent",allowfullscreen:!0,allowscriptaccess:"always",quality:"high",bgcolor:"#ffffff"},flashVars:["config={&quot;autoPlay&quot;:"+(1==a.autoplay?"true":"false")+",&quot;initialVolumePercentage&quot;:"+a.volume+",&quot;autoBuffering&quot;:false,&quot;loop&quot;:false,&quot;playList&quot;:[{&quot;url&quot;:&quot;"+
a.asseturl+"&quot;,&quot;type&quot;:&quot;flv&quot;,&quot;linkUrl&quot;:&quot;"+escape(a.clickuri)+"&quot;}]}"]};document.domain!=a.domain&&document.domain!=a.secureDomain&&(domain="https:"==location.protocol?a.secureDomain:a.domain,oFlashConfig.src=location.protocol+"//"+domain+oFlashConfig.src);a.positionDiv.innerHTML=q(oFlashConfig)}},B={popunder:function(a){if("expandable"==a.type||"flashexpandable"==a.type||"pagecurl"==a.type||"flashpagecurl"==a.type)throw Error("Ad type "+a.type+"is not allowed in a popunder.");
iWidth=a.width?parseInt(a.width,10)+30:300;iHeight=a.height?parseInt(a.height,10)+100:300;iLeft=(screen.width-iWidth)/2;iTop=(screen.height-iHeight)/2;a.window=window.open("","tncms_adman_popunder","top="+iTop+", left="+iLeft+",width="+iWidth+",height="+iHeight+",scrollbars=0,resizable=0,toolbar=0,location=0,menubar=0,status=0,directories=0");a.positionDiv=a.window.document.body;a.positionDiv.setAttribute("id","blox-ad-position-"+a.position);a.positionDiv.innerHTML="";a.window.blur();window.focus();
a.window.document.title=a.title;a.window.resizeTo(iWidth,iHeight);a.window.moveTo(iLeft,iTop);F(a)},popup:function(a){function b(){document.getElementsByTagName("body")[0].removeChild(document.getElementById("blox-ad-position-_popup1"));document.getElementsByTagName("body")[0].removeChild(document.getElementById("BlackOutDiv"))}var c=document.createElement("div");c.setAttribute("id","BlackOutDiv");c.style.position="fixed";c.style.top=0;c.style.left=0;c.style.width="100%";c.style.height="100%";c.style.zIndex=
99999;c.style.backgroundColor="black";c.style.opacity=0.9;c.style.filter="alpha(opacity=90)";if("number"==typeof window.innerWidth)iWinWidth=window.innerWidth,iWinHeight=window.innerHeight;else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))iWinWidth=document.documentElement.clientWidth,iWinHeight=document.documentElement.clientHeight;else if(document.body&&(document.body.clientWidth||document.body.clientHeight))iWinWidth=document.body.clientWidth,
iWinHeight=document.body.clientHeight;else throw Error("No valid hight or width for the current window could be found");iWidth=a.width||400;iHeight=a.height||400;iAdLeft=parseInt((iWinWidth-iWidth)/2);iAdLeft=0<iAdLeft?iAdLeft:0;iAdTop=parseInt((iWinHeight-iHeight)/2);iAdTop=0<iAdTop?iAdTop:0;var d=document.createElement("div");d.style.position="absolute";d.style.top=iAdTop+"px";d.style.left=iAdLeft+"px";d.style.zIndex=parseInt(c.style.zIndex)+1;d.setAttribute("id","blox-ad-position-_popup1");"undefined"!=
typeof c.addEventListener?c.addEventListener("click",b,!1):("BackCompat"==document.compatMode&&(c.style.width="110%",c.style.height="110%",c.style.position="absolute"),c.attachEvent("onclick",b));document.getElementsByTagName("body")[0].appendChild(c);document.getElementsByTagName("body")[0].appendChild(d);a.positionDiv=document.getElementById("blox-ad-position-_popup1");F(a)}};0<r&&("undefined"==typeof console?alert("Please turn on the debugging console!"):(c("Debug level set to: "+r),A=!0));window.XMLHttpRequest?
oReq=new XMLHttpRequest:window.ActiveXObject&&(oReq=new ActiveXObject("MSXML2.XMLHTTP.3.0"));if(oReq){oReq.onreadystatechange=function(){if(4==oReq.readyState&&200==oReq.status){var a=eval("("+oReq.responseText+")");""!==a.lat&&""!==a["long"]&&(H={lat:a.lat,"long":a["long"]})}};try{oReq.open("GET","/_services/v1/client_ip_info/",!1),oReq.send()}catch(ba){}}oCurrent=(aTime=location.search.match(/(\?|\&)adman_debug_time=(\d\d)\/(\d\d)\/(\d\d\d\d)_(\d\d)-(\d\d)/))?new Date(aTime[4],aTime[2]-1,aTime[3],
aTime[5],aTime[6]):new Date;sBound=4*oCurrent.getHours()+Math.floor(oCurrent.getMinutes()/15);var D={day:oCurrent.getDay(),startBound:sBound,endBound:sBound+1};delete aTime;delete oCurrent;delete sBound;aTag=document.getElementsByTagName("meta");oKeyword={};aKeyword=[];for(var N=0;N<aTag.length;N++)if("keywords"==aTag[N].name.toLowerCase()){aTemp=aTag[N].content.split(",");for(var P=0;P<aTemp.length;P++)(sTemp=aTemp[P].replace(/^\s+|\s+$/g,""))&&(oKeyword[" "+sTemp+" "]=1)}for(var aa in oKeyword)aKeyword.push(aa);
var X=aKeyword.join(",").toLowerCase();delete aTag;delete oKeyword;delete aKeyword;docPath=document.location.href.replace(/\?.*/,"").replace(/#\w+/,"");sPath="";docPath.match(/^((http|ftp|https):\/)?\/?([^:\/\s]+)((\/[\w\-\.]+)*\/)([\w\-\.]+\.[^#?\s]+)(#[\w\-]+)?$/)?sPath=RegExp.$4:docPath.match(/^((http|ftp|https):\/)?\/?([^:\/\s]+)((\/[\w\-\.]+)*\/)?$/)&&(sPath=RegExp.$4);var V="/"==sPath?"frontpage":sPath.replace(/^\//,"").replace(/\/$/,"");delete docPath;delete sPath;for(regionType in B)"function"==
typeof window["tncms_virtual_region_"+regionType]&&(B[regionType]=window["tncms_virtual_region_"+regionType]);var $=function(){function a(){r.length?e(r.shift()):0===u&&(c("jsLoader: Auto-releasing"),C.release())}function b(c){var d=t[c.domId];if(d&&d.length)if(d=d.shift(),0===d.toLowerCase().indexOf("<script")){var l=document.createElement("div");l.innerHTML="dummy<div>"+d+"</div>";l=l.children[0].children[0];d=l.getAttribute("language")||"javascript";if(l.src)c.src=l.src,c.charset=l.charset,c.language=
d,c.type=l.type,e(c);else{if(l=l.text?l.text.replace(/^\s*|\s*$/gi,""):l.text)f(c,l,d),B(l,d);g(c)}}else{l=v[c.domId]||(v[c.domId]=document.getElementById(c.domId));if(!l)throw Error('jsLoader: Unable to inject html. Element with id "'+c.domId+'" does not exist');if(d=d?d.replace(/^\s*|\s*$/gi,""):d)l.innerHTML+=d;b(c)}else{for(;0<q.length;)if(c=q.pop(),d=c.id,l=C.originalGetElementById.call?C.originalGetElementById.call(document,d):C.originalGetElementById(d)){var h=l.parentNode;l.id=d+"__tmp";h.insertBefore(c,
l);h.removeChild(l)}a()}}function g(a){var c=a.domId,d;d=n.join("").replace(/<noscript>[\s\S]*?<\/noscript>/ig,"");n=[];var g=z,e,f=0,h,k=[];if(A)h=d.split(g);else{for(h=[];e=g.exec(d);)e.index>f&&k.push(d.slice(f,e.index)),1<e.length&&e.index<d.length&&Array.prototype.push.apply(h,e.slice(1)),f=g.lastIndex;f<d.length&&h.push(d.slice(f))}d=0;for(g=h.length;d<g;d+=1)""!==h[d]&&k.push(h[d]);t[c]?Array.prototype.unshift.apply(t[c],k):t[c]=k;b(a)}function d(a){function b(a,c){var d=c.children,e,g,f;if(d&&
d.length)for(e=0,g=d.length;e<g;e++)if(f=d[e],f.id&&f.id===a||f.children&&f.children.length&&(f=b(a,f)))return f}function c(a){var b,d,e;b=0;for(d=q.length;b<d;b++)if(e=q[b],e.id===a)return e}var d=C.originalGetElementById.call?C.originalGetElementById.call(document,a):C.originalGetElementById(a),g,e;if(d||q.length&&(d=c(a)))return d;if(n.length)return d=n.join(""),g=document.createDocumentFragment(),e=document.createElement("div"),e.innerHTML=d,g.appendChild(e),(d=b(a,e))&&q.push(d),d}function e(a){u++;
var b=document.createElement("script");a.type&&(b.type=a.type);a.charset&&(b.charset=a.charset);a.language&&(b.language=a.language);f(a);var d=!1;b.onload=b.onreadystatechange=function(){u--;b.loaded=!0;d||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(d=!0,b.onload=b.onreadystatechange=null,c("jsLoader: #"+a.domId+": onload "+a.src),g(a))};b.loaded=!1;b.src=a.src;w.insertBefore(b,w.firstChild);setTimeout(function(){if(!b.loaded)throw Error("jsLoader: SCRIPT NOT LOADED: "+
b.src);},3E3)}function f(a,b,d){c("jsLoader: #"+a.domId+(b?": Inline "+d+": "+b.replace("\n"," ").substr(0,30)+"...":": Inject "+a.src))}function h(a){n.push(a);c("jsLoader: write: "+a)}function k(){return document}function s(){}var m=!1,r=[],n=[],t={},u=0,v={},q=[],z=/(<script[\s\S]*?<\/script>)/gim,C=null,w=document.getElementsByTagName("head")[0]||document.documentElement,A="b"==="abc".split(/(b)/)[1],B=function(){return window.execScript?function(a,b){window.execScript(a,b||"JavaScript")}:function(a,
b){b&&!/^javascript/i.test(b)||window.eval.call(window,a)}}();return C={activate:function(){m||(document.write=document.writeln=h,document.open=k,document.close=s,document.getElementById=d,m=!0)},release:function(){m&&(document.write=this.originalWrite,document.writeln=this.originalWriteLn,document.open=this.originalOpen,document.close=this.originalClose,document.getElementById=this.originalGetElementById,v={},m=!1)},loadScript:function(b,d){if("string"!==typeof d)throw Error("jsLoader: No valid DOM ID found for "+
b);m||(c("jsLoader: Auto-activating"),this.activate());r.push({src:b,domId:d});setTimeout(function(){0===u&&a()},1)},originalGetElementById:document.getElementById,originalWrite:document.write,originalWriteLn:document.writeln,originalOpen:document.open,originalClose:document.close}}();return{info:c,warn:s,error:S,init:I,setImpressions:function(a,b){m[a]=b},setTraffic:function(a,b){v[a]=b},setSettings:function(a,b){f[a]=b;f[a].trafficSmoothing&&c("Traffic smoothing active on "+a)},setAds:T,render:function(a){a=
a||{};I(a);a.domain=a.domain||z;a.secureDomain=a.secureDomain||Q;if(!a.region||!a.slot)return s("No valid position"),s(a),!1;aRegionType=a.region.match(/^\_(.*)$/);a.regionType=aRegionType&&aRegionType[1]?aRegionType[1]:"inline";if(!document.getElementById("blox-ad-position-"+a.region+a.slot)&&"inline"==a.regionType){if(TNCMS_PAGE_LOADED)return s("The div for position ("+a.region+a.slot+") does not exist!"),!1;document.write('\n<div id="blox-ad-position-'+a.region+a.slot+'"></div>\n')}return K(a)},
renderAd:F,refresh:L,isSecure:Z}}());
