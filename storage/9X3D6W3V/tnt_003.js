!function(t,e){t.poll_config.forEach(function(t){function r(r,n){var s=e.getElementById("poll-"+t.id);("false"==s.getAttribute("data-charted")||1==n)&&fetch(t.results).then(function(r){return 200!==r.status?void console.log("Poll "+t.asset_id+" Status Code: "+r.status):void r.json().then(function(r){var l;l="pie"==t.chart?o(r.results):i(r.results),e.getElementById("poll-"+t.id+"-results").innerHTML=l,s.setAttribute("data-charted","true")})})["catch"](function(e){console.log("Fetch Error "+t.asset_id+": ",e)}),l(r)}function l(r){e.getElementById("poll-"+t.id+"-container").classList.add("hide"),e.getElementById("poll-"+t.id+"-results").classList.remove("hide"),r&&e.getElementById("poll-"+t.id+"-back-vote").classList.remove("hide")}function n(t){var e=0;for(var r in t)if(t.hasOwnProperty(r)){var l=t[r],n=l.votes;0===n&&l.text===s&&(n=1),e+=n}return e}function o(e){var r=n(e),l=0,o="100,0",i='<div class="tnt-chart-ledger">',a='<div class="tnt-chart"><svg class="tnt-chart-pie" viewBox="-100 -100 200 200" aria-labelledby="'+t.title+'"><g transform="rotate(-90)">';for(var d in e)if(e.hasOwnProperty(d)){var c=e[d],v=c.votes;0===v&&c.text===s&&(v=1);var u=(v/r*100).toFixed(1);if(0!=v){l>=r&&(o="100,0"),l+=v;var f=2*Math.PI*l/r,g=100*Math.cos(f),p=100*Math.sin(f),h=2>=r/v?1:0;a+='<path d="M0,0 L'+o+" A100,100 0 "+h+",1 "+g+","+p+' Z" fill="'+c.color+'" />',i+='<div class="tnt-ledger-item"><span style="color:'+c.color+'"><span class="fas tnt-circle"></span></span> <strong>'+u+"%</strong> "+c.text+"</div>",o=g+","+p}}return 0>=l?'<div class="alert alert-warning">No votes have been submitted.</div>':a=a+"</g></svg>"+i+"</div></div>"}function i(e){var r=n(e),l=0,o=0,i=19,a="";for(var d in e)if(e.hasOwnProperty(d)){var c=e[d],v=c.votes;if(0===v&&c.text===s&&(v=1),0!=v){var u=v/r*100,f=u/2;a+='<g class="bar"><rect width="'+f+'%" height="'+i+'" y="'+o+'" style="fill: '+c.color+'"></rect><text x="'+(f+1)+'%" y="'+(i/2+o)+'" dy=".35em">'+v+" "+c.text+"</text></g>",l+=v,o+=i+1}}return 0>=l?'<div class="alert alert-warning">No votes have been submitted.</div>':a='<svg class="tnt-chart-bar" style="height:'+o+'px" aria-labelledby="'+t.title+'" role="img">'+a+"</svg>"}var s=sessionStorage.getItem("poll_"+t.asset_id);s&&(e.getElementById("poll-"+t.id+"-your-vote").innerHTML=s,e.getElementById("poll-"+t.id+"-your-vote-container").classList.remove("hide"),r()),e.getElementById("poll-"+t.id+"-form").addEventListener("submit",function(l){l.preventDefault();var n=e.querySelector("#poll-"+t.id+"-form input[name=answer]:checked").value;if(!n)return!1;var o=e.querySelector("#poll-"+t.id+"-form input[name=answer]:checked").getAttribute("title");if("function"==typeof dmpAction){var i="Poll : "+t.title+" : "+o;dmpAction(i)}return $.ajax({type:"POST",url:t.url,data:"format=json&action=poll:vote&answer="+n,success:function(){try{sessionStorage.setItem("poll_"+t.asset_id,o)}catch(l){}s=o,r(!1,!0),e.getElementById("poll-"+t.id+"-your-vote").innerHTML=s,e.getElementById("poll-"+t.id+"-your-vote-container").classList.remove("hide")},error:function(){console.log("A poll error occurred.")}}),!1}),e.getElementById("poll-"+t.id+"-get-results").addEventListener("click",function(t){return t.preventDefault(),r(!0),!1}),e.getElementById("poll-"+t.id+"-back-btn").addEventListener("click",function(r){r.preventDefault(),e.getElementById("poll-"+t.id+"-back-vote").classList.add("hide"),e.getElementById("poll-"+t.id+"-results").classList.add("hide"),e.getElementById("poll-"+t.id+"-container").classList.remove("hide")})})}(window,document);
//# sourceMappingURL=tnt.poll.90be57f4daa5c8d742e55dc6718fd422.js.map