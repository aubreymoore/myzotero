"use strict";function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?e[Symbol.hasInstance](t):t instanceof e}function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var mmwrMetrics=function(){function n(t,e){_classCallCheck(this,n);var a=document.createElement("a");a.href=location.href;var i="https://www.cdc.gov/SocialMedia/JournalMetrics/"+a.pathname.split(".")[0]+".json";switch(t){case"article":this.loadArticle(e,i);break;case"tabs":this.loadTabs("full",e);break;case"mini-tabs":this.loadTabs("mini",e);break;case"scopus":this.loadScopus(e,i);break;default:console.log("The MMWR Bibliometric style specified is invalid. Valid options are 'tabs', 'mini-tabs', 'article' or 'scopus'. No widget was loaded.")}}return _createClass(n,[{key:"loadTabs",value:function(t,e){var a="div[data-widget-num=".concat(e,"]"),i="Past 3 months",n=10,s='<div id="accordionTabs">\n\n      \t  <div id="tabContent" class="tabs-module">\n      \t    <ul class="nav nav-tabs" role="tablist">\n      \t        <li class="nav-item">\n      \t          <a class="nav-link active" data-toggle="tab" href="#most-viewed" role="tab">Most Viewed</a>\n      \t        </li>\n      \t        <li class="nav-item">\n      \t          <a class="nav-link" data-toggle="tab" href="#most-cited" role="tab">Most Cited</a>\n      \t        </li>\n      \t        <li class="nav-item">\n      \t          <a class="nav-link" data-toggle="tab" href="#most-attention" role="tab">Most Attention</a>\n      \t        </li>\n      \t    </ul>\n\n      \t    \x3c!-- Tab panes --\x3e\n      \t    <div class="tab-content">\n      \t      <div class="tab-pane active" id="most-viewed" role="tabpanel">\n      \t        <h4>Top 10 Most Viewed</h4>\n      \t        <p>Views are the number of times an MMWR article has been viewed over a certain time period. This metric is the sum of "page views" which are web page views, and "PDF downloads" which are views of the PDF version.</p>\n      \t        <div class="timePeriod">\n      \t\t\t\t\t\t<h6 class="open d-inline">Time Period Published</h6>\n      \t\t\t\t\t\t<div class="pl-2 align-middle btn-group btn-group-toggle" data-toggle="buttons">\n                    <label class="btn btn-sm btn-secondary viewed_last_30 active">\n                      <input type="radio" name="options"autocomplete="off" checked> '.concat(i,'\n                    </label>\n                    <label class="btn btn-sm btn-secondary viewed_last_year">\n                      <input type="radio" name="options" autocomplete="off"> Past Year\n                    </label>\n                  </div>\n      \t\t\t\t\t</div>\n      \t\t\t\t\t<div class="border-top my-3"></div>\n      \t\t\t\t\t<div id="viewedLast30">\n      \t            <h5>Most viewed reports published in the past 3 months</h5>\n      \t\t\t\t\t</div>\n      \t        <div id="viewedLastYear" class="d-none">\n      \t            <h5>Past Year</h5>\n      \t\t\t\t\t</div>\n      \t      </div>\n      \t      <div class="tab-pane" id="most-cited" role="tabpanel">\n      \t        <h4>Top 10 Most Cited</h4>\n      \t        <div>\n      \t            <b>Top citations of reports published since January 2016</b>\n      \t\t\t\t\t\t\t<div class="border-top mt-2 mb-3"></div>\n      \t            <div id="viewedMostCited"></div>\n      \t        </div>\n      \t      </div>\n      \t      <div class="tab-pane" id="most-attention" role="tabpanel">\n      \t        <h4>Top 10 Altmetric Attention Score</h4>\n      \t        <p>The Altmetric attention score measures attention from social media sites, blogs and other sources captured by Altmetric, a system that tracks attention an article receives.</p>\n      \t        <div>\n      \t            <b>Time Period</b>: Past 3 months\n      \t\t\t\t\t\t\t<div class="border-top mt-2 mb-3"></div>\n      \t            <div id="viewedMostAltmetric"></div>\n      \t        </div>\n      \t      </div>\n      \t    </div>\n\n      \t  </div>\n\n      \t</div>'),o='<div id="accordionTabs">\n\n      \t  <div id="tabContent" class="tabs-module">\n      \t    <ul class="nav nav-tabs small" role="tablist">\n      \t        <li class="nav-item">\n      \t          <a class="nav-link active" data-toggle="tab" href="#most-viewed" role="tab">Most Viewed</a>\n      \t        </li>\n      \t        <li class="nav-item">\n      \t          <a class="nav-link" data-toggle="tab" href="#most-cited" role="tab">Most Cited</a>\n      \t        </li>\n      \t        <li class="nav-item">\n      \t          <a class="nav-link" data-toggle="tab" href="#most-attention" role="tab">Most Attention</a>\n      \t        </li>\n      \t    </ul>\n\n      \t    \x3c!-- Tab panes --\x3e\n      \t    <div class="tab-content">\n      \t      <div class="tab-pane active" id="most-viewed" role="tabpanel">\n      \t        <div id="viewedLast30">\n      \t          <h5>'.concat(i,'</h5>\n      \t\t\t\t\t\t<div class="border-top mt-2 mb-3"></div>\n      \t        </div>\n      \t      </div>\n      \t      <div class="tab-pane" id="most-cited" role="tabpanel">\n      \t        <div id="viewedMostCited">\n      \t            <h5>').concat(i,'</h5>\n      \t\t\t\t\t\t\t<div class="border-top mt-2 mb-3"></div>\n      \t        </div>\n      \t      </div>\n      \t      <div class="tab-pane" id="most-attention" role="tabpanel">\n      \t        <div id="viewedMostAltmetric">\n      \t          <h5>').concat(i,'</h5>\n      \t\t\t\t\t\t<div class="border-top mt-2 mb-2"></div>\n      \t        </div>\n      \t      </div>\n      \t    </div>\n\n      \t  </div>\n\n      \t</div>\n      \t<div class="text-right mt-3">\n      \t\t<a href="').concat("/mmwr/mmwr_trends.html",'" class="btn btn-primary btn-sm" role="button">More MMWR Trends</a>\n      \t</div>');function l(t,e,a,i){$.getJSON(t,function(t){a(t,e,i-1)})}function c(t,e,a){var i=[];$.each(t.ArticleList,function(t,e){return i.push('<li id="'+t+'"><a href="'+e.URL+'" target="_blank">'+$("<textarea />").html(e.articleTitle).text()+"</a><br />"+e.MetricsByPeriod[0].Views.count.toLocaleString()+" Views</li>"),t<a}),$("<ol/>",{class:"pl-3",html:i.join("")}).appendTo(e)}"mini"===t?($(a).append(o),n=3):($(a).append(s),l("https://www.cdc.gov/SocialMedia/JournalMetrics/MMWR/mmwr_mostviewed365.json","#viewedLastYear",c,n)),l("https://www.cdc.gov/SocialMedia/JournalMetrics/MMWR/mmwr_mostcited.json","#viewedMostCited",function(t,e,a){var i=[];$.each(t.ArticleList,function(t,e){return i.push('<li id="'+t+'"><a href="'+e.URL+'" target="_blank">'+$("<textarea />").html(e.articleTitle).text()+"</a><br />"+e.MetricsByPeriod[0].Citations.count.toLocaleString()+" Citations</li>"),t<a}),$("<ol/>",{class:"pl-3",html:i.join("")}).appendTo(e)},n),l("https://www.cdc.gov/SocialMedia/JournalMetrics/MMWR/mmwr_mostviewed90.json","#viewedLast30",c,n),l("https://www.cdc.gov/SocialMedia/JournalMetrics/MMWR/mmwr_mostaltmetricactivity90.json","#viewedMostAltmetric",function(t,e,a){var i=[],n=0;$.each(t.ArticleList,function(t,e){return 0<e.AltMetricScore&&(9===a?i.push('<li id="'+t+'">'+function(t,e){return'<img alt="ALT_TEXT" src="https://badges.altmetric.com/?size=64&amp;score='+e+'&amp;types=ttttmmff" width="64px" height="64px" style="border:0; max-width: none;margin: 0 10px 10px 0; vertical-align: top;">'}(e.MetricsByPeriod,Math.round(e.AltMetricScore).toLocaleString())+'<a style="display: inline-block; max-width: 500px;" href="'+e.URL+'" target="_blank">'+$("<textarea />").html(e.articleTitle).text()+"</a></li>"):i.push('<li id="'+t+'"><a href="'+e.URL+'" target="_blank">'+$("<textarea />").html(e.articleTitle).text()+"</a><br />"+Math.round(e.AltMetricScore).toLocaleString()+" Altmetric Attention</li>"),n++),n<=a}),$("<ul/>",{class:"block-list",style:"margin: 0; padding: 0;",html:i.join("")}).appendTo(e)},n),$(".viewed_last_30, .viewed_last_year").on("click",function(){$(this).hasClass("active")||$("#viewedLastYear, #viewedLast30").toggleClass("d-none")})}},{key:"loadArticle",value:function(t,e){document.createElement("a").href=location.href;var a=["x"],i=["dates"],n=["x"],s=["dates"],o=[];$(function(){void 0!==$('link[rel="canonical"]').attr("href")?($("<style></style>").appendTo(document.head),$(".body-wrapper").append('<div class="modal fade" id="articleMetricModal" tabindex="-1" role="dialog" aria-labelledby="articleMetricModal" aria-hidden="true">\n      <div class="modal-dialog modal-lg" role="document">\n        <div class="modal-content">\n          <div class="modal-header">\n      \t\t\t<h5 class="modal-title">Metric Details</h5>\n      \t\t\t<button type="button" class="close rounded-circle" data-dismiss="modal" aria-label="Close">\n      \t\t\t\t<span class="sr-only">Close</span>\n      \t\t\t\t<svg style="width:24px;height:24px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      \t\t\t\t\t<path class="fill-w" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"></path>\n      \t\t\t\t</svg>\n      \t\t\t</button>\n      \t\t</div>\n          <div class="modal-body">\n            <h4 class="open">Views</h4>\n            <p>View data is collected and posted time period. Page views include both html and pdf views of an article.</p>\n            <div class="card">\n            \t<div class="card-header bg-primary text-white">\n            \t\tViews since publication\n            \t</div>\n            \t<div class="card-body">\n            \t\t<div class="card-text">\n                  <ul class="block-list p-0">\n                    <li>Page Views:<span style="margin-left:4px;" class=mmwr_page_views></span></li>\n                    <li>Page Downloads:<span style="margin-left:4px;" class=mmwr_downloads></span></li>\n                    <li><strong>Total Views:<span style="margin-left:4px;" class=mmwr_total_views></span></strong></li>\n                  </ul>\n                </div>\n            \t</div>\n            </div>\n            <div class="mt-3 mb-3"></div>\n            <div class="card charts">\n            \t<div class="card-header bg-primary text-white">\n            \t\tView Activity\n            \t</div>\n            \t<div class="card-body">\n            \t\t<div class="card-text text-center">\n                  <div class="btn-group btn-group-toggle mb-2" data-toggle="buttons">\n                    <label class="btn btn-sm btn-secondary 30_days_chart active">\n                      <input type="radio" name="options" checked> First 30 Days\n                    </label>\n                    <label class="btn btn-sm btn-secondary 360_days_chart">\n                      <input type="radio" name="options"> Total Views\n                    </label>\n                  </div>\n                  <div class="chart" id="chart30"></div>\n                  <div class="chart d-none" id="chart360"></div>\n                </div>\n            \t</div>\n            </div>\n            <h4 class="mt-4 open">Citations: <span class=mmwr_citations></span></h4>\n            <div class="border-top mt-3 mb-3"></div>\n            <div class="col-12 p-0">\n              <h4 class="mt-3 open">Altmetrics</h4>\n              <div class="col-lg-4 float-left">\n                <div class="altmetric-embed" data-badge-details="right" data-badge-type="donut" data-condensed="true" data-hide-no-mentions="true" data-link-target="_blank"></div>\n                <em class="small mt-3 d-block">Click a source for Altmetric details</em>\n              </div>\n              <div class="col-lg-8 float-right">\n                <h5 class="open mt-0"><strong>What is the Altmetric Attention Score?</strong></h5>\n                <p>The Altmetric Attention Score for a research output provides an indicator of the amount of attention that it has received. The score is derived from an automated algorithm, and represents a weighted count of the amount of attention Altmetric picked up for a research output.</p>\n              </div>\n            </div>\n          </div>\n          <div class="modal-footer">\n            <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>\n          </div>\n        </div>\n      </div>\n    </div>'),$(".30_days_chart, .360_days_chart").on("click",function(){$(this).hasClass("active")||$("#chart360, #chart30").toggleClass("d-none")}),$.ajax({url:e,dataType:"json",timeout:5e3,success:function(t){for($("#page-title").html(document.title||$("<textarea />").html(t.Title).text()),o[0]=t.metricsperiods[0].metrics[0].details,o[1]=t.metricsperiods[1].metrics[0].details,e=0;e<o[0].length;e++)a.push(new Date(o[0][e].metricname)),i.push(o[0][e].count);for(var e=0;e<o[1].length;e++)n.push(new Date(o[1][e].metricname)),s.push(o[1][e].count);$(".mmwr_page_views").text(t.metricsperiods[1].metrics[0].count.toLocaleString()),$(".mmwr_downloads").text(t.metricsperiods[1].metrics[1].count.toLocaleString()),$(".mmwr_citations").text(t.metricsperiods[1].metrics[2].count.toLocaleString()),$(".mmwr_total_views").text((t.metricsperiods[1].metrics[0].count+t.metricsperiods[1].metrics[1].count).toLocaleString()),$("#articleMetricModal").on("shown.bs.modal",function(t){$("#chart30 svg").length||(c3.generate({bindto:"#chart30",data:{x:"x",columns:[a,i]},axis:{x:{type:"timeseries",tick:{format:"%b %d, %Y"}}},legend:{show:!1}}),c3.generate({bindto:"#chart360",data:{x:"x",columns:[n,s]},axis:{x:{type:"timeseries",tick:{format:"%b %d, %Y"}}},legend:{show:!1}})),_altmetric_embed_init()})},error:function(t,e,a){"404"==t.status&&$('div[data-mmwr-metrics="article"] > .card-body > .text-left').html("")}})):console.error("Canonical link not defined")})}},{key:"loadScopus",value:function(t,e){$(function(){$.ajax({url:e,dataType:"json",timeout:5e3,success:function(t){var e=t.metricsperiods[1].metrics[2].count,a="citations";t.ScopusRecordUrl&&0<t.ScopusRecordUrl.length&&(a='<a href="'.concat(t.ScopusRecordUrl,'" title="External Link">citations</a><a href="').concat(t.ScopusRecordUrl,'" title="External Link"><span class="sr-only">External Link</span><svg class="icon x16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="#ext"></use></svg></a>'));var i='<div class="card mb-3">\n                                      <div class="card-body bg-white">\n                                        <h3 class="d-inline font-weight-bold">'.concat(e,'</h3>\n                                        <p class="m-0 pb-3 d-inline-block">').concat(a,' of this article</p>\n                                        <p class="m-0 small"><em>MMWR Journal Metrics on <a href="https://www.scopus.com/sourceid/19434">Scopus</a><a href="https://www.scopus.com/sourceid/19434" title="External Link"><span class="sr-only">External Link</span><svg class="icon x16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="#ext"></use></svg></em></a></p>\n                                      </div>\n                                    </div>');document.querySelector('div[data-mmwr-metrics="scopus"]').innerHTML=i},error:function(t,e,a){document.querySelector('div[data-mmwr-metrics="scopus"]').innerHTML='<div class="card mb-3">\n                    <div class="card-body bg-white">\n                      <p class="m-0 pb-2 d-inline-block">No citation data found.</p>\n                    </div>\n                  </div>'}})})}}]),n}();document.addEventListener("DOMContentLoaded",function(){for(var t=document.querySelectorAll("div[data-mmwr-metrics]"),e=0;e<t.length;++e){var a=t[e];a.setAttribute("data-widget-num",e),new mmwrMetrics(a.dataset.mmwrMetrics,e)}});