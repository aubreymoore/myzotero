function markerObscuredRectangle(marker,shapeOptions){var cell_size=.2,position=marker.getPosition(),coords=[position.lat(),position.lng()],ll=[coords[0]-coords[0]%cell_size,coords[1]-coords[1]%cell_size],uu=[ll[0],ll[1]];return _.each(coords,function(value,key){value<uu[key]?uu[key]-=cell_size:uu[key]+=cell_size}),new google.maps.Rectangle(_.extend(shapeOptions,{bounds:new google.maps.LatLngBounds(new google.maps.LatLng(Math.min(uu[0],ll[0]),Math.min(uu[1],ll[1])),new google.maps.LatLng(Math.max(uu[0],ll[0]),Math.max(uu[1],ll[1])))}))}function selectAllIconicTaxa(){$(".iconic_taxon_filter input").each(function(){this.checked=!0,$(this).siblings("label").addClass("selected")})}function deSelectAllIconicTaxa(){$(".iconic_taxon_filter input").each(function(){this.checked=!1,$(this).siblings("label").removeClass("selected")})}function toggleFilters(link,options){var options=$.extend({},options);0==$("#filters:visible").length?showFilters(link,options):hideFilters(link,options)}function showFilters(link,options){var options=$.extend({},options);$("#filters").show(),options.skipClass||$(link).addClass("open"),$("#filters input[name=filters_open]").val(!0),0==$("#filters .simpleTaxonSelector").length&&$("#filters input[name=taxon_name]").taxonAutocomplete(),0==$("#place_filter .ui-widget").length&&$("#filters input[name=place_id]").chooser({collectionUrl:"/places/autocomplete.json",resourceUrl:"/places/{{id}}.json?partial=autocomplete_item",chosen:eval("("+$("#filters input[name=place_id]").attr("data-json")+")")})}function hideFilters(link,options){var options=$.extend({},options);$("#filters").hide(),options.skipClass||$(link).removeClass("open"),$("#filters input[name=filters_open]").val(!1)}function deselectAll(){$("#filters :text, #fitlers :input[type=hidden], #fitlers select").val(null),$("#filters :input:checkbox").prop("checked",!1),deSelectAllIconicTaxa(),$("#filters input[name=place_id]").chooser("clear",{bubble:!1}),$.fn.simpleTaxonSelector.unSelectTaxon("#filters .simpleTaxonSelector")}function setFiltersFromQuery(query){deselectAll();var params=$.deparam(query);params.has=params.has||[],"true"===params.photos&&params.has.push("photos"),"true"===params.sounds&&params.has.push("sounds"),$.each(params,function(k,v){"iconic_taxa"!=k&&"has"!=k&&$('#filters :input:radio[name="'+k+'"][value="'+v+'"]').prop("checked",!0),$.isArray(v)?(v2=v.join(","),$('#filters :input[name="'+k+'[]"]').not(":checkbox, :radio").val(v2)):$('#filters :input[name="'+k+'"]').not(":checkbox, :radio").val(v),"place_id"==k?$("#filters input[name=place_id]").chooser("selectId",v):"taxon_id"==k?$.fn.simpleTaxonSelector.selectTaxonFromId("#filters .simpleTaxonSelector",v):"iconic_taxa"==k||"has"==k||"month"==k?$.each(v,function(i,av){$selection=$('#filters :input:checkbox[name="'+k+'[]"][value='+av+"]"),$selection.prop("checked",!0),"iconic_taxa"==k&&$selection.siblings("label").addClass("selected")}):"projects"==k&&$('#filters :input[name="projects[]"]').val(v)})}!function(){/*
 * iNaturalist javascript library
 * Copyright (c) iNaturalist, 2007-2008
 * 
 * @date: 2008-01-01
 * @author: n8agrin
 * @author: kueda
 *
 * Much love to jQuery for the inspiration behind this class' layout.
 */
var iNaturalist=window.iNaturalist=new function(){this.registerNameSpace=function(ns){for(var nsParts=ns.split("."),root=window,i=0;i<nsParts.length;i++)"undefined"==typeof root[nsParts[i]]&&(root[nsParts[i]]=new Object),root=root[nsParts[i]]},this.restfulDelete=function(deleteURL,options,target){if("undefined"==typeof options.plural)var plural=!1;else{var plural=options.plural;options.plural=null}var ajaxOptions=$.extend({},options,{type:"POST",data:$.extend({_method:"delete",authenticity_token:$("meta[name=csrf-token]").attr("content")},options.data),url:deleteURL});if(confirmStr=plural?"Are you sure you want to delete these?":"Are you sure you want to delete this?",!confirm(confirmStr))return!1;if("undefined"!=typeof target){$(target).hide();var deleteStatus=$('<span class="loading status">Deleting...</span>');$(target).after(deleteStatus)}$.ajax(ajaxOptions)},this.modalShow=function(hash){iNaturalist.modalCenter(hash.w),hash.w.show(),hash.c.overlay>0&&hash.o.prependTo("body")},this.modalCenter=function(elt){elt.height("auto");var height=.9*$(window).height();elt.height()<height&&(height=elt.height()),elt.height((height=elt.height())?"auto":height);var top=$(window).scrollTop()+$(window).height()/2-elt.height()/2-20;elt.css("top",top+"px")},this.localeParams=function(){var localeParams={locale:I18n.locale};return PREFERRED_PLACE&&(localeParams.preferred_place_id=PREFERRED_PLACE.id),localeParams},this.Licenses={c:{code:"C","short":"(c)",name:"Copyright",url:"http://en.wikipedia.org/wiki/Copyright",icon:null,icon_large:null},"cc-by-nc-sa":{code:"CC-BY-NC-SA","short":"CC BY-NC-SA",name:"Creative Commons Attribution-NonCommercial-ShareAlike License",url:"http://creativecommons.org/licenses/by-nc-sa/4.0/",icon:"/assets/CC-BY-NC-SA_small-6056cb6b3f7929147de25dd231158722.png",icon_large:"/assets/CC-BY-NC-SA-83ad5a4ca86bf6142e91702c90ce9192.png"},"cc-by-nc":{code:"CC-BY-NC","short":"CC BY-NC",name:"Creative Commons Attribution-NonCommercial License",url:"http://creativecommons.org/licenses/by-nc/4.0/",icon:"/assets/CC-BY-NC_small-fbf997133b63da03d12d0d96f1154fc7.png",icon_large:"/assets/CC-BY-NC-8fce4f22da6fb3d06e2063557f74bda5.png"},"cc-by-nc-nd":{code:"CC-BY-NC-ND","short":"CC BY-NC-ND",name:"Creative Commons Attribution-NonCommercial-NoDerivs License",url:"http://creativecommons.org/licenses/by-nc-nd/4.0/",icon:"/assets/CC-BY-NC-ND_small-787c524b357a0c9dbf58ddcb4a2acb64.png",icon_large:"/assets/CC-BY-NC-ND-7413f969b469e7f863c13d56ef1da440.png"},"cc-by":{code:"CC-BY","short":"CC BY",name:"Creative Commons Attribution License",url:"http://creativecommons.org/licenses/by/4.0/",icon:"/assets/CC-BY_small-b3e8a1a0b804aa1579f05d8d8d8d1c15.png",icon_large:"/assets/CC-BY-36363d0e67d6729a4da2929acecc2ed5.png"},"cc-by-sa":{code:"CC-BY-SA","short":"CC BY-SA",name:"Creative Commons Attribution-ShareAlike License",url:"http://creativecommons.org/licenses/by-sa/4.0/",icon:"/assets/CC-BY-SA_small-6aad4acc039ccd1813b86cd427ca9b12.png",icon_large:"/assets/CC-BY-SA-03c33e24b9f9f417648d3510054b02e0.png"},"cc-by-nd":{code:"CC-BY-ND","short":"CC BY-ND",name:"Creative Commons Attribution-NoDerivs License",url:"http://creativecommons.org/licenses/by-nd/4.0/",icon:"/assets/CC-BY-ND_small-a19769b46602c75142e7aa4331c70ed4.png",icon_large:"/assets/CC-BY-ND-c42537b4c3b6f02aeab67d4f92a82848.png"},pd:{code:"PD","short":"PD",name:"Public domain",url:"http://en.wikipedia.org/wiki/Public_domain",icon:null,icon_large:null},gfdl:{code:"GFDL","short":"GFDL",name:"GNU Free Documentation License",url:"http://www.gnu.org/copyleft/fdl.html",icon:null,icon_large:null},cc0:{code:"CC0","short":"CC0",name:"Creative Commons CC0 Universal Public Domain Dedication",url:"http://creativecommons.org/publicdomain/zero/1.0/",icon:"/assets/CC0_small-3b657b50bae338c30f42c55c088e89f4.png",icon_large:"/assets/CC0-2a90c822e5aa51415cc251f8f6d5fa1d.png"}}};iNaturalist.version=.1,iNaturalist.form_authenticity_token=null}(),function(){function elasticsearchTileservers(){var tileservers=["https://tiles.inaturalist.org/v1"];if(tileservers[0].match(/{n}/)){var pattern=tileservers[0];tileservers=_.map(["1","2","3","4"],function(n){return pattern.replace("{n}",n)})}return tileservers}function intereactionsServer(){var interactionTileURL="";return interactionTileURL?interactionTileURL:elasticsearchTileservers()[0]}function postgisTileservers(){var nodeApiURL="https://api.inaturalist.org/v1";return nodeApiURL?[nodeApiURL]:elasticsearchTileservers()}/**
 * iNaturalist map object
 * Copyright (c) iNaturalist, 2007-2008
 * 
 * @created: 2008-01-01
 * @updated: 2008-04-12
 * @author: n8agrin
 * @author: kueda
 */
if("undefined"==typeof google||"undefined"==typeof google.maps)throw"The Google Maps libraries must be loaded to use the iNaturalist Map extensions.";var deselectText=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},emptyLayer=new google.maps.ImageMapType({tileSize:new google.maps.Size(256,256),getTileUrl:function(){}});google.maps.Marker.prototype.observation_id=null,google.maps.Map.prototype.observations={},google.maps.Map.prototype.places={},google.maps.Map.prototype.lastUnsavedMarker=null,google.maps.Map.prototype.infoWindow=null,google.maps.Map.prototype.createMarker=function(lat,lng,options){return options=options||{},options.position=new google.maps.LatLng(lat,lng),new google.maps.Marker(options)},google.maps.Map.prototype.removeMarker=function(marker){google.maps.event.clearInstanceListeners(marker),marker.setMap(null),this.removeOverlay(marker)},google.maps.Map.prototype.addNewCenteredMarker=function(options){return this.addNewUnsavedMarker(this.getCenter().lat(),this.getCenter().lng(),options)},google.maps.Map.prototype.addNewUnsavedMarker=function(lat,lng,options){return this.removeLastUnsavedMarker(),this.lastUnsavedMarker=this.createMarker(lat,lng,options),this.lastUnsavedMarker.setMap(this),this.lastUnsavedMarker},google.maps.Map.prototype.removeLastUnsavedMarker=function(){return this.lastUnsavedMarker?(this.removeMarker(this.lastUnsavedMarker),this.lastUnsavedMarker=null,!0):!1},google.maps.Map.prototype.addObservation=function(observation,options){options=options||{};var lat=observation.private_latitude||observation.latitude,lon=observation.private_longitude||observation.longitude;if(!lat||!lon)return!1;options.icon||(options.icon=iNaturalist.Map.createObservationIcon({observation:observation}));var marker=this.createMarker(lat,lon,options);this.observations[observation.id]=marker,("undefined"==typeof options.clickable||0!=options.clickable)&&(marker.message=this.buildObservationInfoWindow(observation),google.maps.event.addListener(marker,"click",this.openInfoWindow));var bounds=this.getObservationBounds();if(bounds.extend(new google.maps.LatLng(lat,lon)),this.setObservationBounds(bounds),marker.setMap(this),observation.marker=marker,options.showAccuracy&&(observation.coordinates_obscured||observation.positional_accuracy&&observation.positional_accuracy>0)){var iconicTaxonName=observation.iconic_taxon_name;!iconicTaxonName&&observation.iconic_taxon&&(iconicTaxonName=observation.iconic_taxon.name),!iconicTaxonName&&observation.taxon&&(iconicTaxonName=observation.taxon.iconic_taxon_name);var shape,color=iconicTaxonName?iNaturalist.Map.ICONIC_TAXON_COLORS[iconicTaxonName]:"#333333",shapeOptions={strokeColor:color,strokeOpacity:.8,strokeWeight:2,fillColor:color,fillOpacity:.35,map:this};if(observation.coordinates_obscured)shape=markerObscuredRectangle(marker,shapeOptions);else{var accuracy=parseInt(observation.positional_accuracy)||0;if(0==accuracy)return;shape=new google.maps.Circle(_.extend(shapeOptions,{center:marker.getPosition(),radius:accuracy})),observation._circle=shape}var listener=function(){var mapBounds=this.getBounds(),shapeBounds=shape.getBounds();shape.setVisible(mapBounds&&shapeBounds.contains(mapBounds.getNorthEast())&&shapeBounds.contains(mapBounds.getSouthWest())?!1:!0)};google.maps.event.addListener(this,"zoom_changed",listener),google.maps.event.addListener(this,"bounds_changed",listener)}return observation},google.maps.Map.prototype.removeObservation=function(observation){this.removeMarker(this.observations[observation.id]),this.observations[observation.id]&&this.observations[observation.id].setMap(null),delete this.observations[observation.id]},google.maps.Map.prototype.addObservations=function(observations,options){var map=this;$.each(observations,function(){map.addObservation(this,options)})},google.maps.Map.prototype.removeObservations=function(observations){var map=this;"undefined"==typeof observations?$.each(map.observations,function(k){map.removeObservation({id:k}),delete map.observationBounds}):$.each(observations,function(){map.removeObservation(this)})},google.maps.Map.prototype.getObservationBounds=function(){return this.observationBounds||(this.observationBounds=new google.maps.LatLngBounds),this.observationBounds},google.maps.Map.prototype.setObservationBounds=function(bounds){this.observationBounds=bounds},google.maps.Map.prototype.zoomToObservations=function(){this.fitBounds(this.getObservationBounds())},google.maps.Map.prototype.addPlaces=function(places){for(var i=places.length-1;i>=0;i--)this.addPlace(places[i])},google.maps.Map.prototype.addPlace=function(place,options){if("undefined"==typeof options)var options={};"undefined"==typeof options.icon&&(options.icon=iNaturalist.Map.createPlaceIcon());var marker=this.createMarker(place.latitude,place.longitude,options);this.places[place.id]=marker;var placesLength=0;for(var key in this.places)placesLength+=1;if(1==placesLength&&null!=place.swlat&&""!=place.swlat)var bounds=new google.maps.LatLngBounds(new google.maps.LatLng(place.swlat,place.swlng),new google.maps.LatLng(place.nelat,place.nelng));else{var bounds=this.getPlaceBounds();place.swlat?(bounds.extend(new google.maps.LatLng(place.swlat,place.swlng)),bounds.extend(new google.maps.LatLng(place.nelat,place.nelng))):bounds.extend(new google.maps.LatLng(place.latitude,place.longitude))}return this.setPlaceBounds(bounds),marker.setMap(this),place.marker=marker,place},google.maps.Map.prototype.setPlace=function(place,options){if(options=options||{},place.swlat){var bounds=new google.maps.LatLngBounds(new google.maps.LatLng(place.swlat,place.swlng),new google.maps.LatLng(place.nelat,place.nelng));this.fitBounds(bounds)}else this.setCenter(new google.maps.LatLng(place.latitude,place.longitude))},google.maps.Map.prototype.removePlace=function(place){this.places[place.id]&&(this.removeMarker(this.places[place.id]),delete this.places[place.id])},google.maps.Map.prototype.removePlaces=function(places){var map=this;"undefined"==typeof places?$.each(map.places,function(){map.removeMarker(this),delete this}):$.each(places,function(){map.removePlace(this)}),this.placeBounds=new google.maps.LatLngBounds},google.maps.Map.prototype.zoomToPlaces=function(){this.fitBounds(this.getPlaceBounds())},google.maps.Map.prototype.getPlaceBounds=function(){return"undefined"==typeof this.placeBounds&&(this.placeBounds=new google.maps.LatLngBounds),this.placeBounds},google.maps.Map.prototype.setPlaceBounds=function(bounds){this.placeBounds=bounds};var infoWindowOpenTime;google.maps.Map.prototype.openInfoWindow=function(){infoWindowOpenTime=new Date,window.map&&window.map.infoWindow&&window.map.infoWindow.close(),iNaturalist.Map.infoWindow=iNaturalist.Map.infoWindow||new google.maps.InfoWindow,iNaturalist.Map.infoWindow.setContent(this.message),iNaturalist.Map.infoWindow.open(this.map,this)},google.maps.Map.prototype.buildObservationInfoWindow=function(observation){var existing=document.getElementById("observation-"+observation.id);if("undefined"!=typeof existing&&null!=existing){var infowinobs=$(existing).clone().get(0);$(infowinobs).find(".details").show();var wrapper=$('<div class="compact mini infowindow observations"></div>').append(infowinobs);return $(wrapper).get(0)}var photoURL,wrapper=$('<div class="observation"></div>');return"undefined"!=typeof observation.image_url&&null!=observation.image_url?photoURL=observation.image_url:"undefined"!=typeof observation.obs_image_url&&null!=observation.obs_image_url?photoURL=observation.obs_image_url:"undefined"!=typeof observation.photos&&observation.photos.length>0&&(photoURL=observation.photos[0].square_url),photoURL&&wrapper.append($('<img width="75" height="75"></img>').attr("src",photoURL).addClass("left")),wrapper.append($('<div class="readable attribute inlineblock"></div>').append($('<a href="/observations/'+observation.id+'"></a>').append(observation.species_guess))),observation.user?wrapper.append(", by ",$('<a href="/people/'+observation.user.login+'"></a>').append(observation.user.login)):"undefined"!=typeof observation.identifications&&observation.identifications.length>0&&"undefined"!=typeof observation.identifications[0].user&&wrapper.append(", by ",$('<a href="/people/'+observation.identifications[0].user.login+'"></a>').append(observation.identifications[0].user.login)),wrapper.append("undefined"!=typeof observation.short_description&&null!=observation.short_description?$('<div class="description"></div>').append(observation.short_description):$('<div class="description"></div>').append(observation.description)),wrapper=$('<div class="compact observations mini infowindow"></div>').append(wrapper),wrapper.get(0)},"undefined"==typeof iNaturalist&&(this.iNaturalist={}),"undefined"==typeof iNaturalist.Map&&(this.iNaturalist.Map={}),iNaturalist.Map.MAP_BACKGROUND_COLOR="#B3D1FF",iNaturalist.Map.SATELLITE_BACKGROUND_COLOR="#2A4280",iNaturalist.Map.MapTypes={},iNaturalist.Map.MapTypes.LIGHT="light",iNaturalist.Map.MapTypes.light=new google.maps.StyledMapType([{stylers:[{lightness:50},{saturation:-50}]}],{name:"Map"}),iNaturalist.Map.MapTypes.LIGHT_NO_LABELS="light_no_labels",iNaturalist.Map.MapTypes.light_no_labels=new google.maps.StyledMapType([{stylers:[{lightness:50},{saturation:-50}]},{featureType:"all",elementType:"labels",stylers:[{visibility:"off"}]}],{name:"Map (no labels)"}),iNaturalist.Map.createMap=function(options){options=options||{},options=$.extend({},{div:"map",center:new google.maps.LatLng(options.lat||0,options.lng||0),zoom:1,mapTypeId:google.maps.MapTypeId.TERRAIN,streetViewControl:!1,backgroundColor:iNaturalist.Map.MAP_BACKGROUND_COLOR,clickableIcons:!1,gestureHandling:"greedy"},options);var map;if(map="string"==typeof options.div?new google.maps.Map(document.getElementById(options.div),options):new google.maps.Map(options.div,options),map.addListener("maptypeid_changed",function(){var mapTypeId=map.getMapTypeId();$(map.getDiv()).css(mapTypeId==google.maps.MapTypeId.SATELLITE||mapTypeId==google.maps.MapTypeId.HYBRID?{backgroundColor:iNaturalist.Map.SATELLITE_BACKGROUND_COLOR}:{backgroundColor:map._inatMapBackgroundColor})}),map._inatMapBackgroundColor=options.backgroundColor||iNaturalist.Map.MAP_BACKGROUND_COLOR,options.disableFullscreen||map.controls[google.maps.ControlPosition.TOP_RIGHT].push(new iNaturalist.FullScreenControl(map)),options.bounds)if("function"==typeof options.bounds.getCenter)map.setBounds(options.bounds);else{var bounds=new google.maps.LatLngBounds(new google.maps.LatLng(options.bounds.swlat,options.bounds.swlng),new google.maps.LatLng(options.bounds.nelat,options.bounds.nelng));map.fitBounds(bounds)}return map},iNaturalist.Map.createPlaceIcon=function(options){var options=options||{},iconPath="/mapMarkers/mm_34_stemless_";iconPath+=options.color?options.color:"DeepPink",options.character&&(iconPath+="_"+options.character),iconPath+=".png";var place=new google.maps.MarkerImage(iconPath);return place.size=new google.maps.Size(20,20),place.anchor=new google.maps.Point(10,10),place},iNaturalist.Map.createObservationIcon=function(options){if("undefined"==typeof options)var options={};var iconPath;if(options.observation){var iconSet=options.observation.coordinates_obscured?"STEMLESS_ICONS":"ICONS",iconicTaxonIconsSet=options.observation.coordinates_obscured?"STEMLESS_ICONIC_TAXON_ICONS":"ICONIC_TAXON_ICONS",iconicTaxonName=options.observation.iconic_taxon_name;return!iconicTaxonName&&options.observation.iconic_taxon&&(iconicTaxonName=options.observation.iconic_taxon.name),!iconicTaxonName&&options.observation.taxon&&(iconicTaxonName=options.observation.taxon.iconic_taxon_name),iconicTaxonName?(iconPath=_.clone(iNaturalist.Map[iconicTaxonIconsSet][iconicTaxonName]),"research"!=options.observation.quality_grade&&(iconPath.url=iconPath.url.replace(/\.png$/,"NoDot.png"))):iconPath=iNaturalist.Map[iconSet].unknown34,options.observation.coordinates_obscured&&(iconPath.anchor=new google.maps.Point(10,10)),iconPath}return iconPath="/mapMarkers/mm_34_",iconPath+=options.stemless?"stemless_":"",iconPath+=options.color||"HotPink",iconPath+=options.character?"_"+options.character:"",options.character||"research"==options.quality_grade||(iconPath+="NoDot"),iconPath+=".png"},iNaturalist.Map.distanceInMeters=function(lat1,lon1,lat2,lon2){var earthRadius=6370997,degreesPerRadian=57.2958,dLat=(lat2-lat1)/degreesPerRadian,dLon=(lon2-lon1)/degreesPerRadian,lat1=lat1/degreesPerRadian,lat2=lat2/degreesPerRadian,a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.sin(dLon/2)*Math.sin(dLon/2)*Math.cos(lat1)*Math.cos(lat2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=earthRadius*c;return d},iNaturalist.FullScreenControl=function(map){var controlDiv=document.createElement("DIV"),enter='<span class="ui-icon ui-icon-extlink">Full screen</span>',exit='<span class="ui-icon ui-icon-arrow-1-sw inlineblock"></span> '+I18n.t("exit_full_screen");controlDiv.style.padding="5px";var controlUI=$("<div></div>").html(enter).addClass("gmapv3control");controlDiv.appendChild(controlUI.get(0));var exitFullScreen=function(){var oldCenter=map.getCenter();$(this).html(enter).css("font-weight","normal"),$(map.getDiv()).removeClass("fullscreen"),google.maps.event.trigger(map,"resize"),map.setCenter(oldCenter)};window.fullscreenEscapeHandler=function(e){27===e.keyCode&&controlUI.click(),$(document).unbind("keyup",window.fullscreenEscapeHandler)};var enterFullScreen=function(){var oldCenter=map.getCenter();$(this).html(exit).css("font-weight","bold"),$(map.getDiv()).addClass("fullscreen"),google.maps.event.trigger(map,"resize"),map.setCenter(oldCenter),$(document).bind("keyup",window.fullscreenEscapeHandler)};return controlUI.toggle(enterFullScreen,exitFullScreen),controlDiv},iNaturalist.legendItem=function(options){var li=$("<li/>"),iconDiv=$("<div/>").addClass("icon");options.images?_.each(options.images,function(i){var icon=$("<img/>").attr("src",i);options.imageClasses&&icon.addClass(options.imageClasses),iconDiv.append(icon)}):options.color?iconDiv.addClass("color-box").css("background",options.color):options.unknown===!0&&iconDiv.addClass("color-box unknown"),options.classes&&li.addClass(options.classes);var labelDiv=$("<div/>").addClass("label").text(options.label);return li.append(iconDiv).append(labelDiv)},iNaturalist.LegendControl=function(controlDiv){var controlUI=$("<div><div id='map-legend-label' class='gmap-label'>"+I18n.t("map_legend")+"</div></div>").addClass("gmapv3legend");controlUI.click(function(){$("#map-legend").toggle(),$("#map-legend").focus()}),controlDiv.appendChild(controlUI.get(0))},iNaturalist.Legend=function(controlDiv,map,options){options=options||{};var controlUI=$("<div id='map-legend'><div class='title'>"+I18n.t("map_legend")+"</div></div>").addClass("gmapv3legend").hide(),ulDiv=$("<div></div>").addClass("ul-container"),ul1=$("<ul></ul>").addClass("inat-overlay left");ul1.append($("<li class='header'>"+I18n.t("quality_grade")+"</li>")),ul1.append(iNaturalist.legendItem({images:["/assets/map_legend/legend_lg_mm_research-63e97c6b1095a04b130fda59a807d8f0.png","/assets/map_legend/legend_lg_mm_circle_research-603c11bae7b3ff95ae80b4197c7a572c.png"],label:I18n.t("research_grade")})),ul1.append(iNaturalist.legendItem({images:["/assets/map_legend/legend_lg_mm-10ff0ed9e3243959513570f159763a1f.png","/assets/map_legend/legend_lg_mm_circle-c86bd3ed63b6fe38adaba4f04802dc79.png"],label:[I18n.t("needs_id"),I18n.t("casual")].join(", "),classes:"last"})),ul1.append($("<li class='header'>"+I18n.t("geoprivacy")+"</li>")),ul1.append(iNaturalist.legendItem({images:["/assets/map_legend/legend_lg_mm-10ff0ed9e3243959513570f159763a1f.png"],label:I18n.t("open")})),ul1.append(iNaturalist.legendItem({images:["/assets/map_legend/legend_lg_mm_circle-c86bd3ed63b6fe38adaba4f04802dc79.png"],label:I18n.t("obscured"),classes:"last"})),options.hideFeatured||(ul1.append($("<li class='header'>"+I18n.t("map_marker_size")+"</li>")),ul1.append(iNaturalist.legendItem({images:["/assets/map_legend/legend_lg_mm_research-63e97c6b1095a04b130fda59a807d8f0.png","/assets/map_legend/legend_lg_mm-10ff0ed9e3243959513570f159763a1f.png","/assets/map_legend/legend_lg_mm_circle_research-603c11bae7b3ff95ae80b4197c7a572c.png","/assets/map_legend/legend_lg_mm_circle-c86bd3ed63b6fe38adaba4f04802dc79.png"],imageClasses:"large",label:I18n.t("featured"),classes:"tall"})),ul1.append(iNaturalist.legendItem({images:["/assets/map_legend/legend_lg_mm_research-63e97c6b1095a04b130fda59a807d8f0.png","/assets/map_legend/legend_lg_mm-10ff0ed9e3243959513570f159763a1f.png","/assets/map_legend/legend_lg_mm_circle_research-603c11bae7b3ff95ae80b4197c7a572c.png","/assets/map_legend/legend_lg_mm_circle-c86bd3ed63b6fe38adaba4f04802dc79.png"],imageClasses:"wide",label:I18n.t("all"),classes:"last"}))),ulDiv.append(ul1);var ul2=$("<ul></ul>").addClass("inat-overlay right");ul2.append($("<li class='header'>"+I18n.t("taxonomic_groups")+"</li>")),ul2.append(iNaturalist.legendItem({color:iNaturalist.Map.ICONIC_TAXON_COLORS.Animalia,label:[I18n.t("all_taxa.amphibians"),I18n.t("all_taxa.birds"),I18n.t("all_taxa.ray_finned_fishes"),I18n.t("all_taxa.mammals"),I18n.t("all_taxa.reptiles"),I18n.t("all_taxa.other_animals")].join(", ")})),ul2.append(iNaturalist.legendItem({color:iNaturalist.Map.ICONIC_TAXON_COLORS.Mollusca,label:[I18n.t("all_taxa.mollusks"),I18n.t("all_taxa.arachnids"),I18n.t("all_taxa.insects")].join(", ")})),ul2.append(iNaturalist.legendItem({color:iNaturalist.Map.ICONIC_TAXON_COLORS.Plantae,label:I18n.t("all_taxa.plants")})),ul2.append(iNaturalist.legendItem({color:iNaturalist.Map.ICONIC_TAXON_COLORS.Fungi,label:I18n.t("all_taxa.fungi")})),ul2.append(iNaturalist.legendItem({color:iNaturalist.Map.ICONIC_TAXON_COLORS.Chromista,label:I18n.t("all_taxa.chromista")})),ul2.append(iNaturalist.legendItem({color:iNaturalist.Map.ICONIC_TAXON_COLORS.Protozoa,label:I18n.t("all_taxa.protozoans")})),ul2.append(iNaturalist.legendItem({unknown:!0,label:I18n.t("unknown")})),ulDiv.append(ul2),controlUI.append(ulDiv),controlDiv.appendChild(controlUI.get(0))},iNaturalist.OverlayControl=function(map,options){options=options||{};var controlDiv=options.div||document.createElement("DIV");controlDiv.style.margin="14px 10px 0";var controlUI=$('<div><span class="ui-icon inat-icon ui-icon-layers">'+I18n.t("taxon_map.overlays")+"</span></div>").addClass("gmapv3control overlaycontrol"),ul=$("<ul></ul>").addClass("inat-overlay").hide();if(controlUI.append(ul),controlUI.hover(function(){$(this).addClass("open"),$("ul",this).show(),$(this).parent().css("z-index",1)},function(){$(this).removeClass("open"),$("ul",this).hide(),$(this).parent().css("z-index",0)}),controlDiv.appendChild(controlUI.get(0)),this.div=controlDiv,this.map=map,map.overlays)for(var i=0;i<map.overlays.length;i++)this.addOverlay(map.overlays[i]);return this},iNaturalist.OverlayControl.prototype.removeOverlayControl=function(title){$("li[data-title='"+title+"']",this.div).remove()},iNaturalist.OverlayControl.prototype.removeAll=function(){$("li[data-title]",this.div).remove(),$("li[data-taxon-id]",this.div).remove()},iNaturalist.OverlayControl.prototype.addWindshaftOverlayControl=function(layers,options){if(_.isArray(layers)&&0!==layers.length){var map=this.map,ul=$("ul",this.div),title=options.title||"Layer",id="layer_"+layers[0].layerID,description=options.description,checkbox=$("<input type='checkbox'/>"),li=$("<li/>"),controlPosition=google.maps.ControlPosition[options.controlPosition]||google.maps.ControlPosition.TOP_RIGHT;options.taxon&&(id+="-"+options.taxon.id),li.attr("data-title",title);var label=$("<label/>").attr("for",id).html(title);options.hover&&label.attr("title",options.hover),checkbox.attr("id",id).attr("name",title).attr("checked",!options.disabled),li.append(checkbox,label),"gbif"===options.endpoint&&options.gbif_id&&li.append("<a href='http://www.gbif.org/species/"+options.gbif_id+"' target='_blank'><span class='ui-icon ui-icon-extlink'>&nbsp;</span></a>"),options.taxon&&addWindshaftOverlayTaxonDiv(ul,li,options),checkbox.change(function(){var checked=$(this).prop("checked");_.each(layers,function(layerData){map.overlayMapTypes.setAt(layerData.layerID-1,checked?layerData.layer:emptyLayer)}),(taxonID=$(this).parent().data("taxon-id"))&&updateTaxonCheckboxState(ul,taxonID)}),description&&li.append($("<div/>").addClass("small meta").html(description)),ul.append(li),updateCheckboxInteractions(ul),map._overlayControlDisplayed||(map.controls[controlPosition].push(map._overlayControl.div),map._overlayControlDisplayed=!0)}};var updateTaxonCheckboxState=function(ul,taxonID){0===ul.find("li.for_taxon[data-taxon-id='"+taxonID+"'] input:checked").length?ul.find("li.taxon[data-taxon-id='"+taxonID+"'] input").prop("checked",!1):ul.find("li.taxon[data-taxon-id='"+taxonID+"'] input").prop("checked",!0)},updateCheckboxInteractions=function(ul){_.each(ul.find("li.taxon"),function(taxon_li){updateTaxonCheckboxState(ul,$(taxon_li).data("taxon-id"))}),ul.find("li.taxon input").unbind("change"),ul.find("li.taxon input").bind("change",function(){var checked=$(this).prop("checked"),selector=checked?":not(:checked)":":checked";ul.find("li.for_taxon[data-taxon-id='"+$(this).attr("id")+"'] input"+selector).prop("checked",checked).trigger("change")})},addWindshaftOverlayTaxonDiv=function(ul,li,options){if(taxon_id="taxon_layers_"+options.taxon.id,li.attr("class","for_taxon").attr("data-taxon-id",taxon_id),0==ul.find("#"+taxon_id).length){taxon_checkbox=$("<input type='checkbox'/>").attr("id",taxon_id).attr("name",options.taxon.name);var primaryName=options.taxon.common_name?options.taxon.common_name.name:options.taxon.to_styled_s;primaryName||(primaryName=options.taxon.preferred_common_name),primaryName||(primaryName=options.taxon.name),taxon_label=$("<label/>").attr("for",taxon_id).html(primaryName),taxon_li=$("<li/>").attr("class","taxon").attr("data-taxon-id",taxon_id).append(taxon_checkbox,taxon_label),options.taxon.url&&taxon_li.append("<a href='"+options.taxon.url+"'><span class='ui-icon ui-icon-extlink'>&nbsp;</span></a>"),primaryName!==options.taxon.to_styled_s&&taxon_li.append($("<div/>").addClass("small meta").html(options.taxon.to_styled_s)),ul.append(taxon_li)}};iNaturalist.OverlayControl.prototype.addOverlay=function(lyr){var map=this.map,ul=$("ul",this.div);name=lyr.name,id=lyr.id||name,overlay=lyr.overlay,checkbox=$('<input type="checkbox"></input>'),label=$("<label></label>").attr("for",id).html(name),li=$("<li></li>"),checkbox.attr("id",id).attr("name",name).prop("checked",overlay.getMap()),checkbox.click(function(){var name=$(this).attr("name"),overlay=map.getOverlay(name).overlay;overlay.setMap(overlay.getMap()?null:map)}),li.append(checkbox,label),lyr.description&&li.append($("<div></div>").addClass("small meta").html(lyr.description)),ul.append(li)},google.maps.Map.prototype.addOverlay=function(name,overlay,options){options=options||{},this.overlays=this.overlays||[];var overlayOpts={name:name,overlay:overlay,id:options.id,description:options.description};this.overlays.push(overlayOpts),overlay.setMap&&!options.hidden&&overlay.setMap(this),this._overlayControl&&this._overlayControl.addOverlay(overlayOpts)},google.maps.Map.prototype.removeOverlay=function(name){if(this.overlays)for(var i=0;i<this.overlays.length;i++)this.overlays[i].name==name&&(this.overlays[i].overlay.setMap(null),this.overlays.splice(i))},google.maps.Map.prototype.getOverlay=function(name){if(this.overlays)for(var i=0;i<this.overlays.length;i++)if(this.overlays[i].name==name)return this.overlays[i]};var appendValidParamsToURL=function(url,options){var params={};return options.validParams=options.validParams||{},_.each(options,function(value,key){"grid"===options.endpoint&&(key=key.replace("grid_","")),"points"===options.endpoint&&(key=key.replace("point_","")),_.includes(options.validParams,key)&&(params[key]=value),key.match(/field[:%]\w+/)&&(params[key]=value)}),params?url+="?"+$.param(params):url};google.maps.Map.prototype.addPlaceLayer=function(options){return _.defaults(options,{validParams:["color"]}),this.addPostgisLayerByEndpoint("places",options.place.id,options)},google.maps.Map.prototype.addTaxonRangeLayer=function(options){return _.defaults(options,{validParams:["color"]}),this.addPostgisLayerByEndpoint("taxon_ranges",options.taxon.id,options)},google.maps.Map.prototype.addTaxonPlacesLayer=function(options){return _.defaults(options,{validParams:["confirmed_color","unconfirmed_color"]}),this.addPostgisLayerByEndpoint("taxon_places",options.taxon.id,options)};var cachedGBIFColors,GBIFMapColors=function(){if(cachedGBIFColors)return cachedGBIFColors;var colors=[{range:",10",color:"#F7005A"},{range:"10,100",color:"#D50067"},{range:"100,1000",color:"#B5006C"},{range:"1000,10000",color:"#94006A"},{range:"10000,100000",color:"#72005F"},{range:"100000,",color:"#52034E"}],opacity=.9,alphaOpacity=parseFloat(Math.ceil(255*opacity)).toString(16);return cachedGBIFColors=_.map(colors,function(c){return encodeURIComponent(c.range+","+c.color+alphaOpacity)}).join("%7C")};google.maps.Map.prototype.addGBIFLayer=function(options){var layerTileURL="https://api.gbif.org/v1/map/density/tile?x={x}&y={y}&z={z}&type=TAXON&key="+options.gbif_id+"&resolution=4&colors="+GBIFMapColors();return this.addLayerAndControl({tiles:[layerTileURL]},_.extend(options,{endpoint:"gbif"}))},google.maps.Map.prototype.addPostgisLayerByEndpoint=function(endpoint,endpointID,options){this.setTilt(0);var tileservers=postgisTileservers(),options=options||{},tileURLs=_.map(tileservers,function(base){return appendValidParamsToURL(base+"/"+endpoint+"/"+endpointID+"/{z}/{x}/{y}.png",options)});return this.addLayerAndControl({tiles:tileURLs},options)},google.maps.Map.prototype.addLayerAndControl=function(tilejson,options){options=options||{};var layer=new wax.g.connector(tilejson);layer.title=options.title;var layerID=this.overlayMapTypes.push(layer);return options.interactivity&&(layer.interactivity=this.addTileInteractivity(tilejson,layerID)),options.disabled&&this.overlayMapTypes.setAt(layerID-1,emptyLayer),this._overlayControl&&this._overlayControl.addWindshaftOverlayControl([{layer:layer,layerID:layerID}],options),layerID},google.maps.Map.prototype.removeAllLayers=function(){for(var i=this.overlayMapTypes.length-1;i>=0;i--){var mapType=this.overlayMapTypes.getAt(i),title=mapType.title;mapType.interactivity&&mapType.interactivity.remove(),this.overlayMapTypes.removeAt(i),this._overlayControl&&this._overlayControl.removeOverlayControl(title)}this._overlayControl&&this._overlayControl.removeAll()},google.maps.Map.prototype.removeObservationsLayer=function(title){for(var i=this.overlayMapTypes.length-1;i>=0;i--)this.overlayMapTypes.getAt(i).title==title&&(this.overlayMapTypes.getAt(i).interactivity.remove(),this.overlayMapTypes.removeAt(i),this._overlayControl&&this._overlayControl.removeOverlayControl(title))},google.maps.Map.prototype.addObservationsLayer=function(title,options){this.setTilt(0);var tileservers=elasticsearchTileservers(),options=options||{},gridTileSuffix="/"+(options.mapStyle||"colored_heatmap")+"/{z}/{x}/{y}.png",pointTileSuffix="/points/{z}/{x}/{y}.png",gridmaxzoom=options.gridmaxzoom||9;options.title=title,options.taxon&&(options.taxon_id=options.taxon.id),options.observation_id&&"number"==typeof options.observation_id&&(options.featured_observation_id=options.observation_id);var paramKeys=["taxon_id","user_id","place_id","project_id","ttl","color","opacity","border_opacity","d1","d2","nelat","nelng","swlat","swlng","day","month","year","rank","hrank","lrank","quality_grade","identifications","captive","iconic_taxa","q","search_on","out_of_range","has","iconic_taxa","project_ids","geoprivacy","on","created_on","viewer_id","reviewed","featured_observation_id","threatened","introduced","endemic","native","verifiable","popular","has","photos","sounds","photo_license","created_d1","created_d2","not_in_project","lat","lng","viewer_id","identified","taxon_ids[]","projects[]","apply_project_rules_for","not_matching_project_rules_for","list_id","taxon_ids","not_in_place","unobserved_by_user_id","radius","geo","oauth_application_id","collection_preview","term_id","term_value_id","without_term_value_id"];gridTileSuffix=appendValidParamsToURL(gridTileSuffix,_.extend(options,{validParams:paramKeys,endpoint:"grid"})),pointTileSuffix=appendValidParamsToURL(pointTileSuffix,_.extend(options,{validParams:paramKeys,endpoint:"points"})),gridLayer=this.addTileLayer(_.map(tileservers,function(base){return base+gridTileSuffix}),{maxzoom:gridmaxzoom,gridmaxzoom:gridmaxzoom,interactivity:options.interactivity===!1?!1:"id",interactionsURL:intereactionsServer()+gridTileSuffix,disabled:options.disabled,infoWindowCallback:options.infoWindowCallback}),pointLayer=this.addTileLayer(_.map(tileservers,function(base){return base+pointTileSuffix}),{interactivity:options.interactivity===!1?!1:"id",minzoom:gridmaxzoom+1,gridminzoom:gridmaxzoom+1,interactionsURL:intereactionsServer()+pointTileSuffix,disabled:options.disabled,infoWindowCallback:options.infoWindowCallback}),gridLayer.layer.title=title,pointLayer.layer.title=title,this._overlayControl&&this._overlayControl.addWindshaftOverlayControl([gridLayer,pointLayer],options)},google.maps.Map.prototype.getInfoWindow=function(options){return iw=new google.maps.InfoWindow(_.extend({},options,{position:new google.maps.LatLng(0,0)})),iw},google.maps.Map.prototype.createInfoWindow=function(options){return this.infoWindow||(this.infoWindow=this.getInfoWindow(options)),this.infoWindow},google.maps.Map.prototype.addTileLayer=function(tileURLs,options){{var options=options||{};options.interactivity}if(options.interactivity){var interactionsURLs=options.interactionsURL?[options.interactionsURL]:tileURLs;options.grids=_.map(interactionsURLs,function(l){return google.maps.Map.prototype.utfgridURL(l)})}var tilejson=$.extend(!0,{},{tiles:tileURLs,template:"{{species_guess}}"},options),layer=new wax.g.connector(tilejson),layerID=this.overlayMapTypes.push(layer);return options.disabled&&this.overlayMapTypes.setAt(layerID-1,emptyLayer),options.interactivity&&(layer.interactivity=this.addTileInteractivity(tilejson,layerID,options)),{layer:layer,layerID:layerID}},google.maps.Map.prototype.utfgridURL=function(tileURL){return url=tileURL.replace(/\.png/,".grid.json"),url+=url.indexOf("?")<0?"?":"&",url},google.maps.Map.prototype.addTileInteractivity=function(tilejson,layerID,options){var map=this,interactionOn=!1,waxInteraction=wax.g.interaction(),oldFeature=waxInteraction.screen_feature;return map.createInfoWindow(),waxInteraction.screen_feature=function(pos,callback){return options.maxzoom&&map.getZoom()<=options.maxzoom?oldFeature(pos,callback):void oldFeature({x:pos.x,y:pos.y+13},function(f){return f&&"obscured"!=f.geoprivacy&&!f.private_location?callback(f):void oldFeature(pos,function(f){return f&&"obscured"!=f.geoprivacy&&!f.private_location?callback():void callback(f)})})},waxInteraction.is_disabled=function(){return map.overlayMapTypes.getAt(layerID-1)===emptyLayer},waxInteraction.map(map).tilejson(tilejson).on({on:function(o){if(waxInteraction.is_disabled())return null;if(interactionOn=!0,map.setOptions({draggableCursor:"pointer"}),"click"==o.e.type){if(infoWindowOpenTime&&new Date-infoWindowOpenTime<500)return!1;var googleMainMapDiv=$(map.div).find("div[style*='cursor'][style*='z-index: 0']"),googleMapInteractionsDiv=$(googleMainMapDiv).children()[2];if(!$.contains(googleMapInteractionsDiv,o.e.target)&&!$(googleMapInteractionsDiv).is(o.e.target))return!1;if(iNaturalist.Map.infoWindow&&iNaturalist.Map.infoWindow.close(),$("#map-legend").hide(),o.data.latitude){var latLng=new google.maps.LatLng(o.data.latitude,o.data.longitude),iw=map.createInfoWindow(),iwOpts={};if(iwOpts.pixelOffset=options.minzoom&&"obscured"!=o.data.geoprivacy&&!o.data.private_location?new google.maps.Size(0,-11):new google.maps.Size(0,0),options.infoWindowCallback)return options.infoWindowCallback(map,iw,latLng,o.data.id,iwOpts);$.ajax({url:"/observations/"+o.data.id+".html?partial=cached_component",type:"GET",dataType:"html",beforeSend:function(){var content=$('<div class="loading status">'+I18n.t("loading")+"</div>").get(0);map.infoWindowSetContent(iw,latLng,content,iwOpts)},success:function(data){var content=$('<div class="compact mini infowindow observations"></div>').append(data).get(0);map.infoWindowSetContent(iw,latLng,content,iwOpts)},error:function(jqXHR,textStatus){console.log(textStatus)}})}}},off:function(){return map.overlayMapTypes.getAt(layerID-1)===emptyLayer?null:(interactionOn&&map.setOptions({draggableCursor:"url(https://maps.google.com/mapfiles/openhand.cur), move"}),void(interactionOn=!1))
}}),waxInteraction},google.maps.Map.prototype.infoWindowSetContent=function(iw,latLng,content,options){options=options||{},iw.close(),options.pixelOffset&&iw.setOptions({pixelOffset:options.pixelOffset}),iw.position=latLng,iw.setContent(content),iw.open(this),$(iw).focus(),deselectText(),infoWindowOpenTime=new Date},iNaturalist.Map.ICONS={DodgerBlue34:new google.maps.MarkerImage("/mapMarkers/mm_34_DodgerBlue.png"),DeepPink34:new google.maps.MarkerImage("/mapMarkers/mm_34_DeepPink.png"),iNatGreen34:new google.maps.MarkerImage("/mapMarkers/mm_34_iNatGreen.png"),OrangeRed34:new google.maps.MarkerImage("/mapMarkers/mm_34_OrangeRed.png"),DarkMagenta34:new google.maps.MarkerImage("/mapMarkers/mm_34_DarkMagenta.png"),unknown34:new google.maps.MarkerImage("/mapMarkers/mm_34_unknown.png"),ChromistaBrown34:new google.maps.MarkerImage("/mapMarkers/mm_34_ChromistaBrown.png")},iNaturalist.Map.STEMLESS_ICONS={DodgerBlue34:new google.maps.MarkerImage("/mapMarkers/mm_34_stemless_DodgerBlue.png"),DeepPink34:new google.maps.MarkerImage("/mapMarkers/mm_34_stemless_DeepPink.png"),iNatGreen34:new google.maps.MarkerImage("/mapMarkers/mm_34_stemless_iNatGreen.png"),OrangeRed34:new google.maps.MarkerImage("/mapMarkers/mm_34_stemless_OrangeRed.png"),DarkMagenta34:new google.maps.MarkerImage("/mapMarkers/mm_34_stemless_DarkMagenta.png"),unknown34:new google.maps.MarkerImage("/mapMarkers/mm_34_stemless_unknown.png"),ChromistaBrown34:new google.maps.MarkerImage("/mapMarkers/mm_34_stemless_ChromistaBrown.png")},iNaturalist.Map.ICONIC_TAXON_ICONS={Protozoa:iNaturalist.Map.ICONS.DarkMagenta34,Animalia:iNaturalist.Map.ICONS.DodgerBlue34,Plantae:iNaturalist.Map.ICONS.iNatGreen34,Fungi:iNaturalist.Map.ICONS.DeepPink34,Amphibia:iNaturalist.Map.ICONS.DodgerBlue34,Reptilia:iNaturalist.Map.ICONS.DodgerBlue34,Aves:iNaturalist.Map.ICONS.DodgerBlue34,Mammalia:iNaturalist.Map.ICONS.DodgerBlue34,Actinopterygii:iNaturalist.Map.ICONS.DodgerBlue34,Mollusca:iNaturalist.Map.ICONS.OrangeRed34,Insecta:iNaturalist.Map.ICONS.OrangeRed34,Arachnida:iNaturalist.Map.ICONS.OrangeRed34,Chromista:iNaturalist.Map.ICONS.ChromistaBrown34},iNaturalist.Map.STEMLESS_ICONIC_TAXON_ICONS={Protozoa:iNaturalist.Map.STEMLESS_ICONS.DarkMagenta34,Animalia:iNaturalist.Map.STEMLESS_ICONS.DodgerBlue34,Plantae:iNaturalist.Map.STEMLESS_ICONS.iNatGreen34,Fungi:iNaturalist.Map.STEMLESS_ICONS.DeepPink34,Amphibia:iNaturalist.Map.STEMLESS_ICONS.DodgerBlue34,Reptilia:iNaturalist.Map.STEMLESS_ICONS.DodgerBlue34,Aves:iNaturalist.Map.STEMLESS_ICONS.DodgerBlue34,Mammalia:iNaturalist.Map.STEMLESS_ICONS.DodgerBlue34,Actinopterygii:iNaturalist.Map.STEMLESS_ICONS.DodgerBlue34,Mollusca:iNaturalist.Map.STEMLESS_ICONS.OrangeRed34,Insecta:iNaturalist.Map.STEMLESS_ICONS.OrangeRed34,Arachnida:iNaturalist.Map.STEMLESS_ICONS.OrangeRed34,Chromista:iNaturalist.Map.STEMLESS_ICONS.ChromistaBrown34},iNaturalist.Map.ICONIC_TAXON_COLORS={Protozoa:"#8B008B",Animalia:"#1E90FF",Plantae:"#73AC13",Fungi:"#FF1493",Amphibia:"#1E90FF",Reptilia:"#1E90FF",Aves:"#1E90FF",Mammalia:"#1E90FF",Actinopterygii:"#1E90FF",Mollusca:"#FF4500",Insecta:"#FF4500",Arachnida:"#FF4500",Chromista:"#993300"}}(),$(document).ready(function(){$(".iconic_taxon_filter input").change(function(){$(this).siblings("label").toggleClass("selected")}),$(".iconic_taxon_filter input:checked").each(function(){$(this).siblings("label").addClass("selected")})}),/*
 * jQuery Labelize Plugin (jQuery >= 1.2.2)
 *
 * This work is distributed under the MIT License:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Copyright 2008, Ben Vinegar [ ben ! benlog dot org ]
 *
 * Usage:
 *
 * $('.myLabel').labelize()
 *
 */
function($){$.fn.labelize=function(hoverClass){function labelClickEvent(){$(this).unbind("click",labelClickEvent),$("input",this).click(),$(this).click(labelClickEvent)}var containers=$(this).filter(":has(input)");return $(containers).css("cursor","pointer").click(labelClickEvent),hoverClass&&containers.mouseover(function(){$(this).addClass(hoverClass)}).mouseout(function(){$(this).removeClass(hoverClass)}),$("input",this).mouseover(function(){$(containers).unbind("click",labelClickEvent)}).mouseout(function(){$(containers).click(labelClickEvent)}),this}}(jQuery),$.fn.check=function(){this.each(function(){this.checked=!0})},$.fn.uncheck=function(){this.each(function(){this.checked=!1})},$.fn.toggleCheck=function(){this.each(function(){this.checked=this.checked?!1:!0})};