webpackJsonp([51],{0:function(n,e,a){a(583)},583:function(n,e,a){"use strict";function t(n,e){return v.buildTreeBeardUpload(n,e,{branch:n.data.branch})}function o(n,e){function a(){i.modal.dismiss()}function t(n){i.select(".modal-footer .btn-danger").html("<i> Deleting...</i>").removeClass("btn-danger").addClass("btn-default disabled"),h.ajax({url:v.buildTreeBeardDelete(n,{branch:n.data.branch,sha:n.data.extra.fileSha}),type:"DELETE",beforeSend:g.setXHRAuthorization}).done(function(e){i.deleteNode(n.parentID,n.id),w.Utils.dismissToolbar.call(i),i.modal.dismiss(),i.clearMultiselect()}).fail(function(e){i.modal.dismiss(),w.Utils.dismissToolbar.call(i),n.notify.update("Delete failed.","danger",void 0,3e3),i.clearMultiselect()})}function o(n){n.forEach(function(n){t(n)})}var i=this;if(1===e.length){var l=e[0].parent(),s=m("div",[m("p","This action is irreversible."),l.children.length<2?m("p","If a folder in Github has no children it will automatically be removed."):""]),c=m("div",[m("span.btn.btn-default",{onclick:function(){a()}},"Cancel"),m("span.btn.btn-danger",{onclick:function(){t(e[0])}},"Delete")]);e[0].data.permissions.edit&&i.modal.update(s,c,m("h3.break-word.modal-title",'Delete "'+e[0].data.name+'"?'))}else{var r,d,u=!0,f=[],p=[];e.forEach(function(n,e,a){n.data.permissions.edit?f.push(n):(u=!1,p.push(n))}),u?(r=m("div",[m("p","This action is irreversible."),f.map(function(n){return m(".fangorn-canDelete.text-success",n.data.name)})]),d=m("div",[m("span.btn.btn-default",{"class":"text-default",onclick:function(){a()}},"Cancel"),m("span.btn.btn-danger",{"class":"text-danger",onclick:function(){o.call(i,f)}},"Delete All")])):(r=m("div",[m("p","Some of these files can't be deleted but you can delete the ones highlighted with green. This action is irreversible."),f.map(function(n){return m(".fangorn-canDelete.text-success",n.data.name)}),p.map(function(n){return m(".fangorn-noDelete.text-warning",n.data.name)})]),d=m("div",[m("span.btn.btn-default",{"class":"text-default",onclick:function(){a()}},"Cancel"),m("span.btn.btn-danger",{"class":"text-danger",onclick:function(){o.call(i,f)}},"Delete Some")])),i.modal.update(r,d,m("h3.break-word.modal-title","Delete multiple files?"))}return!0}function i(n,e){n.data.branch=e,this.updateFolder(null,n)}function l(n){return v.buildTreeBeardMetadata(n,{ref:n.data.branch})}function s(n,e){var a=this;n.children.forEach(function(e){w.Utils.inheritFromParent(e,n,["branch"])}),w.Utils.setCurrentFileID.call(a,n,window.contextVars.node.id,window.contextVars.file),!e&&a.isMultiselected(a.currentFileID)&&w.Utils.scrollToFile.call(a,a.currentFileID)}function c(n){var e=this,a=new b(n.data.nodeUrl).segment("files").segment(n.data.provider).segment(n.data.path.substring(1)).search({branch:n.data.branch}).toString();-1!==x.indexOf(e.pressedKey)?window.open(a,"_blank"):window.open(a,"_self")}function r(n,e){var a=this;if(n.data.isAddonRoot&&n.connected===!1)return w.Utils.connectCheckTemplate.call(this,n);if(n.data.addonFullname){var t=g.urlParams();!n.data.branch&&t.branch&&(n.data.branch=t.branch);var o=n.data.branch||n.data.defaultBranch;return m("span",[m("github-name",n.data.name+" ("+o+")")])}return"file"===n.kind&&n.data.permissions.view?m("span",[m("github-name.fg-file-links",{onclick:function(){c.call(a,n)}},n.data.name)]):m("span",n.data.name)}function d(n){var e=this,a=(n.parent().parent(),[]);return a.push({data:"name",folderIcons:!0,filter:!0,custom:r}),"project-files"===e.options.placement&&(a.push({data:"size",sortInclude:!1,filter:!1,custom:function(){return n.data.size?g.humanFileSize(n.data.size,!0):""}}),a.push({data:"downloads",sortInclude:!1,filter:!1,custom:function(){return m("")}})),"fileview"!==e.options.placement&&a.push({data:"modified",filter:!1,custom:function(){return m("")}}),a}function u(n){return n.data.iconUrl?m("img",{src:n.data.iconUrl,style:{width:"16px",height:"auto"}}," "):void 0}function f(n){this.returnIndex(n.id)}function p(n,e,a){a&&(a.branch=e.parent().data.branch)}var m=a(5),h=a(1),b=a(84),w=a(15),v=a(49),g=a(2),x=[224,17,91,93],k={view:function(n,e,a){function t(n,e,a){n.stopPropagation(),window.location=v.buildTreeBeardDownload(e,{fileSha:e.data.extra.fileSha})}var l=e.treebeard,s=e.item,r=[];if("folder"===s.kind){var d=[];if(s.data.branches){s.data.branch=s.data.branch||s.data.defaultBranch;for(var u=0;u<s.data.branches.length;u++){var f=s.data.branches[u]===s.data.branch?"selected":"";d.push(m("option",{selected:f,value:s.data.branches[u]},s.data.branches[u]))}}s.data.addonFullname&&r.push(m.component(w.Components.dropdown,{label:"Branch: ",onchange:function(n){i.call(l,s,n.target.value)},icon:"fa fa-external-link",className:"text-info"},d)),"fileview"!==l.options.placement&&(window.File&&window.FileReader&&s.data.permissions&&s.data.permissions.edit&&(r.push(m.component(w.Components.button,{onclick:function(n){w.ButtonEvents._uploadEvent.call(l,n,s)},icon:"fa fa-upload",className:"text-success"},"Upload"),m.component(w.Components.button,{onclick:function(n){l.toolbarMode(w.Components.toolbarModes.ADDFOLDER)},icon:"fa fa-plus",className:"text-success"},"Create Folder")),s.data.isAddonRoot||r.push(m.component(w.Components.button,{onclick:function(n){o.call(l,n,[s])},icon:"fa fa-trash",className:"text-danger"},"Delete Folder"))),s.data.addonFullname&&r.push(m.component(w.Components.button,{onclick:function(n){window.location=s.data.urls.zip},icon:"fa fa-download",className:"text-primary"},"Download"),m.component(w.Components.button,{onclick:function(n){window.open(s.data.urls.repo,"_blank")},icon:"fa fa-external-link",className:"text-info"},"Open")))}else"file"===s.kind&&"fileview"!==l.options.placement&&(r.push(m.component(w.Components.button,{onclick:function(n){t.call(l,n,s)},icon:"fa fa-download",className:"text-primary"},"Download")),s.data.permissions&&s.data.permissions.view&&r.push(m.component(w.Components.button,{onclick:function(n){c.call(l,s)},icon:"fa fa-file-o",className:"text-info"},"View")),s.data.permissions&&s.data.permissions.edit&&r.push(m.component(w.Components.button,{onclick:function(n){o.call(l,n,[s])},icon:"fa fa-trash",className:"text-danger"},"Delete")),s.data.permissions&&s.data.permissions.view&&!s.data.permissions["private"]&&r.push(m("a.text-info.fangorn-toolbar-icon",{href:s.data.extra.webView},[m("i.fa.fa-external-link"),m("span","View on GitHub")])));return s.data.provider&&!s.data.isAddonRoot&&s.data.permissions&&s.data.permissions.edit&&"fileview"!==l.options.placement&&r.push(m.component(w.Components.button,{onclick:function(){l.toolbarMode(w.Components.toolbarModes.RENAME)},tooltip:"Change the name of the item",icon:"fa fa-pencil",className:"text-info"},"Rename")),m("span",r)}};w.config.github={uploadUrl:t,lazyload:l,resolveRows:d,folderIcon:u,onUploadComplete:f,lazyLoadOnLoad:s,uploadSuccess:p,itemButtons:k,removeEvent:o}}});
//# sourceMappingURL=files.d61b27b2ba6efbb1f534.js.map