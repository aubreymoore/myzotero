webpackJsonp([57],{0:function(t,a,e){e(575)},575:function(t,a,e){"use strict";function n(t,a,e){a.data.version=e,t.updateFolder(null,a)}function o(t,a,e){t.stopPropagation(),window.location=v.buildTreeBeardDownload(a,{path:a.data.extra.fileId})}function s(t){var a=new f(t.data.nodeUrl);window.location=a.segment("files").segment(t.data.provider).segment(t.data.extra.fileId).query({version:t.data.extra.datasetVersion}).toString()}function i(t,a){if(t.data.isAddonRoot&&t.connected===!1)return b.Utils.connectCheckTemplate.call(this,t);var e="latest-published"===t.data.version?"Published":"Draft";if(t.data.addonFullname){var n=[p("dataverse-name",t.data.name+" ("+e+")")];if(t.data.hasPublishedFiles)if(t.data.permissions.edit){var o=g.urlParams();o.version&&o.version!==t.data.version&&(t.data.version=o.version)}else n.push(p("span.text-muted","[Published]"));else n.push(p("span.text.text-muted","[Draft]"));return p("span",n)}return p("span",[p("dataverse-name.fg-file-links",{onclick:function(){s(t)}},t.data.name)])}function d(t){var a=this,e=[];return e.push({data:"name",folderIcons:!0,filter:!0,custom:i}),"project-files"===a.options.placement&&(e.push({data:"size",sortInclude:!1,filter:!1,custom:function(){return p("")}}),e.push({data:"downloads",sortInclude:!1,filter:!1,custom:function(){return p("")}})),"fileview"!==a.options.placement&&e.push({data:"modified",filter:!1,custom:function(){return p("")}}),e}function l(t){return t.data.iconUrl?p("img",{src:t.data.iconUrl,style:{width:"16px",height:"auto"}}," "):void 0}function r(t){return v.buildTreeBeardDelete(t,{full_path:t.data.path+"?"+m.param({name:t.data.name})})}function u(t){return v.buildTreeBeardMetadata(t,{version:t.data.version})}function c(t){return t.data.provider&&"folder"===t.kind&&t.data.permissions.edit&&"latest"===t.data.version}var p=e(5),f=e(84),m=e(1),h=e(6),b=e(15),v=e(49),g=e(2),k={view:function(t,a,e){function i(t,a,e){t.stopPropagation(),r.dropzone.hiddenFileInput.click(),r.dropzoneItemCache=a}function d(t,a,e){function n(){r.modal.dismiss(),a.notify.update("Publishing "+d,"info",1,1),m.osf.putJSON(s,{publish_both:o}).done(function(t){a.notify.update();var e=[p("p.m-md","Your content has been published.")],n=[p("button.btn.btn-primary",{onclick:function(){r.modal.dismiss()}},"Got it")];r.modal.update(e,n,p("h3.break-word.modal-title","Successfully published")),a.data.dataverseIsPublished=!0,a.data.datasetIsPublished=!0,a.data.datasetDraftModified=!1,a.data.hasPublishedFiles=a.children.length>0,a.data.version=a.data.hasPublishedFiles?"latest-published":"latest";for(var o=0;o<a.children.length;o++)a.children[o].data.extra.datasetVersion=a.data.version}).fail(function(t,e,n){var o,i=t.responseJSON.code;switch(i){case 405:o="Error: This dataset cannot be published until "+a.data.dataverse+" Dataverse is published.";break;case 409:o="This dataset version has already been published.";break;default:o="Error: Something went wrong when attempting to publish your dataset.",h.captureMessage("Could not publish dataset",{url:s,textStatus:e,error:n})}var d=[p("p.m-md",o)],l=[p("button.btn.btn-primary",{onclick:function(){r.modal.dismiss()}},"Okay")];r.modal.update(d,l)})}var o=!a.data.dataverseIsPublished,s=a.data.urls.publish,i=a.data.host,d=o?"Dataverse and dataset":"dataset",l=[p("p.m-md",o?"This dataset cannot be published until the "+a.data.dataverse+" Dataverse is published. ":""),p("p.m-md","By publishing this "+d+", all content will be made available through "+i+" using their internal privacy settings, regardless of your OSF project settings. "),p("p.font-thick.m-md",o?"Do you want to publish this Dataverse AND this dataset?":"Are you sure you want to publish this dataset?")],u=[p("button.btn.btn-default",{onclick:function(){r.modal.dismiss()}},"Cancel"),p("button.btn.btn-primary",{onclick:function(){n()}},"Publish")];r.modal.update(l,u,p("h3.break-word.modal-title","Publish this "+d+"?"))}var l=[],r=a.treebeard,u=a.item;if(u.data.addonFullname){var c=[p("option",{selected:"latest"===u.data.version,value:"latest"},"Draft")];u.data.datasetIsPublished&&c.push(p("option",{selected:"latest-published"===u.data.version,value:"latest-published"},"Published")),l.push(p.component(b.Components.dropdown,{label:"Version: ",onchange:function(t){n(r,u,t.target.value)},icon:"fa fa-external-link",className:"text-info"},c))}return"fileview"!==r.options.placement&&("folder"===u.kind&&u.data.addonFullname&&"latest"===u.data.version&&u.data.permissions.edit?(l.push(p.component(b.Components.button,{onclick:function(t){i.call(r,t,u)},icon:"fa fa-upload",className:"text-success"},"Upload")),u.data.datasetDraftModified&&l.push(p.component(b.Components.button,{onclick:function(t){d.call(r,t,u)},icon:"fa fa-globe",className:"text-primary"},"Publish"))):"folder"!==u.kind||u.data.addonFullname?"file"===u.kind&&(l.push(p.component(b.Components.button,{onclick:function(t){o.call(r,t,u)},icon:"fa fa-download",className:"text-primary"},"Download")),"latest"===u.parent().data.version&&u.data.permissions.edit&&l.push(p.component(b.Components.button,{onclick:function(t){b.ButtonEvents._removeEvent.call(r,t,[u])},icon:"fa fa-trash",className:"text-danger"},"Delete")),u.data.permissions&&u.data.permissions.view&&l.push(p.component(b.Components.button,{onclick:function(t){s(u)},icon:"fa fa-external-link",className:"text-info"},"View"))):l.push(p.component(b.Components.button,{onclick:function(t){i.call(r,t,u)},icon:"fa fa-upload",className:"text-success"},"Upload"))),p("span",l)}};b.config.dataverse={folderIcon:l,resolveDeleteUrl:r,resolveRows:d,lazyload:u,canDrop:c,itemButtons:k}}});
//# sourceMappingURL=files.f21e067139ee6175848a.js.map